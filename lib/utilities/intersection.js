'use strict';

var vectorMaths = require('../maths/vector'),
    arrayUtilities = require('../utilities/array'),
    approximateUtilities = require('../utilities/approximate');

var add3 = vectorMaths.add3,
    subtract3 = vectorMaths.subtract3,
    scale3 = vectorMaths.scale3,
    first = arrayUtilities.first,
    second = arrayUtilities.second,
    isApproximatelyEqualToZero = approximateUtilities.isApproximatelyEqualToZero;

function calculateIntersection(edge, firstPositionComponent) {
  var intersection = null;
  var edgeNonParallel = isEdgeNonParallel(edge);

  if (edgeNonParallel) {
    var edgeIntersection = calculateEdgeIntersection(edge, firstPositionComponent),
        edgeIntersectionNonTrivial = edgeIntersection > 0 && edgeIntersection < 1;

    if (edgeIntersectionNonTrivial) {
      intersection = edgeIntersection; ///
    }
  }

  return intersection;
}

function calculateNonNullIntersections(intersections) {
  var nonNullIntersections = intersections.reduce(function (nonNullIntersections, intersection) {
    if (intersection !== null) {
      var nonNullIntersection = intersection; ///

      nonNullIntersections.push(nonNullIntersection);
    }

    return nonNullIntersections;
  }, []);
  return nonNullIntersections;
}

function calculateNullIntersectionIndex(intersections) {
  var nullIntersectionIndex = intersections.reduce(function (nullIntersectionIndex, intersection, index) {
    if (nullIntersectionIndex === null) {
      if (intersection === null) {
        nullIntersectionIndex = index;
      }
    }

    return nullIntersectionIndex;
  }, null);
  return nullIntersectionIndex;
}

function calculateNonNullIntersectionIndex(intersections) {
  var nullIntersectionIndex = intersections.reduce(function (nullIntersectionIndex, intersection, index) {
    if (nullIntersectionIndex === null) {
      if (intersection !== null) {
        nullIntersectionIndex = index;
      }
    }

    return nullIntersectionIndex;
  }, null);
  return nullIntersectionIndex;
}

function calculateIntermediateVertexPosition(startVertexPosition, endVertexPosition, intersection) {
  var extent = subtract3(endVertexPosition, startVertexPosition),
      offset = scale3(extent, intersection),
      intermediateVertexPosition = add3(startVertexPosition, offset);
  return intermediateVertexPosition;
}

module.exports = module.exports = {
  calculateIntersection: calculateIntersection,
  calculateNonNullIntersections: calculateNonNullIntersections,
  calculateNullIntersectionIndex: calculateNullIntersectionIndex,
  calculateNonNullIntersectionIndex: calculateNonNullIntersectionIndex,
  calculateIntermediateVertexPosition: calculateIntermediateVertexPosition
};

function isEdgeNonParallel(edge) {
  var edgeExtent = edge.getExtent(),
      edgeExtentComponents = edgeExtent,
      ///
  firstEdgeExtentComponent = first(edgeExtentComponents),
      secondEdgeExtentComponent = second(edgeExtentComponents),
      edgeAngleTangent = firstEdgeExtentComponent / secondEdgeExtentComponent,
      edgeAngleTangentApproximatelyEqualToZero = isApproximatelyEqualToZero(edgeAngleTangent),
      edgeParallel = edgeAngleTangentApproximatelyEqualToZero,
      ///
  edgeNonParallel = !edgeParallel;
  return edgeNonParallel;
}

function calculateEdgeIntersection(edge, firstPositionComponent) {
  var edgeExtent = edge.getExtent(),
      edgePosition = edge.getPosition(),
      edgeExtentComponents = edgeExtent,
      ///
  edgePositionComponents = edgePosition,
      ///
  firstEdgeExtentComponent = first(edgeExtentComponents),
      firstEdgePositionComponent = first(edgePositionComponents),
      edgeIntersection = (firstPositionComponent - firstEdgePositionComponent) / firstEdgeExtentComponent;
  return edgeIntersection;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImludGVyc2VjdGlvbi5qcyJdLCJuYW1lcyI6WyJ2ZWN0b3JNYXRocyIsInJlcXVpcmUiLCJhcnJheVV0aWxpdGllcyIsImFwcHJveGltYXRlVXRpbGl0aWVzIiwiYWRkMyIsInN1YnRyYWN0MyIsInNjYWxlMyIsImZpcnN0Iiwic2Vjb25kIiwiaXNBcHByb3hpbWF0ZWx5RXF1YWxUb1plcm8iLCJjYWxjdWxhdGVJbnRlcnNlY3Rpb24iLCJlZGdlIiwiZmlyc3RQb3NpdGlvbkNvbXBvbmVudCIsImludGVyc2VjdGlvbiIsImVkZ2VOb25QYXJhbGxlbCIsImlzRWRnZU5vblBhcmFsbGVsIiwiZWRnZUludGVyc2VjdGlvbiIsImNhbGN1bGF0ZUVkZ2VJbnRlcnNlY3Rpb24iLCJlZGdlSW50ZXJzZWN0aW9uTm9uVHJpdmlhbCIsImNhbGN1bGF0ZU5vbk51bGxJbnRlcnNlY3Rpb25zIiwiaW50ZXJzZWN0aW9ucyIsIm5vbk51bGxJbnRlcnNlY3Rpb25zIiwicmVkdWNlIiwibm9uTnVsbEludGVyc2VjdGlvbiIsInB1c2giLCJjYWxjdWxhdGVOdWxsSW50ZXJzZWN0aW9uSW5kZXgiLCJudWxsSW50ZXJzZWN0aW9uSW5kZXgiLCJpbmRleCIsImNhbGN1bGF0ZU5vbk51bGxJbnRlcnNlY3Rpb25JbmRleCIsImNhbGN1bGF0ZUludGVybWVkaWF0ZVZlcnRleFBvc2l0aW9uIiwic3RhcnRWZXJ0ZXhQb3NpdGlvbiIsImVuZFZlcnRleFBvc2l0aW9uIiwiZXh0ZW50Iiwib2Zmc2V0IiwiaW50ZXJtZWRpYXRlVmVydGV4UG9zaXRpb24iLCJtb2R1bGUiLCJleHBvcnRzIiwiZWRnZUV4dGVudCIsImdldEV4dGVudCIsImVkZ2VFeHRlbnRDb21wb25lbnRzIiwiZmlyc3RFZGdlRXh0ZW50Q29tcG9uZW50Iiwic2Vjb25kRWRnZUV4dGVudENvbXBvbmVudCIsImVkZ2VBbmdsZVRhbmdlbnQiLCJlZGdlQW5nbGVUYW5nZW50QXBwcm94aW1hdGVseUVxdWFsVG9aZXJvIiwiZWRnZVBhcmFsbGVsIiwiZWRnZVBvc2l0aW9uIiwiZ2V0UG9zaXRpb24iLCJlZGdlUG9zaXRpb25Db21wb25lbnRzIiwiZmlyc3RFZGdlUG9zaXRpb25Db21wb25lbnQiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLElBQU1BLFdBQVcsR0FBR0MsT0FBTyxDQUFDLGlCQUFELENBQTNCO0FBQUEsSUFDTUMsY0FBYyxHQUFHRCxPQUFPLENBQUMsb0JBQUQsQ0FEOUI7QUFBQSxJQUVNRSxvQkFBb0IsR0FBR0YsT0FBTyxDQUFDLDBCQUFELENBRnBDOztJQUlRRyxJLEdBQTRCSixXLENBQTVCSSxJO0lBQU1DLFMsR0FBc0JMLFcsQ0FBdEJLLFM7SUFBV0MsTSxHQUFXTixXLENBQVhNLE07SUFDakJDLEssR0FBa0JMLGMsQ0FBbEJLLEs7SUFBT0MsTSxHQUFXTixjLENBQVhNLE07SUFDUEMsMEIsR0FBK0JOLG9CLENBQS9CTSwwQjs7QUFFUixTQUFTQyxxQkFBVCxDQUErQkMsSUFBL0IsRUFBcUNDLHNCQUFyQyxFQUE2RDtBQUMzRCxNQUFJQyxZQUFZLEdBQUcsSUFBbkI7QUFFQSxNQUFNQyxlQUFlLEdBQUdDLGlCQUFpQixDQUFDSixJQUFELENBQXpDOztBQUVBLE1BQUlHLGVBQUosRUFBcUI7QUFDbkIsUUFBTUUsZ0JBQWdCLEdBQUdDLHlCQUF5QixDQUFDTixJQUFELEVBQU9DLHNCQUFQLENBQWxEO0FBQUEsUUFDTU0sMEJBQTBCLEdBQUtGLGdCQUFnQixHQUFHLENBQXBCLElBQTRCQSxnQkFBZ0IsR0FBRyxDQURuRjs7QUFHQSxRQUFJRSwwQkFBSixFQUFnQztBQUM5QkwsTUFBQUEsWUFBWSxHQUFHRyxnQkFBZixDQUQ4QixDQUNJO0FBQ25DO0FBQ0Y7O0FBRUQsU0FBT0gsWUFBUDtBQUNEOztBQUVELFNBQVNNLDZCQUFULENBQXVDQyxhQUF2QyxFQUFzRDtBQUNwRCxNQUFNQyxvQkFBb0IsR0FBR0QsYUFBYSxDQUFDRSxNQUFkLENBQXFCLFVBQUNELG9CQUFELEVBQXVCUixZQUF2QixFQUF3QztBQUN4RixR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QUcxQixJQUFJLENBQUMyQixTQUFMLEVBQW5CO0FBQUEsTUFDTU8sWUFBWSxHQUFHbEMsSUFBSSxDQUFDbUMsV0FBTCxFQURyQjtBQUFBLE1BRU1QLG9CQUFvQixHQUFHRixVQUY3QjtBQUFBLE1BRXlDO0FBQ25DVSxFQUFBQSxzQkFBc0IsR0FBR0YsWUFIL0I7QUFBQSxNQUc2QztBQUN2Q0wsRUFBQUEsd0JBQXdCLEdBQUdqQyxLQUFLLENBQUNnQyxvQkFBRCxDQUp0QztBQUFBLE1BS01TLDBCQUEwQixHQUFHekMsS0FBSyxDQUFDd0Msc0JBQUQsQ0FMeEM7QUFBQSxNQU1NL0IsZ0JBQWdCLEdBQUcsQ0FBQ0osc0JBQXNCLEdBQUdvQywwQkFBMUIsSUFBd0RSLHdCQU5qRjtBQVFBLFNBQU94QixnQkFBUDtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCB2ZWN0b3JNYXRocyA9IHJlcXVpcmUoJy4uL21hdGhzL3ZlY3RvcicpLFxuICAgICAgYXJyYXlVdGlsaXRpZXMgPSByZXF1aXJlKCcuLi91dGlsaXRpZXMvYXJyYXknKSxcbiAgICAgIGFwcHJveGltYXRlVXRpbGl0aWVzID0gcmVxdWlyZSgnLi4vdXRpbGl0aWVzL2FwcHJveGltYXRlJyk7XG5cbmNvbnN0IHsgYWRkMywgc3VidHJhY3QzLCBzY2FsZTMgfSA9IHZlY3Rvck1hdGhzLFxuICAgICAgeyBmaXJzdCwgc2Vjb25kIH0gPSBhcnJheVV0aWxpdGllcyxcbiAgICAgIHsgaXNBcHByb3hpbWF0ZWx5RXF1YWxUb1plcm8gfSA9IGFwcHJveGltYXRlVXRpbGl0aWVzO1xuXG5mdW5jdGlvbiBjYWxjdWxhdGVJbnRlcnNlY3Rpb24oZWRnZSwgZmlyc3RQb3NpdGlvbkNvbXBvbmVudCkge1xuICBsZXQgaW50ZXJzZWN0aW9uID0gbnVsbDtcblxuICBjb25zdCBlZGdlTm9uUGFyYWxsZWwgPSBpc0VkZ2VOb25QYXJhbGxlbChlZGdlKTtcblxuICBpZiAoZWRnZU5vblBhcmFsbGVsKSB7XG4gICAgY29uc3QgZWRnZUludGVyc2VjdGlvbiA9IGNhbGN1bGF0ZUVkZ2VJbnRlcnNlY3Rpb24oZWRnZSwgZmlyc3RQb3NpdGlvbkNvbXBvbmVudCksXG4gICAgICAgICAgZWRnZUludGVyc2VjdGlvbk5vblRyaXZpYWwgPSAoKGVkZ2VJbnRlcnNlY3Rpb24gPiAwICkgJiYgKGVkZ2VJbnRlcnNlY3Rpb24gPCAxKSk7XG5cbiAgICBpZiAoZWRnZUludGVyc2VjdGlvbk5vblRyaXZpYWwpIHtcbiAgICAgIGludGVyc2VjdGlvbiA9IGVkZ2VJbnRlcnNlY3Rpb247ICAvLy9cbiAgICB9XG4gIH1cblxuICByZXR1cm4gaW50ZXJzZWN0aW9uO1xufVxuXG5mdW5jdGlvbiBjYWxjdWxhdGVOb25OdWxsSW50ZXJzZWN0aW9ucyhpbnRlcnNlY3Rpb25zKSB7XG4gIGNvbnN0IG5vbk51bGxJbnRlcnNlY3Rpb25zID0gaW50ZXJzZWN0aW9ucy5yZWR1Y2UoKG5vbk51bGxJbnRlcnNlY3Rpb25zLCBpbnRlcnNlY3Rpb24pID0+IHtcbiAgICBpZiAoaW50ZXJzZWN0aW9uICE9PSBudWxsKSB7XG4gICAgICBjb25zdCBub25OdWxsSW50ZXJzZWN0aW9uID0gaW50ZXJzZWN0aW9uOyAvLy9cblxuICAgICAgbm9uTnVsbEludGVyc2VjdGlvbnMucHVzaChub25OdWxsSW50ZXJzZWN0aW9uKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbm9uTnVsbEludGVyc2VjdGlvbnM7XG4gIH0sIFtdKTtcblxuICByZXR1cm4gbm9uTnVsbEludGVyc2VjdGlvbnM7XG59XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZU51bGxJbnRlcnNlY3Rpb25JbmRleChpbnRlcnNlY3Rpb25zKSB7XG4gIGNvbnN0IG51bGxJbnRlcnNlY3Rpb25JbmRleCA9IGludGVyc2VjdGlvbnMucmVkdWNlKChudWxsSW50ZXJzZWN0aW9uSW5kZXgsIGludGVyc2VjdGlvbiwgaW5kZXgpID0+IHtcbiAgICBpZiAobnVsbEludGVyc2VjdGlvbkluZGV4ID09PSBudWxsKSB7XG4gICAgICBpZiAoaW50ZXJzZWN0aW9uID09PSBudWxsKSB7XG4gICAgICAgIG51bGxJbnRlcnNlY3Rpb25JbmRleCA9IGluZGV4O1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBudWxsSW50ZXJzZWN0aW9uSW5kZXg7XG4gIH0sIG51bGwpO1xuXG4gIHJldHVybiBudWxsSW50ZXJzZWN0aW9uSW5kZXg7XG59XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZU5vbk51bGxJbnRlcnNlY3Rpb25JbmRleChpbnRlcnNlY3Rpb25zKSB7XG4gIGNvbnN0IG51bGxJbnRlcnNlY3Rpb25JbmRleCA9IGludGVyc2VjdGlvbnMucmVkdWNlKChudWxsSW50ZXJzZWN0aW9uSW5kZXgsIGludGVyc2VjdGlvbiwgaW5kZXgpID0+IHtcbiAgICBpZiAobnVsbEludGVyc2VjdGlvbkluZGV4ID09PSBudWxsKSB7XG4gICAgICBpZiAoaW50ZXJzZWN0aW9uICE9PSBudWxsKSB7XG4gICAgICAgIG51bGxJbnRlcnNlY3Rpb25JbmRleCA9IGluZGV4O1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBudWxsSW50ZXJzZWN0aW9uSW5kZXg7XG4gIH0sIG51bGwpO1xuXG4gIHJldHVybiBudWxsSW50ZXJzZWN0aW9uSW5kZXg7XG59XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZUludGVybWVkaWF0ZVZlcnRleFBvc2l0aW9uKHN0YXJ0VmVydGV4UG9zaXRpb24sIGVuZFZlcnRleFBvc2l0aW9uLCBpbnRlcnNlY3Rpb24pIHtcbiAgY29uc3QgZXh0ZW50ID0gc3VidHJhY3QzKGVuZFZlcnRleFBvc2l0aW9uLCBzdGFydFZlcnRleFBvc2l0aW9uKSxcbiAgICAgICAgb2Zmc2V0ID0gc2NhbGUzKGV4dGVudCwgaW50ZXJzZWN0aW9uKSxcbiAgICAgICAgaW50ZXJtZWRpYXRlVmVydGV4UG9zaXRpb24gPSBhZGQzKHN0YXJ0VmVydGV4UG9zaXRpb24sIG9mZnNldCk7XG5cbiAgcmV0dXJuIGludGVybWVkaWF0ZVZlcnRleFBvc2l0aW9uO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0ge1xuICBjYWxjdWxhdGVJbnRlcnNlY3Rpb24sXG4gIGNhbGN1bGF0ZU5vbk51bGxJbnRlcnNlY3Rpb25zLFxuICBjYWxjdWxhdGVOdWxsSW50ZXJzZWN0aW9uSW5kZXgsXG4gIGNhbGN1bGF0ZU5vbk51bGxJbnRlcnNlY3Rpb25JbmRleCxcbiAgY2FsY3VsYXRlSW50ZXJtZWRpYXRlVmVydGV4UG9zaXRpb25cbn07XG5cbmZ1bmN0aW9uIGlzRWRnZU5vblBhcmFsbGVsKGVkZ2UpIHtcbiAgY29uc3QgZWRnZUV4dGVudCA9IGVkZ2UuZ2V0RXh0ZW50KCksXG4gICAgICAgIGVkZ2VFeHRlbnRDb21wb25lbnRzID0gZWRnZUV4dGVudCwgLy8vXG4gICAgICAgIGZpcnN0RWRnZUV4dGVudENvbXBvbmVudCA9IGZpcnN0KGVkZ2VFeHRlbnRDb21wb25lbnRzKSxcbiAgICAgICAgc2Vjb25kRWRnZUV4dGVudENvbXBvbmVudCA9IHNlY29uZChlZGdlRXh0ZW50Q29tcG9uZW50cyksXG4gICAgICAgIGVkZ2VBbmdsZVRhbmdlbnQgPSBmaXJzdEVkZ2VFeHRlbnRDb21wb25lbnQgLyBzZWNvbmRFZGdlRXh0ZW50Q29tcG9uZW50LFxuICAgICAgICBlZGdlQW5nbGVUYW5nZW50QXBwcm94aW1hdGVseUVxdWFsVG9aZXJvID0gaXNBcHByb3hpbWF0ZWx5RXF1YWxUb1plcm8oZWRnZUFuZ2xlVGFuZ2VudCksXG4gICAgICAgIGVkZ2VQYXJhbGxlbCA9IGVkZ2VBbmdsZVRhbmdlbnRBcHByb3hpbWF0ZWx5RXF1YWxUb1plcm8sIC8vL1xuICAgICAgICBlZGdlTm9uUGFyYWxsZWwgPSAhZWRnZVBhcmFsbGVsO1xuXG4gIHJldHVybiBlZGdlTm9uUGFyYWxsZWw7XG59XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZUVkZ2VJbnRlcnNlY3Rpb24oZWRnZSwgZmlyc3RQb3NpdGlvbkNvbXBvbmVudCkge1xuICBjb25zdCBlZGdlRXh0ZW50ID0gZWRnZS5nZXRFeHRlbnQoKSxcbiAgICAgICAgZWRnZVBvc2l0aW9uID0gZWRnZS5nZXRQb3NpdGlvbigpLFxuICAgICAgICBlZGdlRXh0ZW50Q29tcG9uZW50cyA9IGVkZ2VFeHRlbnQsIC8vL1xuICAgICAgICBlZGdlUG9zaXRpb25Db21wb25lbnRzID0gZWRnZVBvc2l0aW9uLCAvLy9cbiAgICAgICAgZmlyc3RFZGdlRXh0ZW50Q29tcG9uZW50ID0gZmlyc3QoZWRnZUV4dGVudENvbXBvbmVudHMpLFxuICAgICAgICBmaXJzdEVkZ2VQb3NpdGlvbkNvbXBvbmVudCA9IGZpcnN0KGVkZ2VQb3NpdGlvbkNvbXBvbmVudHMpLFxuICAgICAgICBlZGdlSW50ZXJzZWN0aW9uID0gKGZpcnN0UG9zaXRpb25Db21wb25lbnQgLSBmaXJzdEVkZ2VQb3NpdGlvbkNvbXBvbmVudCkgLyBmaXJzdEVkZ2VFeHRlbnRDb21wb25lbnQ7XG5cbiAgcmV0dXJuIGVkZ2VJbnRlcnNlY3Rpb247XG59XG4iXX0=
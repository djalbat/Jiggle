'use strict';

var vectorMaths = require('../maths/vector'),
    arrayUtilities = require('../utilities/array'),
    approximateUtilities = require('../utilities/approximate');

var add3 = vectorMaths.add3,
    subtract3 = vectorMaths.subtract3,
    scale3 = vectorMaths.scale3,
    first = arrayUtilities.first,
    second = arrayUtilities.second,
    isApproximatelyEqualToZero = approximateUtilities.isApproximatelyEqualToZero;


function calculateIntersection(edge, firstPositionComponent) {
  var intersection = null;

  var edgeNonParallel = isEdgeNonParallel(edge);

  if (edgeNonParallel) {
    var edgeIntersection = calculateEdgeIntersection(edge, firstPositionComponent),
        edgeIntersectionNonTrivial = edgeIntersection > 0 && edgeIntersection < 1;

    if (edgeIntersectionNonTrivial) {
      intersection = edgeIntersection; ///
    }
  }

  return intersection;
}

function calculateNonNullIntersections(intersections) {
  var nonNullIntersections = intersections.reduce(function (nonNullIntersections, intersection) {
    if (intersection !== null) {
      var nonNullIntersection = intersection; ///

      nonNullIntersections.push(nonNullIntersection);
    }

    return nonNullIntersections;
  }, []);

  return nonNullIntersections;
}

function calculateNullIntersectionIndex(intersections) {
  var nullIntersectionIndex = intersections.reduce(function (nullIntersectionIndex, intersection, index) {
    if (nullIntersectionIndex === null) {
      if (intersection === null) {
        nullIntersectionIndex = index;
      }
    }

    return nullIntersectionIndex;
  }, null);

  return nullIntersectionIndex;
}

function calculateNonNullIntersectionIndex(intersections) {
  var nullIntersectionIndex = intersections.reduce(function (nullIntersectionIndex, intersection, index) {
    if (nullIntersectionIndex === null) {
      if (intersection !== null) {
        nullIntersectionIndex = index;
      }
    }

    return nullIntersectionIndex;
  }, null);

  return nullIntersectionIndex;
}

function calculateIntermediateVertexPosition(startVertexPosition, endVertexPosition, intersection) {
  var extent = subtract3(endVertexPosition, startVertexPosition),
      offset = scale3(extent, intersection),
      intermediateVertexPosition = add3(startVertexPosition, offset);

  return intermediateVertexPosition;
}

module.exports = module.exports = {
  calculateIntersection: calculateIntersection,
  calculateNonNullIntersections: calculateNonNullIntersections,
  calculateNullIntersectionIndex: calculateNullIntersectionIndex,
  calculateNonNullIntersectionIndex: calculateNonNullIntersectionIndex,
  calculateIntermediateVertexPosition: calculateIntermediateVertexPosition
};

function isEdgeNonParallel(edge) {
  var edgeExtent = edge.getExtent(),
      edgeExtentComponents = edgeExtent,
      ///
  firstEdgeExtentComponent = first(edgeExtentComponents),
      secondEdgeExtentComponent = second(edgeExtentComponents),
      edgeAngleTangent = firstEdgeExtentComponent / secondEdgeExtentComponent,
      edgeAngleTangentApproximatelyEqualToZero = isApproximatelyEqualToZero(edgeAngleTangent),
      edgeParallel = edgeAngleTangentApproximatelyEqualToZero,
      ///
  edgeNonParallel = !edgeParallel;

  return edgeNonParallel;
}

function calculateEdgeIntersection(edge, firstPositionComponent) {
  var edgePosition = edge.getPosition(),
      edgeExtent = edge.getExtent(),
      edgePositionComponents = edgePosition,
      ///
  edgeExtentComponents = edgeExtent,
      ///
  firstEdgePositionComponent = first(edgePositionComponents),
      firstEdgeExtentComponent = first(edgeExtentComponents),
      edgeIntersection = (firstPositionComponent - firstEdgePositionComponent) / firstEdgeExtentComponent;

  return edgeIntersection;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi91dGlsaXRpZXMvaW50ZXJzZWN0aW9uLmpzIl0sIm5hbWVzIjpbInZlY3Rvck1hdGhzIiwicmVxdWlyZSIsImFycmF5VXRpbGl0aWVzIiwiYXBwcm94aW1hdGVVdGlsaXRpZXMiLCJhZGQzIiwic3VidHJhY3QzIiwic2NhbGUzIiwiZmlyc3QiLCJzZWNvbmQiLCJpc0FwcHJveGltYXRlbHlFcXVhbFRvWmVybyIsImNhbGN1bGF0ZUludGVyc2VjdGlvbiIsImVkZ2UiLCJmaXJzdFBvc2l0aW9uQ29tcG9uZW50IiwiaW50ZXJzZWN0aW9uIiwiZWRnZU5vblBhcmFsbGVsIiwiaXNFZGdlTm9uUGFyYWxsZWwiLCJlZGdlSW50ZXJzZWN0aW9uIiwiY2FsY3VsYXRlRWRnZUludGVyc2VjdGlvbiIsImVkZ2VJbnRlcnNlY3Rpb25Ob25Ucml2aWFsIiwiY2FsY3VsYXRlTm9uTnVsbEludGVyc2VjdGlvbnMiLCJpbnRlcnNlY3Rpb25zIiwibm9uTnVsbEludGVyc2VjdGlvbnMiLCJyZWR1Y2UiLCJub25OdWxsSW50ZXJzZWN0aW9uIiwicHVzaCIsImNhbGN1bGF0ZU51bGxJbnRlcnNlY3Rpb25JbmRleCIsIm51bGxJbnRlcnNlY3Rpb25JbmRleCIsImluZGV4IiwiY2FsY3VsYXRlTm9uTnVsbEludGVyc2VjdGlvbkluZGV4IiwiY2FsY3VsYXRlSW50ZXJtZWRpYXRlVmVydGV4UG9zaXRpb24iLCJzdGFydFZlcnRleFBvc2l0aW9uIiwiZW5kVmVydGV4UG9zaXRpb24iLCJleHRlbnQiLCJvZmZzZXQiLCJpbnRlcm1lZGlhdGVWZXJ0ZXhQb3NpdGlvbiIsIm1vZHVsZSIsImV4cG9ydHMiLCJlZGdlRXh0ZW50IiwiZ2V0RXh0ZW50IiwiZWRnZUV4dGVudENvbXBvbmVudHMiLCJmaXJzdEVkZ2VFeHRlbnRDb21wb25lbnQiLCJzZWNvbmRFZGdlRXh0ZW50Q29tcG9uZW50IiwiZWRnZUFuZ2xlVGFuZ2VudCIsImVkZ2VBbmdsZVRhbmdlbnRBcHByb3hpbWF0ZWx5RXF1YWxUb1plcm8iLCJlZGdlUGFyYWxsZWwiLCJlZGdlUG9zaXRpb24iLCJnZXRQb3NpdGlvbiIsImVkZ2VQb3NpdGlvbkNvbXBvbmVudHMiLCJmaXJzdEVkZ2VQb3NpdGlvbkNvbXBvbmVudCJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsSUFBTUEsY0FBY0MsUUFBUSxpQkFBUixDQUFwQjtBQUFBLElBQ01DLGlCQUFpQkQsUUFBUSxvQkFBUixDQUR2QjtBQUFBLElBRU1FLHVCQUF1QkYsUUFBUSwwQkFBUixDQUY3Qjs7SUFJUUcsSSxHQUE0QkosVyxDQUE1QkksSTtJQUFNQyxTLEdBQXNCTCxXLENBQXRCSyxTO0lBQVdDLE0sR0FBV04sVyxDQUFYTSxNO0lBQ2pCQyxLLEdBQWtCTCxjLENBQWxCSyxLO0lBQU9DLE0sR0FBV04sYyxDQUFYTSxNO0lBQ1BDLDBCLEdBQStCTixvQixDQUEvQk0sMEI7OztBQUVSLFNBQVNDLHFCQUFULENBQStCQyxJQUEvQixFQUFxQ0Msc0JBQXJDLEVBQTZEO0FBQzNELE1BQUlDLGVBQWUsSUFBbkI7O0FBRUEsTUFBTUMsa0JBQWtCQyxrQkFBa0JKLElBQWxCLENBQXhCOztBQUVBLE1BQUlHLGVBQUosRUFBcUI7QUFDbkIsUUFBTUUsbUJBQW1CQywwQkFBMEJOLElBQTFCLEVBQWdDQyxzQkFBaEMsQ0FBekI7QUFBQSxRQUNNTSw2QkFBK0JGLG1CQUFtQixDQUFwQixJQUE0QkEsbUJBQW1CLENBRG5GOztBQUdBLFFBQUlFLDBCQUFKLEVBQWdDO0FBQzlCTCxxQkFBZUcsZ0JBQWYsQ0FEOEIsQ0FDSTtBQUNuQztBQUNGOztBQUVELFNBQU9ILFlBQVA7QUFDRDs7QUFFRCxTQUFTTSw2QkFBVCxDQUF1Q0MsYUFBdkMsRUFBc0Q7QUFDcEQsTUFBTUMsdUJBQXVCRCxjQUFjRSxNQUFkLENBQXFCLFVBQVNELG9CQUFULEVBQStCUixZQUEvQixFQUE2QztBQUM3RixRQUFJQSxpQkFBaUIsSUFBckIsRUFBMkI7QUFDekIsVUFBTVUsc0JBQXNCVixZQUE1QixDQUR5QixDQUNp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ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgdmVjdG9yTWF0aHMgPSByZXF1aXJlKCcuLi9tYXRocy92ZWN0b3InKSxcbiAgICAgIGFycmF5VXRpbGl0aWVzID0gcmVxdWlyZSgnLi4vdXRpbGl0aWVzL2FycmF5JyksXG4gICAgICBhcHByb3hpbWF0ZVV0aWxpdGllcyA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9hcHByb3hpbWF0ZScpO1xuXG5jb25zdCB7IGFkZDMsIHN1YnRyYWN0Mywgc2NhbGUzIH0gPSB2ZWN0b3JNYXRocyxcbiAgICAgIHsgZmlyc3QsIHNlY29uZCB9ID0gYXJyYXlVdGlsaXRpZXMsXG4gICAgICB7IGlzQXBwcm94aW1hdGVseUVxdWFsVG9aZXJvIH0gPSBhcHByb3hpbWF0ZVV0aWxpdGllcztcblxuZnVuY3Rpb24gY2FsY3VsYXRlSW50ZXJzZWN0aW9uKGVkZ2UsIGZpcnN0UG9zaXRpb25Db21wb25lbnQpIHtcbiAgbGV0IGludGVyc2VjdGlvbiA9IG51bGw7XG5cbiAgY29uc3QgZWRnZU5vblBhcmFsbGVsID0gaXNFZGdlTm9uUGFyYWxsZWwoZWRnZSk7XG5cbiAgaWYgKGVkZ2VOb25QYXJhbGxlbCkge1xuICAgIGNvbnN0IGVkZ2VJbnRlcnNlY3Rpb24gPSBjYWxjdWxhdGVFZGdlSW50ZXJzZWN0aW9uKGVkZ2UsIGZpcnN0UG9zaXRpb25Db21wb25lbnQpLFxuICAgICAgICAgIGVkZ2VJbnRlcnNlY3Rpb25Ob25Ucml2aWFsID0gKChlZGdlSW50ZXJzZWN0aW9uID4gMCApICYmIChlZGdlSW50ZXJzZWN0aW9uIDwgMSkpO1xuXG4gICAgaWYgKGVkZ2VJbnRlcnNlY3Rpb25Ob25Ucml2aWFsKSB7XG4gICAgICBpbnRlcnNlY3Rpb24gPSBlZGdlSW50ZXJzZWN0aW9uOyAgLy8vXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGludGVyc2VjdGlvbjtcbn1cblxuZnVuY3Rpb24gY2FsY3VsYXRlTm9uTnVsbEludGVyc2VjdGlvbnMoaW50ZXJzZWN0aW9ucykge1xuICBjb25zdCBub25OdWxsSW50ZXJzZWN0aW9ucyA9IGludGVyc2VjdGlvbnMucmVkdWNlKGZ1bmN0aW9uKG5vbk51bGxJbnRlcnNlY3Rpb25zLCBpbnRlcnNlY3Rpb24pIHtcbiAgICBpZiAoaW50ZXJzZWN0aW9uICE9PSBudWxsKSB7XG4gICAgICBjb25zdCBub25OdWxsSW50ZXJzZWN0aW9uID0gaW50ZXJzZWN0aW9uOyAvLy9cblxuICAgICAgbm9uTnVsbEludGVyc2VjdGlvbnMucHVzaChub25OdWxsSW50ZXJzZWN0aW9uKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbm9uTnVsbEludGVyc2VjdGlvbnM7XG4gIH0sIFtdKTtcblxuICByZXR1cm4gbm9uTnVsbEludGVyc2VjdGlvbnM7XG59XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZU51bGxJbnRlcnNlY3Rpb25JbmRleChpbnRlcnNlY3Rpb25zKSB7XG4gIGNvbnN0IG51bGxJbnRlcnNlY3Rpb25JbmRleCA9IGludGVyc2VjdGlvbnMucmVkdWNlKGZ1bmN0aW9uKG51bGxJbnRlcnNlY3Rpb25JbmRleCwgaW50ZXJzZWN0aW9uLCBpbmRleCkge1xuICAgIGlmIChudWxsSW50ZXJzZWN0aW9uSW5kZXggPT09IG51bGwpIHtcbiAgICAgIGlmIChpbnRlcnNlY3Rpb24gPT09IG51bGwpIHtcbiAgICAgICAgbnVsbEludGVyc2VjdGlvbkluZGV4ID0gaW5kZXg7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGxJbnRlcnNlY3Rpb25JbmRleDtcbiAgfSwgbnVsbCk7XG5cbiAgcmV0dXJuIG51bGxJbnRlcnNlY3Rpb25JbmRleDtcbn1cblxuZnVuY3Rpb24gY2FsY3VsYXRlTm9uTnVsbEludGVyc2VjdGlvbkluZGV4KGludGVyc2VjdGlvbnMpIHtcbiAgY29uc3QgbnVsbEludGVyc2VjdGlvbkluZGV4ID0gaW50ZXJzZWN0aW9ucy5yZWR1Y2UoZnVuY3Rpb24obnVsbEludGVyc2VjdGlvbkluZGV4LCBpbnRlcnNlY3Rpb24sIGluZGV4KSB7XG4gICAgaWYgKG51bGxJbnRlcnNlY3Rpb25JbmRleCA9PT0gbnVsbCkge1xuICAgICAgaWYgKGludGVyc2VjdGlvbiAhPT0gbnVsbCkge1xuICAgICAgICBudWxsSW50ZXJzZWN0aW9uSW5kZXggPSBpbmRleDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbEludGVyc2VjdGlvbkluZGV4O1xuICB9LCBudWxsKTtcblxuICByZXR1cm4gbnVsbEludGVyc2VjdGlvbkluZGV4O1xufVxuXG5mdW5jdGlvbiBjYWxjdWxhdGVJbnRlcm1lZGlhdGVWZXJ0ZXhQb3NpdGlvbihzdGFydFZlcnRleFBvc2l0aW9uLCBlbmRWZXJ0ZXhQb3NpdGlvbiwgaW50ZXJzZWN0aW9uKSB7XG4gIGNvbnN0IGV4dGVudCA9IHN1YnRyYWN0MyhlbmRWZXJ0ZXhQb3NpdGlvbiwgc3RhcnRWZXJ0ZXhQb3NpdGlvbiksXG4gICAgICAgIG9mZnNldCA9IHNjYWxlMyhleHRlbnQsIGludGVyc2VjdGlvbiksXG4gICAgICAgIGludGVybWVkaWF0ZVZlcnRleFBvc2l0aW9uID0gYWRkMyhzdGFydFZlcnRleFBvc2l0aW9uLCBvZmZzZXQpO1xuXG4gIHJldHVybiBpbnRlcm1lZGlhdGVWZXJ0ZXhQb3NpdGlvbjtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgY2FsY3VsYXRlSW50ZXJzZWN0aW9uOiBjYWxjdWxhdGVJbnRlcnNlY3Rpb24sXG4gIGNhbGN1bGF0ZU5vbk51bGxJbnRlcnNlY3Rpb25zOiBjYWxjdWxhdGVOb25OdWxsSW50ZXJzZWN0aW9ucyxcbiAgY2FsY3VsYXRlTnVsbEludGVyc2VjdGlvbkluZGV4OiBjYWxjdWxhdGVOdWxsSW50ZXJzZWN0aW9uSW5kZXgsXG4gIGNhbGN1bGF0ZU5vbk51bGxJbnRlcnNlY3Rpb25JbmRleDogY2FsY3VsYXRlTm9uTnVsbEludGVyc2VjdGlvbkluZGV4LFxuICBjYWxjdWxhdGVJbnRlcm1lZGlhdGVWZXJ0ZXhQb3NpdGlvbjogY2FsY3VsYXRlSW50ZXJtZWRpYXRlVmVydGV4UG9zaXRpb25cbn07XG5cbmZ1bmN0aW9uIGlzRWRnZU5vblBhcmFsbGVsKGVkZ2UpIHtcbiAgY29uc3QgZWRnZUV4dGVudCA9IGVkZ2UuZ2V0RXh0ZW50KCksXG4gICAgICAgIGVkZ2VFeHRlbnRDb21wb25lbnRzID0gZWRnZUV4dGVudCwgLy8vXG4gICAgICAgIGZpcnN0RWRnZUV4dGVudENvbXBvbmVudCA9IGZpcnN0KGVkZ2VFeHRlbnRDb21wb25lbnRzKSxcbiAgICAgICAgc2Vjb25kRWRnZUV4dGVudENvbXBvbmVudCA9IHNlY29uZChlZGdlRXh0ZW50Q29tcG9uZW50cyksXG4gICAgICAgIGVkZ2VBbmdsZVRhbmdlbnQgPSBmaXJzdEVkZ2VFeHRlbnRDb21wb25lbnQgLyBzZWNvbmRFZGdlRXh0ZW50Q29tcG9uZW50LFxuICAgICAgICBlZGdlQW5nbGVUYW5nZW50QXBwcm94aW1hdGVseUVxdWFsVG9aZXJvID0gaXNBcHByb3hpbWF0ZWx5RXF1YWxUb1plcm8oZWRnZUFuZ2xlVGFuZ2VudCksXG4gICAgICAgIGVkZ2VQYXJhbGxlbCA9IGVkZ2VBbmdsZVRhbmdlbnRBcHByb3hpbWF0ZWx5RXF1YWxUb1plcm8sIC8vL1xuICAgICAgICBlZGdlTm9uUGFyYWxsZWwgPSAhZWRnZVBhcmFsbGVsO1xuXG4gIHJldHVybiBlZGdlTm9uUGFyYWxsZWw7XG59XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZUVkZ2VJbnRlcnNlY3Rpb24oZWRnZSwgZmlyc3RQb3NpdGlvbkNvbXBvbmVudCkge1xuICBjb25zdCBlZGdlUG9zaXRpb24gPSBlZGdlLmdldFBvc2l0aW9uKCksXG4gICAgICAgIGVkZ2VFeHRlbnQgPSBlZGdlLmdldEV4dGVudCgpLFxuICAgICAgICBlZGdlUG9zaXRpb25Db21wb25lbnRzID0gZWRnZVBvc2l0aW9uLCAvLy9cbiAgICAgICAgZWRnZUV4dGVudENvbXBvbmVudHMgPSBlZGdlRXh0ZW50LCAvLy9cbiAgICAgICAgZmlyc3RFZGdlUG9zaXRpb25Db21wb25lbnQgPSBmaXJzdChlZGdlUG9zaXRpb25Db21wb25lbnRzKSxcbiAgICAgICAgZmlyc3RFZGdlRXh0ZW50Q29tcG9uZW50ID0gZmlyc3QoZWRnZUV4dGVudENvbXBvbmVudHMpLFxuICAgICAgICBlZGdlSW50ZXJzZWN0aW9uID0gKGZpcnN0UG9zaXRpb25Db21wb25lbnQgLSBmaXJzdEVkZ2VQb3NpdGlvbkNvbXBvbmVudCkgLyBmaXJzdEVkZ2VFeHRlbnRDb21wb25lbnQ7XG5cbiAgcmV0dXJuIGVkZ2VJbnRlcnNlY3Rpb247XG59XG4iXX0=
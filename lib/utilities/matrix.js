"use strict";

var constants = require("../constants"),
    matrixMaths = require("../maths/matrix"),
    vectorMaths = require("../maths/vector"),
    arrayUtilities = require("../utilities/array");

var scale3 = vectorMaths.scale3,
    first = arrayUtilities.first,
    second = arrayUtilities.second,
    third = arrayUtilities.third,
    DEGREES_TO_RADIANS_SCALAR = constants.DEGREES_TO_RADIANS_SCALAR,
    FIELD_OF_VIEW = constants.FIELD_OF_VIEW,
    Z_NEAR = constants.Z_NEAR,
    Z_FAR = constants.Z_FAR,
    identity4 = matrixMaths.identity4,
    scale4 = matrixMaths.scale4,
    invert4 = matrixMaths.invert4,
    rotate4 = matrixMaths.rotate4,
    translate4 = matrixMaths.translate4,
    transpose4 = matrixMaths.transpose4,
    perspective4 = matrixMaths.perspective4;

function scaleMatrixFromScale(scale) {
  var scaleMatrix = identity4();
  scaleMatrix = scale4(scaleMatrix, scale);
  return scaleMatrix;
}

function offsetsMatrixFromOffsets(offsets) {
  var offsetsMatrix = identity4(); ///

  offsetsMatrix = translate4(offsetsMatrix, offsets);
  return offsetsMatrix;
}

function positionMatrixFromNothing() {
  var positionMatrix = identity4(); ///

  return positionMatrix;
}

function positionMatrixFromDistance(distance) {
  var positionMatrix = identity4(); ///

  var x = 0,
      y = 0,
      z = -distance;
  positionMatrix = translate4(positionMatrix, [x, y, z]);
  return positionMatrix;
}

function positionMatrixFromPosition(position) {
  var positionMatrix = identity4(); ///

  positionMatrix = translate4(positionMatrix, position);
  return positionMatrix;
}

function rotationsMatrixFromAngles(angles) {
  var reverseOrder = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  var rotationsMatrix = identity4(); ///

  var firstAngle = first(angles),
      secondAngle = second(angles),
      thirdAngle = third(angles),
      xAngle = firstAngle,
      yAngle = secondAngle,
      zAngle = thirdAngle,
      xAxis = [1, 0, 0],
      yAxis = [0, 1, 0],
      zAxis = [0, 0, 1];

  if (reverseOrder) {
    rotationsMatrix = rotate4(rotationsMatrix, zAngle, zAxis);
    rotationsMatrix = rotate4(rotationsMatrix, yAngle, yAxis);
    rotationsMatrix = rotate4(rotationsMatrix, xAngle, xAxis);
  } else {
    rotationsMatrix = rotate4(rotationsMatrix, xAngle, xAxis);
    rotationsMatrix = rotate4(rotationsMatrix, yAngle, yAxis);
    rotationsMatrix = rotate4(rotationsMatrix, zAngle, zAxis);
  }

  return rotationsMatrix;
}

function rotationsMatrixFromRotations(rotations) {
  var scalar = DEGREES_TO_RADIANS_SCALAR,
      angles = scale3(rotations, scalar),
      rotationsMatrix = rotationsMatrixFromAngles(angles);
  return rotationsMatrix;
}

function normalsMatrixFromRotationsMatrix(rotationsMatrix) {
  var normalsMatrix = invert4(rotationsMatrix);
  normalsMatrix = transpose4(normalsMatrix);
  return normalsMatrix;
}

function projectionMatrixFromWidthAndHeight(width, height) {
  var fieldOfView = FIELD_OF_VIEW,
      ///
  aspectRatio = width / height,
      zNear = Z_NEAR,
      ///
  zFar = Z_FAR,
      ///
  projectionMatrix = perspective4(fieldOfView, aspectRatio, zNear, zFar);
  return projectionMatrix;
}

module.exports = {
  scaleMatrixFromScale: scaleMatrixFromScale,
  offsetsMatrixFromOffsets: offsetsMatrixFromOffsets,
  positionMatrixFromNothing: positionMatrixFromNothing,
  positionMatrixFromDistance: positionMatrixFromDistance,
  positionMatrixFromPosition: positionMatrixFromPosition,
  rotationsMatrixFromAngles: rotationsMatrixFromAngles,
  rotationsMatrixFromRotations: rotationsMatrixFromRotations,
  normalsMatrixFromRotationsMatrix: normalsMatrixFromRotationsMatrix,
  projectionMatrixFromWidthAndHeight: projectionMatrixFromWidthAndHeight
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hdHJpeC5qcyJdLCJuYW1lcyI6WyJjb25zdGFudHMiLCJyZXF1aXJlIiwibWF0cml4TWF0aHMiLCJ2ZWN0b3JNYXRocyIsImFycmF5VXRpbGl0aWVzIiwic2NhbGUzIiwiZmlyc3QiLCJzZWNvbmQiLCJ0aGlyZCIsIkRFR1JFRVNfVE9fUkFESUFOU19TQ0FMQVIiLCJGSUVMRF9PRl9WSUVXIiwiWl9ORUFSIiwiWl9GQVIiLCJpZGVudGl0eTQiLCJzY2FsZTQiLCJpbnZlcnQ0Iiwicm90YXRlNCIsInRyYW5zbGF0ZTQiLCJ0cmFuc3Bvc2U0IiwicGVyc3BlY3RpdmU0Iiwic2NhbGVNYXRyaXhGcm9tU2NhbGUiLCJzY2FsZSIsInNjYWxlTWF0cml4Iiwib2Zmc2V0c01hdHJpeEZyb21PZmZzZXRzIiwib2Zmc2V0cyIsIm9mZnNldHNNYXRyaXgiLCJwb3NpdGlvbk1hdHJpeEZyb21Ob3RoaW5nIiwicG9zaXRpb25NYXRyaXgiLCJwb3NpdGlvbk1hdHJpeEZyb21EaXN0YW5jZSIsImRpc3RhbmNlIiwieCIsInkiLCJ6IiwicG9zaXRpb25NYXRyaXhGcm9tUG9zaXRpb24iLCJwb3NpdGlvbiIsInJvdGF0aW9uc01hdHJpeEZyb21BbmdsZXMiLCJhbmdsZXMiLCJyZXZlcnNlT3JkZXIiLCJyb3RhdGlvbnNNYXRyaXgiLCJmaXJzdEFuZ2xlIiwic2Vjb25kQW5nbGUiLCJ0aGlyZEFuZ2xlIiwieEFuZ2xlIiwieUFuZ2xlIiwiekFuZ2xlIiwieEF4aXMiLCJ5QXhpcyIsInpBeGlzIiwicm90YXRpb25zTWF0cml4RnJvbVJvdGF0aW9ucyIsInJvdGF0aW9ucyIsInNjYWxhciIsIm5vcm1hbHNNYXRyaXhGcm9tUm90YXRpb25zTWF0cml4Iiwibm9ybWFsc01hdHJpeCIsInByb2plY3Rpb25NYXRyaXhGcm9tV2lkdGhBbmRIZWlnaHQiLCJ3aWR0aCIsImhlaWdodCIsImZpZWxkT2ZWaWV3IiwiYXNwZWN0UmF0aW8iLCJ6TmVhciIsInpGYXIiLCJwcm9qZWN0aW9uTWF0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O0FBT2ZhLEVBQUFBLDRCQUE0QixFQUE1QkEsNEJBUGU7QUFRZkcsRUFBQUEsZ0NBQWdDLEVBQWhDQSxnQ0FSZTtBQVNmRSxFQUFBQSxrQ0FBa0MsRUFBbENBO0FBVGUsQ0FBakIiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuY29uc3QgY29uc3RhbnRzID0gcmVxdWlyZShcIi4uL2NvbnN0YW50c1wiKSxcbiAgICAgIG1hdHJpeE1hdGhzID0gcmVxdWlyZShcIi4uL21hdGhzL21hdHJpeFwiKSxcbiAgICAgIHZlY3Rvck1hdGhzID0gcmVxdWlyZShcIi4uL21hdGhzL3ZlY3RvclwiKSxcbiAgICAgIGFycmF5VXRpbGl0aWVzID0gcmVxdWlyZShcIi4uL3V0aWxpdGllcy9hcnJheVwiKTtcblxuY29uc3QgeyBzY2FsZTMgfSA9IHZlY3Rvck1hdGhzLFxuICAgICAgeyBmaXJzdCwgc2Vjb25kLCB0aGlyZCB9ID0gYXJyYXlVdGlsaXRpZXMsXG4gICAgICB7IERFR1JFRVNfVE9fUkFESUFOU19TQ0FMQVIsIEZJRUxEX09GX1ZJRVcsIFpfTkVBUiwgWl9GQVIgfSA9IGNvbnN0YW50cyxcbiAgICAgIHsgaWRlbnRpdHk0LCBzY2FsZTQsIGludmVydDQsIHJvdGF0ZTQsIHRyYW5zbGF0ZTQsIHRyYW5zcG9zZTQsIHBlcnNwZWN0aXZlNCB9ID0gbWF0cml4TWF0aHM7XG5cbmZ1bmN0aW9uIHNjYWxlTWF0cml4RnJvbVNjYWxlKHNjYWxlKSB7XG4gIGxldCBzY2FsZU1hdHJpeCA9IGlkZW50aXR5NCgpO1xuXG4gIHNjYWxlTWF0cml4ID0gc2NhbGU0KHNjYWxlTWF0cml4LCBzY2FsZSk7XG5cbiAgcmV0dXJuIHNjYWxlTWF0cml4O1xufVxuXG5mdW5jdGlvbiBvZmZzZXRzTWF0cml4RnJvbU9mZnNldHMob2Zmc2V0cykge1xuICBsZXQgb2Zmc2V0c01hdHJpeCA9IGlkZW50aXR5NCgpOyAvLy9cblxuICBvZmZzZXRzTWF0cml4ID0gdHJhbnNsYXRlNChvZmZzZXRzTWF0cml4LCBvZmZzZXRzKTtcblxuICByZXR1cm4gb2Zmc2V0c01hdHJpeDtcbn1cblxuZnVuY3Rpb24gcG9zaXRpb25NYXRyaXhGcm9tTm90aGluZygpIHtcbiAgbGV0IHBvc2l0aW9uTWF0cml4ID0gaWRlbnRpdHk0KCk7IC8vL1xuXG4gIHJldHVybiBwb3NpdGlvbk1hdHJpeDtcbn1cblxuZnVuY3Rpb24gcG9zaXRpb25NYXRyaXhGcm9tRGlzdGFuY2UoZGlzdGFuY2UpIHtcbiAgbGV0IHBvc2l0aW9uTWF0cml4ID0gaWRlbnRpdHk0KCk7IC8vL1xuXG4gIGNvbnN0IHggPSAwLFxuICAgICAgICB5ID0gMCxcbiAgICAgICAgeiA9IC1kaXN0YW5jZTtcblxuICBwb3NpdGlvbk1hdHJpeCA9IHRyYW5zbGF0ZTQocG9zaXRpb25NYXRyaXgsIFsgeCwgeSwgeiBdKTtcblxuICByZXR1cm4gcG9zaXRpb25NYXRyaXg7XG59XG5cbmZ1bmN0aW9uIHBvc2l0aW9uTWF0cml4RnJvbVBvc2l0aW9uKHBvc2l0aW9uKSB7XG4gIGxldCBwb3NpdGlvbk1hdHJpeCA9IGlkZW50aXR5NCgpOyAvLy9cblxuICBwb3NpdGlvbk1hdHJpeCA9IHRyYW5zbGF0ZTQocG9zaXRpb25NYXRyaXgsIHBvc2l0aW9uKTtcblxuICByZXR1cm4gcG9zaXRpb25NYXRyaXg7XG59XG5cbmZ1bmN0aW9uIHJvdGF0aW9uc01hdHJpeEZyb21BbmdsZXMoYW5nbGVzLCByZXZlcnNlT3JkZXIgPSBmYWxzZSkge1xuICBsZXQgcm90YXRpb25zTWF0cml4ID0gaWRlbnRpdHk0KCk7IC8vL1xuXG4gIGNvbnN0IGZpcnN0QW5nbGUgPSBmaXJzdChhbmdsZXMpLFxuICAgICAgICBzZWNvbmRBbmdsZSA9IHNlY29uZChhbmdsZXMpLFxuICAgICAgICB0aGlyZEFuZ2xlID0gdGhpcmQoYW5nbGVzKSxcbiAgICAgICAgeEFuZ2xlID0gZmlyc3RBbmdsZSxcbiAgICAgICAgeUFuZ2xlID0gc2Vjb25kQW5nbGUsXG4gICAgICAgIHpBbmdsZSA9IHRoaXJkQW5nbGUsXG4gICAgICAgIHhBeGlzID0gWyAxLCAwLCAwIF0sXG4gICAgICAgIHlBeGlzID0gWyAwLCAxLCAwIF0sXG4gICAgICAgIHpBeGlzID0gWyAwLCAwLCAxIF07XG5cbiAgaWYgKHJldmVyc2VPcmRlcikge1xuICAgIHJvdGF0aW9uc01hdHJpeCA9IHJvdGF0ZTQocm90YXRpb25zTWF0cml4LCB6QW5nbGUsIHpBeGlzKTtcblxuICAgIHJvdGF0aW9uc01hdHJpeCA9IHJvdGF0ZTQocm90YXRpb25zTWF0cml4LCB5QW5nbGUsIHlBeGlzKTtcblxuICAgIHJvdGF0aW9uc01hdHJpeCA9IHJvdGF0ZTQocm90YXRpb25zTWF0cml4LCB4QW5nbGUsIHhBeGlzKTtcbiAgfSBlbHNlIHtcbiAgICByb3RhdGlvbnNNYXRyaXggPSByb3RhdGU0KHJvdGF0aW9uc01hdHJpeCwgeEFuZ2xlLCB4QXhpcyk7XG5cbiAgICByb3RhdGlvbnNNYXRyaXggPSByb3RhdGU0KHJvdGF0aW9uc01hdHJpeCwgeUFuZ2xlLCB5QXhpcyk7XG5cbiAgICByb3RhdGlvbnNNYXRyaXggPSByb3RhdGU0KHJvdGF0aW9uc01hdHJpeCwgekFuZ2xlLCB6QXhpcyk7XG4gIH1cblxuICByZXR1cm4gcm90YXRpb25zTWF0cml4O1xufVxuXG5mdW5jdGlvbiByb3RhdGlvbnNNYXRyaXhGcm9tUm90YXRpb25zKHJvdGF0aW9ucykge1xuICBjb25zdCBzY2FsYXIgPSBERUdSRUVTX1RPX1JBRElBTlNfU0NBTEFSLFxuICAgICAgICBhbmdsZXMgPSBzY2FsZTMocm90YXRpb25zLCBzY2FsYXIpLFxuICAgICAgICByb3RhdGlvbnNNYXRyaXggPSByb3RhdGlvbnNNYXRyaXhGcm9tQW5nbGVzKGFuZ2xlcyk7XG5cbiAgcmV0dXJuIHJvdGF0aW9uc01hdHJpeDtcbn1cblxuZnVuY3Rpb24gbm9ybWFsc01hdHJpeEZyb21Sb3RhdGlvbnNNYXRyaXgocm90YXRpb25zTWF0cml4KSB7XG4gIGxldCBub3JtYWxzTWF0cml4ID0gaW52ZXJ0NChyb3RhdGlvbnNNYXRyaXgpO1xuXG4gIG5vcm1hbHNNYXRyaXggPSB0cmFuc3Bvc2U0KG5vcm1hbHNNYXRyaXgpO1xuXG4gIHJldHVybiBub3JtYWxzTWF0cml4O1xufVxuXG5mdW5jdGlvbiBwcm9qZWN0aW9uTWF0cml4RnJvbVdpZHRoQW5kSGVpZ2h0KHdpZHRoLCBoZWlnaHQpIHtcbiAgY29uc3QgZmllbGRPZlZpZXcgPSBGSUVMRF9PRl9WSUVXLCAgLy8vXG4gICAgICAgIGFzcGVjdFJhdGlvID0gd2lkdGggLyBoZWlnaHQsXG4gICAgICAgIHpOZWFyID0gWl9ORUFSLCAvLy9cbiAgICAgICAgekZhciA9IFpfRkFSLCAvLy9cbiAgICAgICAgcHJvamVjdGlvbk1hdHJpeCA9IHBlcnNwZWN0aXZlNChmaWVsZE9mVmlldywgYXNwZWN0UmF0aW8sIHpOZWFyLCB6RmFyKTtcblxuICByZXR1cm4gcHJvamVjdGlvbk1hdHJpeDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHNjYWxlTWF0cml4RnJvbVNjYWxlLFxuICBvZmZzZXRzTWF0cml4RnJvbU9mZnNldHMsXG4gIHBvc2l0aW9uTWF0cml4RnJvbU5vdGhpbmcsXG4gIHBvc2l0aW9uTWF0cml4RnJvbURpc3RhbmNlLFxuICBwb3NpdGlvbk1hdHJpeEZyb21Qb3NpdGlvbixcbiAgcm90YXRpb25zTWF0cml4RnJvbUFuZ2xlcyxcbiAgcm90YXRpb25zTWF0cml4RnJvbVJvdGF0aW9ucyxcbiAgbm9ybWFsc01hdHJpeEZyb21Sb3RhdGlvbnNNYXRyaXgsXG4gIHByb2plY3Rpb25NYXRyaXhGcm9tV2lkdGhBbmRIZWlnaHRcbn07XG4iXX0=
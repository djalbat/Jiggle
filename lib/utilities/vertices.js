'use strict';

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

var arrayUtilities = require('../utilities/array'),
    vectorUtilities = require('../utilities/vector'),
    rotationUtilities = require('../utilities/rotation');

var subtract3 = vectorUtilities.subtract3,
    cross3 = vectorUtilities.cross3,
    first = arrayUtilities.first,
    second = arrayUtilities.second,
    third = arrayUtilities.third,
    calculateInverseRotationQuaternion = rotationUtilities.calculateInverseRotationQuaternion,
    rotateImaginaryQuaternion = rotationUtilities.rotateImaginaryQuaternion;


function calculateNormal(vertices) {
  var firstVertex = first(vertices),
      secondVertex = second(vertices),
      thirdVertex = third(vertices),
      firstEdge = subtract3(secondVertex, firstVertex),
      secondEdge = subtract3(thirdVertex, firstVertex),
      normal = cross3(firstEdge, secondEdge);

  return normal;
}

function rotateVertices(vertices, rotationQuaternion) {
  var inverseRotationQuaternion = calculateInverseRotationQuaternion(rotationQuaternion);

  vertices = vertices.map(function (vertex) {
    vertex = rotateVertex(vertex, rotationQuaternion, inverseRotationQuaternion);

    return vertex;
  });

  return vertices;
}

module.exports = {
  calculateNormal: calculateNormal,
  rotateVertices: rotateVertices
};

function rotateVertex(vertex, rotationQuaternion, inverseRotationQuaternion) {
  var imaginaryQuaternion = [0].concat(_toConsumableArray(vertex)),
      ///
  rotatedImaginaryQuaternion = rotateImaginaryQuaternion(imaginaryQuaternion, rotationQuaternion, inverseRotationQuaternion);

  vertex = rotatedImaginaryQuaternion.slice(1); ///

  return vertex;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi91dGlsaXRpZXMvdmVydGljZXMuanMiXSwibmFtZXMiOlsiYXJyYXlVdGlsaXRpZXMiLCJyZXF1aXJlIiwidmVjdG9yVXRpbGl0aWVzIiwicm90YXRpb25VdGlsaXRpZXMiLCJzdWJ0cmFjdDMiLCJjcm9zczMiLCJmaXJzdCIsInNlY29uZCIsInRoaXJkIiwiY2FsY3VsYXRlSW52ZXJzZVJvdGF0aW9uUXVhdGVybmlvbiIsInJvdGF0ZUltYWdpbmFyeVF1YXRlcm5pb24iLCJjYWxjdWxhdGVOb3JtYWwiLCJ2ZXJ0aWNlcyIsImZpcnN0VmVydGV4Iiwic2Vjb25kVmVydGV4IiwidGhpcmRWZXJ0ZXgiLCJmaXJzdEVkZ2UiLCJzZWNvbmRFZGdlIiwibm9ybWFsIiwicm90YXRlVmVydGljZXMiLCJyb3RhdGlvblF1YXRlcm5pb24iLCJpbnZlcnNlUm90YXRpb25RdWF0ZXJuaW9uIiwibWFwIiwidmVydGV4Iiwicm90YXRlVmVydGV4IiwibW9kdWxlIiwiZXhwb3J0cyIsImltYWdpbmFyeVF1YXRlcm5pb24iLCJyb3RhdGVkSW1hZ2luYXJ5UXVhdGVybmlvbiIsInNsaWNlIl0sIm1hcHBpbmdzIjoiQUFBQTs7OztBQUVBLElBQU1BLGlCQUFpQkMsUUFBUSxvQkFBUixDQUF2QjtBQUFBLElBQ01DLGtCQUFrQkQsUUFBUSxxQkFBUixDQUR4QjtBQUFBLElBRU1FLG9CQUFvQkYsUUFBUSx1QkFBUixDQUYxQjs7SUFJUUcsUyxHQUFzQkYsZSxDQUF0QkUsUztJQUFXQyxNLEdBQVdILGUsQ0FBWEcsTTtJQUNYQyxLLEdBQXlCTixjLENBQXpCTSxLO0lBQU9DLE0sR0FBa0JQLGMsQ0FBbEJPLE07SUFBUUMsSyxHQUFVUixjLENBQVZRLEs7SUFDZkMsa0MsR0FBa0VOLGlCLENBQWxFTSxrQztJQUFvQ0MseUIsR0FBOEJQLGlCLENBQTlCTyx5Qjs7O0FBRTVDLFNBQVNDLGVBQVQsQ0FBeUJDLFFBQXpCLEVBQW1DO0FBQ2pDLE1BQU1DLGNBQWNQLE1BQU1NLFFBQU4sQ0FBcEI7QUFBQSxNQUNNRSxlQUFlUCxPQUFPSyxRQUFQLENBRHJCO0FBQUEsTUFFTUcsY0FBY1AsTUFBTUksUUFBTixDQUZwQjtBQUFBLE1BR01JLFlBQVlaLFVBQVVVLFlBQVYsRUFBd0JELFdBQXhCLENBSGxCO0FBQUEsTUFJTUksYUFBYWIsVUFBVVcsV0FBVixFQUF1QkYsV0FBdkIsQ0FKbkI7QUFBQSxNQUtNSyxTQUFTYixPQUFPVyxTQUFQLEVBQWtCQyxVQUFsQixDQUxmOztBQU9BLFNBQU9DLE1BQVA7QUFDRDs7QUFFRCxTQUFTQyxjQUFULENBQXdCUCxRQUF4QixFQUFrQ1Esa0JBQWxDLEVBQXNEO0FBQ3BELE1BQU1DLDRCQUE0QlosbUNBQW1DVyxrQkFBbkMsQ0FBbEM7O0FBRUFSLGFBQVdBLFNBQVNVLEdBQVQsQ0FBYSxVQUFTQyxNQUFULEVBQWlCO0FBQ3ZDQSxhQUFTQyxhQUFhRCxNQUFiLEVBQXFCSCxrQkFBckIsRUFBeUNDLHlCQUF6QyxDQUFUOztBQUVBLFdBQU9FLE1BQVA7QUFDRCxHQUpVLENBQVg7O0FBTUEsU0FBT1gsUUFBUDtBQUNEOztBQUVEYSxPQUFPQyxPQUFQLEdBQWlCO0FBQ2ZmLG1CQUFpQkEsZUFERjtBQUVmUSxrQkFBZ0JBO0FBRkQsQ0FBakI7O0FBS0EsU0FBU0ssWUFBVCxDQUFzQkQsTUFBdEIsRUFBOEJILGtCQUE5QixFQUFrREMseUJBQWxELEVBQTZFO0FBQzNFLE1BQU1NLHVCQUF1QixDQUF2Qiw0QkFBNkJKLE1BQTdCLEVBQU47QUFBQSxNQUE0QztBQUN0Q0ssK0JBQTZCbEIsMEJBQTBCaUIsbUJBQTFCLEVBQStDUCxrQkFBL0MsRUFBbUVDLHlCQUFuRSxDQURuQzs7QUFHQUUsV0FBU0ssMkJBQTJCQyxLQUEzQixDQUFpQyxDQUFqQyxDQUFULENBSjJFLENBSTdCOztBQUU5QyxTQUFPTixNQUFQO0FBQ0QiLCJmaWxlIjoidmVydGljZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IGFycmF5VXRpbGl0aWVzID0gcmVxdWlyZSgnLi4vdXRpbGl0aWVzL2FycmF5JyksXG4gICAgICB2ZWN0b3JVdGlsaXRpZXMgPSByZXF1aXJlKCcuLi91dGlsaXRpZXMvdmVjdG9yJyksXG4gICAgICByb3RhdGlvblV0aWxpdGllcyA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9yb3RhdGlvbicpO1xuXG5jb25zdCB7IHN1YnRyYWN0MywgY3Jvc3MzIH0gPSB2ZWN0b3JVdGlsaXRpZXMsXG4gICAgICB7IGZpcnN0LCBzZWNvbmQsIHRoaXJkIH0gPSBhcnJheVV0aWxpdGllcyxcbiAgICAgIHsgY2FsY3VsYXRlSW52ZXJzZVJvdGF0aW9uUXVhdGVybmlvbiwgcm90YXRlSW1hZ2luYXJ5UXVhdGVybmlvbiB9ID0gcm90YXRpb25VdGlsaXRpZXM7XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZU5vcm1hbCh2ZXJ0aWNlcykge1xuICBjb25zdCBmaXJzdFZlcnRleCA9IGZpcnN0KHZlcnRpY2VzKSxcbiAgICAgICAgc2Vjb25kVmVydGV4ID0gc2Vjb25kKHZlcnRpY2VzKSxcbiAgICAgICAgdGhpcmRWZXJ0ZXggPSB0aGlyZCh2ZXJ0aWNlcyksXG4gICAgICAgIGZpcnN0RWRnZSA9IHN1YnRyYWN0MyhzZWNvbmRWZXJ0ZXgsIGZpcnN0VmVydGV4KSxcbiAgICAgICAgc2Vjb25kRWRnZSA9IHN1YnRyYWN0Myh0aGlyZFZlcnRleCwgZmlyc3RWZXJ0ZXgpLFxuICAgICAgICBub3JtYWwgPSBjcm9zczMoZmlyc3RFZGdlLCBzZWNvbmRFZGdlKTtcblxuICByZXR1cm4gbm9ybWFsO1xufVxuXG5mdW5jdGlvbiByb3RhdGVWZXJ0aWNlcyh2ZXJ0aWNlcywgcm90YXRpb25RdWF0ZXJuaW9uKSB7XG4gIGNvbnN0IGludmVyc2VSb3RhdGlvblF1YXRlcm5pb24gPSBjYWxjdWxhdGVJbnZlcnNlUm90YXRpb25RdWF0ZXJuaW9uKHJvdGF0aW9uUXVhdGVybmlvbik7XG5cbiAgdmVydGljZXMgPSB2ZXJ0aWNlcy5tYXAoZnVuY3Rpb24odmVydGV4KSB7XG4gICAgdmVydGV4ID0gcm90YXRlVmVydGV4KHZlcnRleCwgcm90YXRpb25RdWF0ZXJuaW9uLCBpbnZlcnNlUm90YXRpb25RdWF0ZXJuaW9uKTtcblxuICAgIHJldHVybiB2ZXJ0ZXg7XG4gIH0pO1xuICBcbiAgcmV0dXJuIHZlcnRpY2VzO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgY2FsY3VsYXRlTm9ybWFsOiBjYWxjdWxhdGVOb3JtYWwsXG4gIHJvdGF0ZVZlcnRpY2VzOiByb3RhdGVWZXJ0aWNlc1xufTtcblxuZnVuY3Rpb24gcm90YXRlVmVydGV4KHZlcnRleCwgcm90YXRpb25RdWF0ZXJuaW9uLCBpbnZlcnNlUm90YXRpb25RdWF0ZXJuaW9uKSB7XG4gIGNvbnN0IGltYWdpbmFyeVF1YXRlcm5pb24gPSBbMCwgLi4udmVydGV4XSwgLy8vXG4gICAgICAgIHJvdGF0ZWRJbWFnaW5hcnlRdWF0ZXJuaW9uID0gcm90YXRlSW1hZ2luYXJ5UXVhdGVybmlvbihpbWFnaW5hcnlRdWF0ZXJuaW9uLCByb3RhdGlvblF1YXRlcm5pb24sIGludmVyc2VSb3RhdGlvblF1YXRlcm5pb24pO1xuXG4gIHZlcnRleCA9IHJvdGF0ZWRJbWFnaW5hcnlRdWF0ZXJuaW9uLnNsaWNlKDEpOyAvLy9cblxuICByZXR1cm4gdmVydGV4O1xufVxuIl19
'use strict';

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

var vectorMaths = require('../maths/vector'),
    arrayUtilities = require('../utilities/array'),
    quaternionUtilities = require('../utilities/quaternion');

var first = arrayUtilities.first,
    second = arrayUtilities.second,
    fourth = arrayUtilities.fourth,
    transform3 = vectorMaths.transform3,
    normalise3 = vectorMaths.normalise3,
    calculateInverseRotationQuaternion = quaternionUtilities.calculateInverseRotationQuaternion,
    rotateImaginaryQuaternion = quaternionUtilities.rotateImaginaryQuaternion;


function rotateVertices(vertices, rotationQuaternion) {
  var inverseRotationQuaternion = calculateInverseRotationQuaternion(rotationQuaternion);

  vertices = vertices.map(function (vertex) {
    vertex = rotateVertex(vertex, rotationQuaternion, inverseRotationQuaternion);

    return vertex;
  });

  return vertices;
}

function rotateVertexAboutZAxis(vertex, rotationAboutZAxisMatrix) {
  var matrix = rotationAboutZAxisMatrix; ///

  vertex = transform3(vertex, matrix);

  return vertex;
}

function rotatePositionAboutZAxis(position, rotationAboutZAxisMatrix) {
  var matrix = rotationAboutZAxisMatrix; ///

  position = transform3(position, matrix);

  return position;
}

function calculateRotationAboutZAxisMatrix(edgeInXYPlane) {
  var edgeInXYPlaneExtent = edgeInXYPlane.getExtent(),
      unitEdgeInXYPlaneExtent = normalise3(edgeInXYPlaneExtent),
      unitEdgeInXYPlaneExtentComponents = unitEdgeInXYPlaneExtent,
      ///
  firstUnitEdgeInXYPlaneExtentComponent = first(unitEdgeInXYPlaneExtentComponents),
      secondUnitEdgeInXYPlaneExtentComponent = second(unitEdgeInXYPlaneExtentComponents),
      angleOfRotationCosine = +secondUnitEdgeInXYPlaneExtentComponent,
      ///
  angleOfRotationSine = -firstUnitEdgeInXYPlaneExtentComponent,
      ///
  c = angleOfRotationCosine,
      s = angleOfRotationSine,
      rotationAboutZAxisMatrix = [c, -s, 0, +s, c, 0, 0, 0, 1]; ///

  return rotationAboutZAxisMatrix;
}

function calculateForwardsRotationAboutZAxisMatrix(rotationAboutZAxisMatrix) {
  var forwardsRotationAboutZAxisMatrix = rotationAboutZAxisMatrix; ///

  return forwardsRotationAboutZAxisMatrix;
}

function calculateBackwardsRotationAboutZAxisMatrix(rotationAboutZAxisMatrix) {
  var rotationAboutZAxisMatrixComponents = rotationAboutZAxisMatrix,
      ///
  firstRotationAboutZAxisMatrixComponent = first(rotationAboutZAxisMatrixComponents),
      fourthRotationAboutZAxisMatrixComponent = fourth(rotationAboutZAxisMatrixComponents),
      c = firstRotationAboutZAxisMatrixComponent,
      ///
  s = fourthRotationAboutZAxisMatrixComponent,
      ///
  backwardsRotationAboutZAxisMatrix = [c, +s, 0, -s, c, 0, 0, 0, 1];

  return backwardsRotationAboutZAxisMatrix;
}

module.exports = {
  rotateVertices: rotateVertices,
  rotateVertexAboutZAxis: rotateVertexAboutZAxis,
  rotatePositionAboutZAxis: rotatePositionAboutZAxis,
  calculateRotationAboutZAxisMatrix: calculateRotationAboutZAxisMatrix,
  calculateForwardsRotationAboutZAxisMatrix: calculateForwardsRotationAboutZAxisMatrix,
  calculateBackwardsRotationAboutZAxisMatrix: calculateBackwardsRotationAboutZAxisMatrix
};

function rotateVertex(vertex, rotationQuaternion, inverseRotationQuaternion) {
  var imaginaryQuaternion = [0].concat(_toConsumableArray(vertex)),
      ///
  rotatedImaginaryQuaternion = rotateImaginaryQuaternion(imaginaryQuaternion, rotationQuaternion, inverseRotationQuaternion);

  vertex = rotatedImaginaryQuaternion.slice(1); ///

  return vertex;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi91dGlsaXRpZXMvcm90YXRpb24uanMiXSwibmFtZXMiOlsidmVjdG9yTWF0aHMiLCJyZXF1aXJlIiwiYXJyYXlVdGlsaXRpZXMiLCJxdWF0ZXJuaW9uVXRpbGl0aWVzIiwiZmlyc3QiLCJzZWNvbmQiLCJmb3VydGgiLCJ0cmFuc2Zvcm0zIiwibm9ybWFsaXNlMyIsImNhbGN1bGF0ZUludmVyc2VSb3RhdGlvblF1YXRlcm5pb24iLCJyb3RhdGVJbWFnaW5hcnlRdWF0ZXJuaW9uIiwicm90YXRlVmVydGljZXMiLCJ2ZXJ0aWNlcyIsInJvdGF0aW9uUXVhdGVybmlvbiIsImludmVyc2VSb3RhdGlvblF1YXRlcm5pb24iLCJtYXAiLCJ2ZXJ0ZXgiLCJyb3RhdGVWZXJ0ZXgiLCJyb3RhdGVWZXJ0ZXhBYm91dFpBeGlzIiwicm90YXRpb25BYm91dFpBeGlzTWF0cml4IiwibWF0cml4Iiwicm90YXRlUG9zaXRpb25BYm91dFpBeGlzIiwicG9zaXRpb24iLCJjYWxjdWxhdGVSb3RhdGlvbkFib3V0WkF4aXNNYXRyaXgiLCJlZGdlSW5YWVBsYW5lIiwiZWRnZUluWFlQbGFuZUV4dGVudCIsImdldEV4dGVudCIsInVuaXRFZGdlSW5YWVBsYW5lRXh0ZW50IiwidW5pdEVkZ2VJblhZUGxhbmVFeHRlbnRDb21wb25lbnRzIiwiZmlyc3RVbml0RWRnZUluWFlQbGFuZUV4dGVudENvbXBvbmVudCIsInNlY29uZFVuaXRFZGdlSW5YWVBsYW5lRXh0ZW50Q29tcG9uZW50IiwiYW5nbGVPZlJvdGF0aW9uQ29zaW5lIiwiYW5nbGVPZlJvdGF0aW9uU2luZSIsImMiLCJzIiwiY2FsY3VsYXRlRm9yd2FyZHNSb3RhdGlvbkFib3V0WkF4aXNNYXRyaXgiLCJmb3J3YXJkc1JvdGF0aW9uQWJvdXRaQXhpc01hdHJpeCIsImNhbGN1bGF0ZUJhY2t3YXJkc1JvdGF0aW9uQWJvdXRaQXhpc01hdHJpeCIsInJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeENvbXBvbmVudHMiLCJmaXJzdFJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeENvbXBvbmVudCIsImZvdXJ0aFJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeENvbXBvbmVudCIsImJhY2t3YXJkc1JvdGF0aW9uQWJvdXRaQXhpc01hdHJpeCIsIm1vZHVsZSIsImV4cG9ydHMiLCJpbWFnaW5hcnlRdWF0ZXJuaW9uIiwicm90YXRlZEltYWdpbmFyeVF1YXRlcm5pb24iLCJzbGljZSJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7QUFFQSxJQUFNQSxjQUFjQyxRQUFRLGlCQUFSLENBQXBCO0FBQUEsSUFDTUMsaUJBQWlCRCxRQUFRLG9CQUFSLENBRHZCO0FBQUEsSUFFTUUsc0JBQXNCRixRQUFRLHlCQUFSLENBRjVCOztJQUlRRyxLLEdBQTBCRixjLENBQTFCRSxLO0lBQU9DLE0sR0FBbUJILGMsQ0FBbkJHLE07SUFBUUMsTSxHQUFXSixjLENBQVhJLE07SUFDZkMsVSxHQUEyQlAsVyxDQUEzQk8sVTtJQUFZQyxVLEdBQWVSLFcsQ0FBZlEsVTtJQUNaQyxrQyxHQUFrRU4sbUIsQ0FBbEVNLGtDO0lBQW9DQyx5QixHQUE4QlAsbUIsQ0FBOUJPLHlCOzs7QUFFNUMsU0FBU0MsY0FBVCxDQUF3QkMsUUFBeEIsRUFBa0NDLGtCQUFsQyxFQUFzRDtBQUNwRCxNQUFNQyw0QkFBNEJMLG1DQUFtQ0ksa0JBQW5DLENBQWxDOztBQUVBRCxhQUFXQSxTQUFTRyxHQUFULENBQWEsVUFBU0MsTUFBVCxFQUFpQjtBQUN2Q0EsYUFBU0MsYUFBYUQsTUFBYixFQUFxQkgsa0JBQXJCLEVBQXlDQyx5QkFBekMsQ0FBVDs7QUFFQSxXQUFPRSxNQUFQO0FBQ0QsR0FKVSxDQUFYOztBQU1BLFNBQU9KLFFBQVA7QUFDRDs7QUFFRCxTQUFTTSxzQkFBVCxDQUFnQ0YsTUFBaEMsRUFBd0NHLHdCQUF4QyxFQUFrRTtBQUNoRSxNQUFNQyxTQUFTRCx3QkFBZixDQURnRSxDQUN0Qjs7QUFFMUNILFdBQVNULFdBQVdTLE1BQVgsRUFBbUJJLE1BQW5CLENBQVQ7O0FBRUEsU0FBT0osTUFBUDtBQUNEOztBQUVELFNBQVNLLHdCQUFULENBQWtDQyxRQUFsQyxFQUE0Q0gsd0JBQTVDLEVBQXNFO0FBQ3BFLE1BQU1DLFNBQVNELHdCQUFmLENBRG9FLENBQzFCOztBQUUxQ0csYUFBV2YsV0FBV2UsUUFBWCxFQUFxQkYsTUFBckIsQ0FBWDs7QUFFQSxTQUFPRSxRQUFQO0FBQ0Q7O0FBRUQsU0FBU0MsaUNBQVQsQ0FBMkNDLGFBQTNDLEVBQTBEO0FBQ3hELE1BQU1DLHNCQUFzQkQsY0FBY0UsU0FBZCxFQUE1QjtBQUFBLE1BQ01DLDBCQUEwQm5CLFdBQVdpQixtQkFBWCxDQURoQztBQUFBLE1BRU1HLG9DQUFvQ0QsdUJBRjFDO0FBQUEsTUFFb0U7QUFDOURFLDBDQUF3Q3pCLE1BQU13QixpQ0FBTixDQUg5QztBQUFBLE1BSU1FLHlDQUF5Q3pCLE9BQU91QixpQ0FBUCxDQUovQztBQUFBLE1BS01HLHdCQUF3QixDQUFDRCxzQ0FML0I7QUFBQSxNQUt3RTtBQUNsRUUsd0JBQXNCLENBQUNILHFDQU43QjtBQUFBLE1BTW9FO0FBQzlESSxNQUFJRixxQkFQVjtBQUFBLE1BUU1HLElBQUlGLG1CQVJWO0FBQUEsTUFTTWIsMkJBQTJCLENBQUVjLENBQUYsRUFBSyxDQUFDQyxDQUFOLEVBQVMsQ0FBVCxFQUFZLENBQUNBLENBQWIsRUFBZ0JELENBQWhCLEVBQW1CLENBQW5CLEVBQXNCLENBQXRCLEVBQXlCLENBQXpCLEVBQTRCLENBQTVCLENBVGpDLENBRHdELENBVVc7O0FBRW5FLFNBQU9kLHdCQUFQO0FBQ0Q7O0FBRUQsU0FBU2dCLHlDQUFULENBQW1EaEIsd0JBQW5ELEVBQTZFO0FBQzNFLE1BQU1pQixtQ0FBbUNqQix3QkFBekMsQ0FEMkUsQ0FDUjs7QUFFbkUsU0FBT2lCLGdDQUFQO0FBQ0Q7O0FBRUQsU0FBU0MsMENBQVQsQ0FBb0RsQix3QkFBcEQsRUFBOEU7QUFDNUUsTUFBTW1CLHFDQUFxQ25CLHdCQUEzQztBQUFBLE1BQXFFO0FBQy9Eb0IsMkNBQXlDbkMsTUFBTWtDLGtDQUFOLENBRC9DO0FBQUEsTUFFTUUsMENBQTBDbEMsT0FBT2dDLGtDQUFQLENBRmhEO0FBQUEsTUFHTUwsSUFBSU0sc0NBSFY7QUFBQSxNQUdrRDtBQUM1Q0wsTUFBSU0sdUNBSlY7QUFBQSxNQUlvRDtBQUM5Q0Msc0NBQW9DLENBQUVSLENBQUYsRUFBSyxDQUFDQyxDQUFOLEVBQVMsQ0FBVCxFQUFZLENBQUNBLENBQWIsRUFBZ0JELENBQWhCLEVBQW1CLENBQW5CLEVBQXNCLENBQXRCLEVBQXlCLENBQXpCLEVBQTRCLENBQTVCLENBTDFDOztBQU9BLFNBQU9RLGlDQUFQO0FBQ0Q7O0FBRURDLE9BQU9DLE9BQVAsR0FBaUI7QUFDZmhDLGtCQUFnQkEsY0FERDtBQUVmTywwQkFBd0JBLHNCQUZUO0FBR2ZHLDRCQUEwQkEsd0JBSFg7QUFJZkUscUNBQW1DQSxpQ0FKcEI7QUFLZlksNkNBQTJDQSx5Q0FMNUI7QUFNZkUsOENBQTRDQTtBQU43QixDQUFqQjs7QUFTQSxTQUFTcEIsWUFBVCxDQUFzQkQsTUFBdEIsRUFBOEJILGtCQUE5QixFQUFrREMseUJBQWxELEVBQTZFO0FBQzNFLE1BQU04Qix1QkFBdUIsQ0FBdkIsNEJBQTZCNUIsTUFBN0IsRUFBTjtBQUFBLE1BQTRDO0FBQ3RDNkIsK0JBQTZCbkMsMEJBQTBCa0MsbUJBQTFCLEVBQStDL0Isa0JBQS9DLEVBQW1FQyx5QkFBbkUsQ0FEbkM7O0FBR0FFLFdBQVM2QiwyQkFBMkJDLEtBQTNCLENBQWlDLENBQWpDLENBQVQsQ0FKMkUsQ0FJN0I7O0FBRTlDLFNBQU85QixNQUFQO0FBQ0QiLCJmaWxlIjoicm90YXRpb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IHZlY3Rvck1hdGhzID0gcmVxdWlyZSgnLi4vbWF0aHMvdmVjdG9yJyksXG4gICAgICBhcnJheVV0aWxpdGllcyA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9hcnJheScpLFxuICAgICAgcXVhdGVybmlvblV0aWxpdGllcyA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9xdWF0ZXJuaW9uJyk7XG5cbmNvbnN0IHsgZmlyc3QsIHNlY29uZCwgZm91cnRoIH0gPSBhcnJheVV0aWxpdGllcyxcbiAgICAgIHsgdHJhbnNmb3JtMywgbm9ybWFsaXNlMyB9ID0gdmVjdG9yTWF0aHMsXG4gICAgICB7IGNhbGN1bGF0ZUludmVyc2VSb3RhdGlvblF1YXRlcm5pb24sIHJvdGF0ZUltYWdpbmFyeVF1YXRlcm5pb24gfSA9IHF1YXRlcm5pb25VdGlsaXRpZXM7XG5cbmZ1bmN0aW9uIHJvdGF0ZVZlcnRpY2VzKHZlcnRpY2VzLCByb3RhdGlvblF1YXRlcm5pb24pIHtcbiAgY29uc3QgaW52ZXJzZVJvdGF0aW9uUXVhdGVybmlvbiA9IGNhbGN1bGF0ZUludmVyc2VSb3RhdGlvblF1YXRlcm5pb24ocm90YXRpb25RdWF0ZXJuaW9uKTtcblxuICB2ZXJ0aWNlcyA9IHZlcnRpY2VzLm1hcChmdW5jdGlvbih2ZXJ0ZXgpIHtcbiAgICB2ZXJ0ZXggPSByb3RhdGVWZXJ0ZXgodmVydGV4LCByb3RhdGlvblF1YXRlcm5pb24sIGludmVyc2VSb3RhdGlvblF1YXRlcm5pb24pO1xuXG4gICAgcmV0dXJuIHZlcnRleDtcbiAgfSk7XG5cbiAgcmV0dXJuIHZlcnRpY2VzO1xufVxuXG5mdW5jdGlvbiByb3RhdGVWZXJ0ZXhBYm91dFpBeGlzKHZlcnRleCwgcm90YXRpb25BYm91dFpBeGlzTWF0cml4KSB7XG4gIGNvbnN0IG1hdHJpeCA9IHJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeDsgIC8vL1xuXG4gIHZlcnRleCA9IHRyYW5zZm9ybTModmVydGV4LCBtYXRyaXgpO1xuXG4gIHJldHVybiB2ZXJ0ZXg7XG59XG5cbmZ1bmN0aW9uIHJvdGF0ZVBvc2l0aW9uQWJvdXRaQXhpcyhwb3NpdGlvbiwgcm90YXRpb25BYm91dFpBeGlzTWF0cml4KSB7XG4gIGNvbnN0IG1hdHJpeCA9IHJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeDsgIC8vL1xuXG4gIHBvc2l0aW9uID0gdHJhbnNmb3JtMyhwb3NpdGlvbiwgbWF0cml4KTtcblxuICByZXR1cm4gcG9zaXRpb247XG59XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZVJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeChlZGdlSW5YWVBsYW5lKSB7XG4gIGNvbnN0IGVkZ2VJblhZUGxhbmVFeHRlbnQgPSBlZGdlSW5YWVBsYW5lLmdldEV4dGVudCgpLFxuICAgICAgICB1bml0RWRnZUluWFlQbGFuZUV4dGVudCA9IG5vcm1hbGlzZTMoZWRnZUluWFlQbGFuZUV4dGVudCksXG4gICAgICAgIHVuaXRFZGdlSW5YWVBsYW5lRXh0ZW50Q29tcG9uZW50cyA9IHVuaXRFZGdlSW5YWVBsYW5lRXh0ZW50LCAgLy8vXG4gICAgICAgIGZpcnN0VW5pdEVkZ2VJblhZUGxhbmVFeHRlbnRDb21wb25lbnQgPSBmaXJzdCh1bml0RWRnZUluWFlQbGFuZUV4dGVudENvbXBvbmVudHMpLFxuICAgICAgICBzZWNvbmRVbml0RWRnZUluWFlQbGFuZUV4dGVudENvbXBvbmVudCA9IHNlY29uZCh1bml0RWRnZUluWFlQbGFuZUV4dGVudENvbXBvbmVudHMpLFxuICAgICAgICBhbmdsZU9mUm90YXRpb25Db3NpbmUgPSArc2Vjb25kVW5pdEVkZ2VJblhZUGxhbmVFeHRlbnRDb21wb25lbnQsICAvLy9cbiAgICAgICAgYW5nbGVPZlJvdGF0aW9uU2luZSA9IC1maXJzdFVuaXRFZGdlSW5YWVBsYW5lRXh0ZW50Q29tcG9uZW50LCAvLy9cbiAgICAgICAgYyA9IGFuZ2xlT2ZSb3RhdGlvbkNvc2luZSxcbiAgICAgICAgcyA9IGFuZ2xlT2ZSb3RhdGlvblNpbmUsXG4gICAgICAgIHJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeCA9IFsgYywgLXMsIDAsICtzLCBjLCAwLCAwLCAwLCAxIF07ICAvLy9cblxuICByZXR1cm4gcm90YXRpb25BYm91dFpBeGlzTWF0cml4O1xufVxuXG5mdW5jdGlvbiBjYWxjdWxhdGVGb3J3YXJkc1JvdGF0aW9uQWJvdXRaQXhpc01hdHJpeChyb3RhdGlvbkFib3V0WkF4aXNNYXRyaXgpIHtcbiAgY29uc3QgZm9yd2FyZHNSb3RhdGlvbkFib3V0WkF4aXNNYXRyaXggPSByb3RhdGlvbkFib3V0WkF4aXNNYXRyaXg7IC8vL1xuXG4gIHJldHVybiBmb3J3YXJkc1JvdGF0aW9uQWJvdXRaQXhpc01hdHJpeDtcbn1cblxuZnVuY3Rpb24gY2FsY3VsYXRlQmFja3dhcmRzUm90YXRpb25BYm91dFpBeGlzTWF0cml4KHJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeCkge1xuICBjb25zdCByb3RhdGlvbkFib3V0WkF4aXNNYXRyaXhDb21wb25lbnRzID0gcm90YXRpb25BYm91dFpBeGlzTWF0cml4LCAvLy9cbiAgICAgICAgZmlyc3RSb3RhdGlvbkFib3V0WkF4aXNNYXRyaXhDb21wb25lbnQgPSBmaXJzdChyb3RhdGlvbkFib3V0WkF4aXNNYXRyaXhDb21wb25lbnRzKSxcbiAgICAgICAgZm91cnRoUm90YXRpb25BYm91dFpBeGlzTWF0cml4Q29tcG9uZW50ID0gZm91cnRoKHJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeENvbXBvbmVudHMpLFxuICAgICAgICBjID0gZmlyc3RSb3RhdGlvbkFib3V0WkF4aXNNYXRyaXhDb21wb25lbnQsIC8vL1xuICAgICAgICBzID0gZm91cnRoUm90YXRpb25BYm91dFpBeGlzTWF0cml4Q29tcG9uZW50LCAgLy8vXG4gICAgICAgIGJhY2t3YXJkc1JvdGF0aW9uQWJvdXRaQXhpc01hdHJpeCA9IFsgYywgK3MsIDAsIC1zLCBjLCAwLCAwLCAwLCAxIF07XG5cbiAgcmV0dXJuIGJhY2t3YXJkc1JvdGF0aW9uQWJvdXRaQXhpc01hdHJpeDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHJvdGF0ZVZlcnRpY2VzOiByb3RhdGVWZXJ0aWNlcyxcbiAgcm90YXRlVmVydGV4QWJvdXRaQXhpczogcm90YXRlVmVydGV4QWJvdXRaQXhpcyxcbiAgcm90YXRlUG9zaXRpb25BYm91dFpBeGlzOiByb3RhdGVQb3NpdGlvbkFib3V0WkF4aXMsXG4gIGNhbGN1bGF0ZVJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeDogY2FsY3VsYXRlUm90YXRpb25BYm91dFpBeGlzTWF0cml4LFxuICBjYWxjdWxhdGVGb3J3YXJkc1JvdGF0aW9uQWJvdXRaQXhpc01hdHJpeDogY2FsY3VsYXRlRm9yd2FyZHNSb3RhdGlvbkFib3V0WkF4aXNNYXRyaXgsXG4gIGNhbGN1bGF0ZUJhY2t3YXJkc1JvdGF0aW9uQWJvdXRaQXhpc01hdHJpeDogY2FsY3VsYXRlQmFja3dhcmRzUm90YXRpb25BYm91dFpBeGlzTWF0cml4XG59O1xuXG5mdW5jdGlvbiByb3RhdGVWZXJ0ZXgodmVydGV4LCByb3RhdGlvblF1YXRlcm5pb24sIGludmVyc2VSb3RhdGlvblF1YXRlcm5pb24pIHtcbiAgY29uc3QgaW1hZ2luYXJ5UXVhdGVybmlvbiA9IFswLCAuLi52ZXJ0ZXhdLCAvLy9cbiAgICAgICAgcm90YXRlZEltYWdpbmFyeVF1YXRlcm5pb24gPSByb3RhdGVJbWFnaW5hcnlRdWF0ZXJuaW9uKGltYWdpbmFyeVF1YXRlcm5pb24sIHJvdGF0aW9uUXVhdGVybmlvbiwgaW52ZXJzZVJvdGF0aW9uUXVhdGVybmlvbik7XG5cbiAgdmVydGV4ID0gcm90YXRlZEltYWdpbmFyeVF1YXRlcm5pb24uc2xpY2UoMSk7IC8vL1xuXG4gIHJldHVybiB2ZXJ0ZXg7XG59XG4iXX0=
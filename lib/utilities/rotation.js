'use strict';

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

var arrayUtilities = require('../utilities/array'),
    vectorUtilities = require('../utilities/vector'),
    quaternionUtilities = require('../utilities/quaternion');

var first = arrayUtilities.first,
    second = arrayUtilities.second,
    fourth = arrayUtilities.fourth,
    transform3 = vectorUtilities.transform3,
    normalise3 = vectorUtilities.normalise3,
    calculateInverseRotationQuaternion = quaternionUtilities.calculateInverseRotationQuaternion,
    rotateImaginaryQuaternion = quaternionUtilities.rotateImaginaryQuaternion;


function rotateVertices(vertices, rotationQuaternion) {
  var inverseRotationQuaternion = calculateInverseRotationQuaternion(rotationQuaternion);

  vertices = vertices.map(function (vertex) {
    vertex = rotateVertex(vertex, rotationQuaternion, inverseRotationQuaternion);

    return vertex;
  });

  return vertices;
}

function rotateVertexAboutZAxis(vertex, rotationAboutZAxisMatrix) {
  var matrix = rotationAboutZAxisMatrix; ///

  vertex = transform3(vertex, matrix);

  return vertex;
}

function rotatePositionAboutZAxis(position, rotationAboutZAxisMatrix) {
  var matrix = rotationAboutZAxisMatrix; ///

  position = transform3(position, matrix);

  return position;
}

function calculateRotationAboutZAxisMatrix(edgeInXYPlane) {
  var edgeInXYPlaneExtent = edgeInXYPlane.getExtent(),
      unitEdgeInXYPlaneExtent = normalise3(edgeInXYPlaneExtent),
      unitEdgeInXYPlaneExtentComponents = unitEdgeInXYPlaneExtent,
      ///
  firstUnitEdgeInXYPlaneExtentComponent = first(unitEdgeInXYPlaneExtentComponents),
      secondUnitEdgeInXYPlaneExtentComponent = second(unitEdgeInXYPlaneExtentComponents),
      angleOfRotationCosine = +secondUnitEdgeInXYPlaneExtentComponent,
      ///
  angleOfRotationSine = -firstUnitEdgeInXYPlaneExtentComponent,
      ///
  c = angleOfRotationCosine,
      s = angleOfRotationSine,
      rotationAboutZAxisMatrix = [c, -s, 0, +s, c, 0, 0, 0, 1]; ///

  return rotationAboutZAxisMatrix;
}

function calculateForwardsRotationAboutZAxisMatrix(rotationAboutZAxisMatrix) {
  var forwardsRotationAboutZAxisMatrix = rotationAboutZAxisMatrix; ///

  return forwardsRotationAboutZAxisMatrix;
}

function calculateBackwardsRotationAboutZAxisMatrix(rotationAboutZAxisMatrix) {
  var rotationAboutZAxisMatrixComponents = rotationAboutZAxisMatrix,
      ///
  firstRotationAboutZAxisMatrixComponent = first(rotationAboutZAxisMatrixComponents),
      fourthRotationAboutZAxisMatrixComponent = fourth(rotationAboutZAxisMatrixComponents),
      c = firstRotationAboutZAxisMatrixComponent,
      ///
  s = fourthRotationAboutZAxisMatrixComponent,
      ///
  backwardsRotationAboutZAxisMatrix = [c, +s, 0, -s, c, 0, 0, 0, 1];

  return backwardsRotationAboutZAxisMatrix;
}

module.exports = {
  rotateVertices: rotateVertices,
  rotateVertexAboutZAxis: rotateVertexAboutZAxis,
  rotatePositionAboutZAxis: rotatePositionAboutZAxis,
  calculateRotationAboutZAxisMatrix: calculateRotationAboutZAxisMatrix,
  calculateForwardsRotationAboutZAxisMatrix: calculateForwardsRotationAboutZAxisMatrix,
  calculateBackwardsRotationAboutZAxisMatrix: calculateBackwardsRotationAboutZAxisMatrix
};

function rotateVertex(vertex, rotationQuaternion, inverseRotationQuaternion) {
  var imaginaryQuaternion = [0].concat(_toConsumableArray(vertex)),
      ///
  rotatedImaginaryQuaternion = rotateImaginaryQuaternion(imaginaryQuaternion, rotationQuaternion, inverseRotationQuaternion);

  vertex = rotatedImaginaryQuaternion.slice(1); ///

  return vertex;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi91dGlsaXRpZXMvcm90YXRpb24uanMiXSwibmFtZXMiOlsiYXJyYXlVdGlsaXRpZXMiLCJyZXF1aXJlIiwidmVjdG9yVXRpbGl0aWVzIiwicXVhdGVybmlvblV0aWxpdGllcyIsImZpcnN0Iiwic2Vjb25kIiwiZm91cnRoIiwidHJhbnNmb3JtMyIsIm5vcm1hbGlzZTMiLCJjYWxjdWxhdGVJbnZlcnNlUm90YXRpb25RdWF0ZXJuaW9uIiwicm90YXRlSW1hZ2luYXJ5UXVhdGVybmlvbiIsInJvdGF0ZVZlcnRpY2VzIiwidmVydGljZXMiLCJyb3RhdGlvblF1YXRlcm5pb24iLCJpbnZlcnNlUm90YXRpb25RdWF0ZXJuaW9uIiwibWFwIiwidmVydGV4Iiwicm90YXRlVmVydGV4Iiwicm90YXRlVmVydGV4QWJvdXRaQXhpcyIsInJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeCIsIm1hdHJpeCIsInJvdGF0ZVBvc2l0aW9uQWJvdXRaQXhpcyIsInBvc2l0aW9uIiwiY2FsY3VsYXRlUm90YXRpb25BYm91dFpBeGlzTWF0cml4IiwiZWRnZUluWFlQbGFuZSIsImVkZ2VJblhZUGxhbmVFeHRlbnQiLCJnZXRFeHRlbnQiLCJ1bml0RWRnZUluWFlQbGFuZUV4dGVudCIsInVuaXRFZGdlSW5YWVBsYW5lRXh0ZW50Q29tcG9uZW50cyIsImZpcnN0VW5pdEVkZ2VJblhZUGxhbmVFeHRlbnRDb21wb25lbnQiLCJzZWNvbmRVbml0RWRnZUluWFlQbGFuZUV4dGVudENvbXBvbmVudCIsImFuZ2xlT2ZSb3RhdGlvbkNvc2luZSIsImFuZ2xlT2ZSb3RhdGlvblNpbmUiLCJjIiwicyIsImNhbGN1bGF0ZUZvcndhcmRzUm90YXRpb25BYm91dFpBeGlzTWF0cml4IiwiZm9yd2FyZHNSb3RhdGlvbkFib3V0WkF4aXNNYXRyaXgiLCJjYWxjdWxhdGVCYWNrd2FyZHNSb3RhdGlvbkFib3V0WkF4aXNNYXRyaXgiLCJyb3RhdGlvbkFib3V0WkF4aXNNYXRyaXhDb21wb25lbnRzIiwiZmlyc3RSb3RhdGlvbkFib3V0WkF4aXNNYXRyaXhDb21wb25lbnQiLCJmb3VydGhSb3RhdGlvbkFib3V0WkF4aXNNYXRyaXhDb21wb25lbnQiLCJiYWNrd2FyZHNSb3RhdGlvbkFib3V0WkF4aXNNYXRyaXgiLCJtb2R1bGUiLCJleHBvcnRzIiwiaW1hZ2luYXJ5UXVhdGVybmlvbiIsInJvdGF0ZWRJbWFnaW5hcnlRdWF0ZXJuaW9uIiwic2xpY2UiXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FBRUEsSUFBTUEsaUJBQWlCQyxRQUFRLG9CQUFSLENBQXZCO0FBQUEsSUFDTUMsa0JBQWtCRCxRQUFRLHFCQUFSLENBRHhCO0FBQUEsSUFFTUUsc0JBQXNCRixRQUFRLHlCQUFSLENBRjVCOztJQUlRRyxLLEdBQTBCSixjLENBQTFCSSxLO0lBQU9DLE0sR0FBbUJMLGMsQ0FBbkJLLE07SUFBUUMsTSxHQUFXTixjLENBQVhNLE07SUFDZkMsVSxHQUEyQkwsZSxDQUEzQkssVTtJQUFZQyxVLEdBQWVOLGUsQ0FBZk0sVTtJQUNaQyxrQyxHQUFrRU4sbUIsQ0FBbEVNLGtDO0lBQW9DQyx5QixHQUE4QlAsbUIsQ0FBOUJPLHlCOzs7QUFFNUMsU0FBU0MsY0FBVCxDQUF3QkMsUUFBeEIsRUFBa0NDLGtCQUFsQyxFQUFzRDtBQUNwRCxNQUFNQyw0QkFBNEJMLG1DQUFtQ0ksa0JBQW5DLENBQWxDOztBQUVBRCxhQUFXQSxTQUFTRyxHQUFULENBQWEsVUFBU0MsTUFBVCxFQUFpQjtBQUN2Q0EsYUFBU0MsYUFBYUQsTUFBYixFQUFxQkgsa0JBQXJCLEVBQXlDQyx5QkFBekMsQ0FBVDs7QUFFQSxXQUFPRSxNQUFQO0FBQ0QsR0FKVSxDQUFYOztBQU1BLFNBQU9KLFFBQVA7QUFDRDs7QUFFRCxTQUFTTSxzQkFBVCxDQUFnQ0YsTUFBaEMsRUFBd0NHLHdCQUF4QyxFQUFrRTtBQUNoRSxNQUFNQyxTQUFTRCx3QkFBZixDQURnRSxDQUN0Qjs7QUFFMUNILFdBQVNULFdBQVdTLE1BQVgsRUFBbUJJLE1BQW5CLENBQVQ7O0FBRUEsU0FBT0osTUFBUDtBQUNEOztBQUVELFNBQVNLLHdCQUFULENBQWtDQyxRQUFsQyxFQUE0Q0gsd0JBQTVDLEVBQXNFO0FBQ3BFLE1BQU1DLFNBQVNELHdCQUFmLENBRG9FLENBQzFCOztBQUUxQ0csYUFBV2YsV0FBV2UsUUFBWCxFQUFxQkYsTUFBckIsQ0FBWDs7QUFFQSxTQUFPRSxRQUFQO0FBQ0Q7O0FBRUQsU0FBU0MsaUNBQVQsQ0FBMkNDLGFBQTNDLEVBQTBEO0FBQ3hELE1BQU1DLHNCQUFzQkQsY0FBY0UsU0FBZCxFQUE1QjtBQUFBLE1BQ01DLDBCQUEwQm5CLFdBQVdpQixtQkFBWCxDQURoQztBQUFBLE1BRU1HLG9DQUFvQ0QsdUJBRjFDO0FBQUEsTUFFb0U7QUFDOURFLDBDQUF3Q3pCLE1BQU13QixpQ0FBTixDQUg5QztBQUFBLE1BSU1FLHlDQUF5Q3pCLE9BQU91QixpQ0FBUCxDQUovQztBQUFBLE1BS01HLHdCQUF3QixDQUFDRCxzQ0FML0I7QUFBQSxNQUt3RTtBQUNsRUUsd0JBQXNCLENBQUNILHFDQU43QjtBQUFBLE1BTW9FO0FBQzlESSxNQUFJRixxQkFQVjtBQUFBLE1BUU1HLElBQUlGLG1CQVJWO0FBQUEsTUFTTWIsMkJBQTJCLENBQUVjLENBQUYsRUFBSyxDQUFDQyxDQUFOLEVBQVMsQ0FBVCxFQUFZLENBQUNBLENBQWIsRUFBZ0JELENBQWhCLEVBQW1CLENBQW5CLEVBQXNCLENBQXRCLEVBQXlCLENBQXpCLEVBQTRCLENBQTVCLENBVGpDLENBRHdELENBVVc7O0FBRW5FLFNBQU9kLHdCQUFQO0FBQ0Q7O0FBRUQsU0FBU2dCLHlDQUFULENBQW1EaEIsd0JBQW5ELEVBQTZFO0FBQzNFLE1BQU1pQixtQ0FBbUNqQix3QkFBekMsQ0FEMkUsQ0FDUjs7QUFFbkUsU0FBT2lCLGdDQUFQO0FBQ0Q7O0FBRUQsU0FBU0MsMENBQVQsQ0FBb0RsQix3QkFBcEQsRUFBOEU7QUFDNUUsTUFBTW1CLHFDQUFxQ25CLHdCQUEzQztBQUFBLE1BQXFFO0FBQy9Eb0IsMkNBQXlDbkMsTUFBTWtDLGtDQUFOLENBRC9DO0FBQUEsTUFFTUUsMENBQTBDbEMsT0FBT2dDLGtDQUFQLENBRmhEO0FBQUEsTUFHTUwsSUFBSU0sc0NBSFY7QUFBQSxNQUdrRDtBQUM1Q0wsTUFBSU0sdUNBSlY7QUFBQSxNQUlvRDtBQUM5Q0Msc0NBQW9DLENBQUVSLENBQUYsRUFBSyxDQUFDQyxDQUFOLEVBQVMsQ0FBVCxFQUFZLENBQUNBLENBQWIsRUFBZ0JELENBQWhCLEVBQW1CLENBQW5CLEVBQXNCLENBQXRCLEVBQXlCLENBQXpCLEVBQTRCLENBQTVCLENBTDFDOztBQU9BLFNBQU9RLGlDQUFQO0FBQ0Q7O0FBRURDLE9BQU9DLE9BQVAsR0FBaUI7QUFDZmhDLGtCQUFnQkEsY0FERDtBQUVmTywwQkFBd0JBLHNCQUZUO0FBR2ZHLDRCQUEwQkEsd0JBSFg7QUFJZkUscUNBQW1DQSxpQ0FKcEI7QUFLZlksNkNBQTJDQSx5Q0FMNUI7QUFNZkUsOENBQTRDQTtBQU43QixDQUFqQjs7QUFTQSxTQUFTcEIsWUFBVCxDQUFzQkQsTUFBdEIsRUFBOEJILGtCQUE5QixFQUFrREMseUJBQWxELEVBQTZFO0FBQzNFLE1BQU04Qix1QkFBdUIsQ0FBdkIsNEJBQTZCNUIsTUFBN0IsRUFBTjtBQUFBLE1BQTRDO0FBQ3RDNkIsK0JBQTZCbkMsMEJBQTBCa0MsbUJBQTFCLEVBQStDL0Isa0JBQS9DLEVBQW1FQyx5QkFBbkUsQ0FEbkM7O0FBR0FFLFdBQVM2QiwyQkFBMkJDLEtBQTNCLENBQWlDLENBQWpDLENBQVQsQ0FKMkUsQ0FJN0I7O0FBRTlDLFNBQU85QixNQUFQO0FBQ0QiLCJmaWxlIjoicm90YXRpb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IGFycmF5VXRpbGl0aWVzID0gcmVxdWlyZSgnLi4vdXRpbGl0aWVzL2FycmF5JyksXG4gICAgICB2ZWN0b3JVdGlsaXRpZXMgPSByZXF1aXJlKCcuLi91dGlsaXRpZXMvdmVjdG9yJyksXG4gICAgICBxdWF0ZXJuaW9uVXRpbGl0aWVzID0gcmVxdWlyZSgnLi4vdXRpbGl0aWVzL3F1YXRlcm5pb24nKTtcblxuY29uc3QgeyBmaXJzdCwgc2Vjb25kLCBmb3VydGggfSA9IGFycmF5VXRpbGl0aWVzLFxuICAgICAgeyB0cmFuc2Zvcm0zLCBub3JtYWxpc2UzIH0gPSB2ZWN0b3JVdGlsaXRpZXMsXG4gICAgICB7IGNhbGN1bGF0ZUludmVyc2VSb3RhdGlvblF1YXRlcm5pb24sIHJvdGF0ZUltYWdpbmFyeVF1YXRlcm5pb24gfSA9IHF1YXRlcm5pb25VdGlsaXRpZXM7XG5cbmZ1bmN0aW9uIHJvdGF0ZVZlcnRpY2VzKHZlcnRpY2VzLCByb3RhdGlvblF1YXRlcm5pb24pIHtcbiAgY29uc3QgaW52ZXJzZVJvdGF0aW9uUXVhdGVybmlvbiA9IGNhbGN1bGF0ZUludmVyc2VSb3RhdGlvblF1YXRlcm5pb24ocm90YXRpb25RdWF0ZXJuaW9uKTtcblxuICB2ZXJ0aWNlcyA9IHZlcnRpY2VzLm1hcChmdW5jdGlvbih2ZXJ0ZXgpIHtcbiAgICB2ZXJ0ZXggPSByb3RhdGVWZXJ0ZXgodmVydGV4LCByb3RhdGlvblF1YXRlcm5pb24sIGludmVyc2VSb3RhdGlvblF1YXRlcm5pb24pO1xuXG4gICAgcmV0dXJuIHZlcnRleDtcbiAgfSk7XG5cbiAgcmV0dXJuIHZlcnRpY2VzO1xufVxuXG5mdW5jdGlvbiByb3RhdGVWZXJ0ZXhBYm91dFpBeGlzKHZlcnRleCwgcm90YXRpb25BYm91dFpBeGlzTWF0cml4KSB7XG4gIGNvbnN0IG1hdHJpeCA9IHJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeDsgIC8vL1xuXG4gIHZlcnRleCA9IHRyYW5zZm9ybTModmVydGV4LCBtYXRyaXgpO1xuXG4gIHJldHVybiB2ZXJ0ZXg7XG59XG5cbmZ1bmN0aW9uIHJvdGF0ZVBvc2l0aW9uQWJvdXRaQXhpcyhwb3NpdGlvbiwgcm90YXRpb25BYm91dFpBeGlzTWF0cml4KSB7XG4gIGNvbnN0IG1hdHJpeCA9IHJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeDsgIC8vL1xuXG4gIHBvc2l0aW9uID0gdHJhbnNmb3JtMyhwb3NpdGlvbiwgbWF0cml4KTtcblxuICByZXR1cm4gcG9zaXRpb247XG59XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZVJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeChlZGdlSW5YWVBsYW5lKSB7XG4gIGNvbnN0IGVkZ2VJblhZUGxhbmVFeHRlbnQgPSBlZGdlSW5YWVBsYW5lLmdldEV4dGVudCgpLFxuICAgICAgICB1bml0RWRnZUluWFlQbGFuZUV4dGVudCA9IG5vcm1hbGlzZTMoZWRnZUluWFlQbGFuZUV4dGVudCksXG4gICAgICAgIHVuaXRFZGdlSW5YWVBsYW5lRXh0ZW50Q29tcG9uZW50cyA9IHVuaXRFZGdlSW5YWVBsYW5lRXh0ZW50LCAgLy8vXG4gICAgICAgIGZpcnN0VW5pdEVkZ2VJblhZUGxhbmVFeHRlbnRDb21wb25lbnQgPSBmaXJzdCh1bml0RWRnZUluWFlQbGFuZUV4dGVudENvbXBvbmVudHMpLFxuICAgICAgICBzZWNvbmRVbml0RWRnZUluWFlQbGFuZUV4dGVudENvbXBvbmVudCA9IHNlY29uZCh1bml0RWRnZUluWFlQbGFuZUV4dGVudENvbXBvbmVudHMpLFxuICAgICAgICBhbmdsZU9mUm90YXRpb25Db3NpbmUgPSArc2Vjb25kVW5pdEVkZ2VJblhZUGxhbmVFeHRlbnRDb21wb25lbnQsICAvLy9cbiAgICAgICAgYW5nbGVPZlJvdGF0aW9uU2luZSA9IC1maXJzdFVuaXRFZGdlSW5YWVBsYW5lRXh0ZW50Q29tcG9uZW50LCAvLy9cbiAgICAgICAgYyA9IGFuZ2xlT2ZSb3RhdGlvbkNvc2luZSxcbiAgICAgICAgcyA9IGFuZ2xlT2ZSb3RhdGlvblNpbmUsXG4gICAgICAgIHJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeCA9IFsgYywgLXMsIDAsICtzLCBjLCAwLCAwLCAwLCAxIF07ICAvLy9cblxuICByZXR1cm4gcm90YXRpb25BYm91dFpBeGlzTWF0cml4O1xufVxuXG5mdW5jdGlvbiBjYWxjdWxhdGVGb3J3YXJkc1JvdGF0aW9uQWJvdXRaQXhpc01hdHJpeChyb3RhdGlvbkFib3V0WkF4aXNNYXRyaXgpIHtcbiAgY29uc3QgZm9yd2FyZHNSb3RhdGlvbkFib3V0WkF4aXNNYXRyaXggPSByb3RhdGlvbkFib3V0WkF4aXNNYXRyaXg7IC8vL1xuXG4gIHJldHVybiBmb3J3YXJkc1JvdGF0aW9uQWJvdXRaQXhpc01hdHJpeDtcbn1cblxuZnVuY3Rpb24gY2FsY3VsYXRlQmFja3dhcmRzUm90YXRpb25BYm91dFpBeGlzTWF0cml4KHJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeCkge1xuICBjb25zdCByb3RhdGlvbkFib3V0WkF4aXNNYXRyaXhDb21wb25lbnRzID0gcm90YXRpb25BYm91dFpBeGlzTWF0cml4LCAvLy9cbiAgICAgICAgZmlyc3RSb3RhdGlvbkFib3V0WkF4aXNNYXRyaXhDb21wb25lbnQgPSBmaXJzdChyb3RhdGlvbkFib3V0WkF4aXNNYXRyaXhDb21wb25lbnRzKSxcbiAgICAgICAgZm91cnRoUm90YXRpb25BYm91dFpBeGlzTWF0cml4Q29tcG9uZW50ID0gZm91cnRoKHJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeENvbXBvbmVudHMpLFxuICAgICAgICBjID0gZmlyc3RSb3RhdGlvbkFib3V0WkF4aXNNYXRyaXhDb21wb25lbnQsIC8vL1xuICAgICAgICBzID0gZm91cnRoUm90YXRpb25BYm91dFpBeGlzTWF0cml4Q29tcG9uZW50LCAgLy8vXG4gICAgICAgIGJhY2t3YXJkc1JvdGF0aW9uQWJvdXRaQXhpc01hdHJpeCA9IFsgYywgK3MsIDAsIC1zLCBjLCAwLCAwLCAwLCAxIF07XG5cbiAgcmV0dXJuIGJhY2t3YXJkc1JvdGF0aW9uQWJvdXRaQXhpc01hdHJpeDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHJvdGF0ZVZlcnRpY2VzOiByb3RhdGVWZXJ0aWNlcyxcbiAgcm90YXRlVmVydGV4QWJvdXRaQXhpczogcm90YXRlVmVydGV4QWJvdXRaQXhpcyxcbiAgcm90YXRlUG9zaXRpb25BYm91dFpBeGlzOiByb3RhdGVQb3NpdGlvbkFib3V0WkF4aXMsXG4gIGNhbGN1bGF0ZVJvdGF0aW9uQWJvdXRaQXhpc01hdHJpeDogY2FsY3VsYXRlUm90YXRpb25BYm91dFpBeGlzTWF0cml4LFxuICBjYWxjdWxhdGVGb3J3YXJkc1JvdGF0aW9uQWJvdXRaQXhpc01hdHJpeDogY2FsY3VsYXRlRm9yd2FyZHNSb3RhdGlvbkFib3V0WkF4aXNNYXRyaXgsXG4gIGNhbGN1bGF0ZUJhY2t3YXJkc1JvdGF0aW9uQWJvdXRaQXhpc01hdHJpeDogY2FsY3VsYXRlQmFja3dhcmRzUm90YXRpb25BYm91dFpBeGlzTWF0cml4XG59O1xuXG5mdW5jdGlvbiByb3RhdGVWZXJ0ZXgodmVydGV4LCByb3RhdGlvblF1YXRlcm5pb24sIGludmVyc2VSb3RhdGlvblF1YXRlcm5pb24pIHtcbiAgY29uc3QgaW1hZ2luYXJ5UXVhdGVybmlvbiA9IFswLCAuLi52ZXJ0ZXhdLCAvLy9cbiAgICAgICAgcm90YXRlZEltYWdpbmFyeVF1YXRlcm5pb24gPSByb3RhdGVJbWFnaW5hcnlRdWF0ZXJuaW9uKGltYWdpbmFyeVF1YXRlcm5pb24sIHJvdGF0aW9uUXVhdGVybmlvbiwgaW52ZXJzZVJvdGF0aW9uUXVhdGVybmlvbik7XG5cbiAgdmVydGV4ID0gcm90YXRlZEltYWdpbmFyeVF1YXRlcm5pb24uc2xpY2UoMSk7IC8vL1xuXG4gIHJldHVybiB2ZXJ0ZXg7XG59XG4iXX0=
'use strict';

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

var mat4 = require('../maths/mat4'),
    vec4 = require('../maths/vec4'),
    constants = require('../constants'),
    arrayUtilities = require('../utilities/array');

var DEGREES_TO_RADIANS = constants.DEGREES_TO_RADIANS,
    create = mat4.create,
    translate = mat4.translate,
    scale = mat4.scale,
    rotate = mat4.rotate,
    first = arrayUtilities.first,
    second = arrayUtilities.second,
    third = arrayUtilities.third,
    transform = vec4.transform,
    xAxis = [1, 0, 0],
    yAxis = [0, 1, 0],
    zAxis = [0, 0, 1],
    defaultWidth = 1,
    defaultDepth = 1,
    defaultHeight = 1,
    defaultPosition = [0, 0, 0],
    defaultRotations = [0, 0, 0];


function composeScale() {
  var width = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultWidth;
  var height = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultHeight;
  var depth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : defaultDepth;

  var mat4 = create();

  scale(mat4, mat4, [width, height, depth]);

  return compose(mat4);
}

function composeRotate() {
  var rotations = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultRotations;

  var mat4 = create(),
      firstRotation = first(rotations),
      secondRotation = second(rotations),
      thirdRotation = third(rotations),
      xAngle = firstRotation * DEGREES_TO_RADIANS,
      ///
  yAngle = secondRotation * DEGREES_TO_RADIANS,
      ///
  zAngle = thirdRotation * DEGREES_TO_RADIANS; ///

  rotate(mat4, mat4, xAngle, xAxis);
  rotate(mat4, mat4, yAngle, yAxis);
  rotate(mat4, mat4, zAngle, zAxis);

  return compose(mat4);
}

function composeTranslate() {
  var position = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultPosition;

  var mat4 = create();

  translate(mat4, mat4, position);

  return compose(mat4);
}

function composeTransform(width, height, depth, dimensions, position, rotations) {
  if (dimensions === undefined) {
    dimensions = {
      width: width,
      height: height,
      depth: depth
    };
  }

  var transformation = {
    dimensions: dimensions,
    position: position,
    rotations: rotations
  },
      transform = composeTransformEx(transformation);

  return transform;
}

function composeTransforms(transform, transformations) {
  var transforms = void 0;

  if (transformations !== undefined) {
    transforms = transformations.map(composeTransformEx);
  } else {
    transforms = [transform];
  }

  return transforms;
}

module.exports = module.exports = {
  composeScale: composeScale,
  composeRotate: composeRotate,
  composeTranslate: composeTranslate,
  composeTransform: composeTransform,
  composeTransforms: composeTransforms
};

function compose(mat4) {
  return function (vec) {
    return transform([].concat(_toConsumableArray(vec), [1]), mat4).slice(0, 3);
  };
}

function composeTransformEx(transformation) {
  var dimensions = transformation.dimensions,
      position = transformation.position,
      rotations = transformation.rotations,
      width = dimensions.width,
      height = dimensions.height,
      depth = dimensions.depth,
      scale = composeScale(width, height, depth),
      rotate = composeRotate(rotations),
      translate = composeTranslate(position);


  return function (vec) {
    return translate(rotate(scale(vec)));
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi91dGlsaXRpZXMvdHJhbnNmb3JtLmpzIl0sIm5hbWVzIjpbIm1hdDQiLCJyZXF1aXJlIiwidmVjNCIsImNvbnN0YW50cyIsImFycmF5VXRpbGl0aWVzIiwiREVHUkVFU19UT19SQURJQU5TIiwiY3JlYXRlIiwidHJhbnNsYXRlIiwic2NhbGUiLCJyb3RhdGUiLCJmaXJzdCIsInNlY29uZCIsInRoaXJkIiwidHJhbnNmb3JtIiwieEF4aXMiLCJ5QXhpcyIsInpBeGlzIiwiZGVmYXVsdFdpZHRoIiwiZGVmYXVsdERlcHRoIiwiZGVmYXVsdEhlaWdodCIsImRlZmF1bHRQb3NpdGlvbiIsImRlZmF1bHRSb3RhdGlvbnMiLCJjb21wb3NlU2NhbGUiLCJ3aWR0aCIsImhlaWdodCIsImRlcHRoIiwiY29tcG9zZSIsImNvbXBvc2VSb3RhdGUiLCJyb3RhdGlvbnMiLCJmaXJzdFJvdGF0aW9uIiwic2Vjb25kUm90YXRpb24iLCJ0aGlyZFJvdGF0aW9uIiwieEFuZ2xlIiwieUFuZ2xlIiwiekFuZ2xlIiwiY29tcG9zZVRyYW5zbGF0ZSIsInBvc2l0aW9uIiwiY29tcG9zZVRyYW5zZm9ybSIsImRpbWVuc2lvbnMiLCJ1bmRlZmluZWQiLCJ0cmFuc2Zvcm1hdGlvbiIsImNvbXBvc2VUcmFuc2Zvcm1FeCIsImNvbXBvc2VUcmFuc2Zvcm1zIiwidHJhbnNmb3JtYXRpb25zIiwidHJhbnNmb3JtcyIsIm1hcCIsIm1vZHVsZSIsImV4cG9ydHMiLCJ2ZWMiLCJzbGljZSJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7QUFFQSxJQUFNQSxPQUFPQyxRQUFRLGVBQVIsQ0FBYjtBQUFBLElBQ01DLE9BQU9ELFFBQVEsZUFBUixDQURiO0FBQUEsSUFFTUUsWUFBWUYsUUFBUSxjQUFSLENBRmxCO0FBQUEsSUFHTUcsaUJBQWlCSCxRQUFRLG9CQUFSLENBSHZCOztBQUtNLElBQUVJLGtCQUFGLEdBQXlCRixTQUF6QixDQUFFRSxrQkFBRjtBQUFBLElBQ0VDLE1BREYsR0FDdUNO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Q0FFbENmLEtBRmtDO0FBQUEsTUFFM0JDLE1BRjJCLEdBRVRjLFVBRlMsQ0FFM0JkLE1BRjJCO0FBQUEsTUFFbkJDLEtBRm1CLEdBRVRhLFVBRlMsQ0FFbkJiLEtBRm1CO0FBQUEsTUFHcENqQixLQUhvQyxHQUc1QmMsYUFBYUMsS0FBYixFQUFvQkMsTUFBcEIsRUFBNEJDLEtBQTVCLENBSDRCO0FBQUEsTUFJcENoQixNQUpvQyxHQUkzQmtCLGNBQWNDLFNBQWQsQ0FKMkI7QUFBQSxNQUtwQ3JCLFNBTG9DLEdBS3hCNEIsaUJBQWlCQyxRQUFqQixDQUx3Qjs7O0FBTzFDLFNBQU8sVUFBU1ksR0FBVCxFQUFjO0FBQ25CLFdBQU96QyxVQUFVRSxPQUFPRCxNQUFNd0MsR0FBTixDQUFQLENBQVYsQ0FBUDtBQUNELEdBRkQ7QUFHRCIsImZpbGUiOiJ0cmFuc2Zvcm0uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IG1hdDQgPSByZXF1aXJlKCcuLi9tYXRocy9tYXQ0JyksXG4gICAgICB2ZWM0ID0gcmVxdWlyZSgnLi4vbWF0aHMvdmVjNCcpLFxuICAgICAgY29uc3RhbnRzID0gcmVxdWlyZSgnLi4vY29uc3RhbnRzJyksXG4gICAgICBhcnJheVV0aWxpdGllcyA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9hcnJheScpO1xuXG5jb25zdCB7IERFR1JFRVNfVE9fUkFESUFOUyB9ID0gY29uc3RhbnRzLFxuICAgICAgeyBjcmVhdGUsIHRyYW5zbGF0ZSwgc2NhbGUsIHJvdGF0ZSB9ID0gbWF0NCxcbiAgICAgIHsgZmlyc3QsIHNlY29uZCwgdGhpcmQgfSA9IGFycmF5VXRpbGl0aWVzLFxuICAgICAgeyB0cmFuc2Zvcm0gfSA9IHZlYzQsXG4gICAgICB4QXhpcyA9IFsgMSwgMCwgMCBdLFxuICAgICAgeUF4aXMgPSBbIDAsIDEsIDAgXSxcbiAgICAgIHpBeGlzID0gWyAwLCAwLCAxIF0sXG4gICAgICBkZWZhdWx0V2lkdGggPSAxLFxuICAgICAgZGVmYXVsdERlcHRoID0gMSxcbiAgICAgIGRlZmF1bHRIZWlnaHQgPSAxLFxuICAgICAgZGVmYXVsdFBvc2l0aW9uID0gWyAwLCAwLCAwIF0sXG4gICAgICBkZWZhdWx0Um90YXRpb25zID0gWyAwLCAwLCAwIF07XG5cbmZ1bmN0aW9uIGNvbXBvc2VTY2FsZSh3aWR0aCA9IGRlZmF1bHRXaWR0aCwgaGVpZ2h0ID0gZGVmYXVsdEhlaWdodCwgZGVwdGggPSBkZWZhdWx0RGVwdGgpIHtcbiAgY29uc3QgbWF0NCA9IGNyZWF0ZSgpO1xuXG4gIHNjYWxlKG1hdDQsIG1hdDQsIFsgd2lkdGgsIGhlaWdodCwgZGVwdGggXSk7XG5cbiAgcmV0dXJuIGNvbXBvc2UobWF0NCk7XG59XG5cbmZ1bmN0aW9uIGNvbXBvc2VSb3RhdGUocm90YXRpb25zID0gZGVmYXVsdFJvdGF0aW9ucykge1xuICBjb25zdCBtYXQ0ID0gY3JlYXRlKCksXG4gICAgICAgIGZpcnN0Um90YXRpb24gPSBmaXJzdChyb3RhdGlvbnMpLFxuICAgICAgICBzZWNvbmRSb3RhdGlvbiA9IHNlY29uZChyb3RhdGlvbnMpLFxuICAgICAgICB0aGlyZFJvdGF0aW9uID0gdGhpcmQocm90YXRpb25zKSxcbiAgICAgICAgeEFuZ2xlID0gZmlyc3RSb3RhdGlvbiAqIERFR1JFRVNfVE9fUkFESUFOUywgIC8vL1xuICAgICAgICB5QW5nbGUgPSBzZWNvbmRSb3RhdGlvbiAqIERFR1JFRVNfVE9fUkFESUFOUywgLy8vXG4gICAgICAgIHpBbmdsZSA9IHRoaXJkUm90YXRpb24gKiBERUdSRUVTX1RPX1JBRElBTlM7ICAvLy9cblxuICByb3RhdGUobWF0NCwgbWF0NCwgeEFuZ2xlLCB4QXhpcyk7XG4gIHJvdGF0ZShtYXQ0LCBtYXQ0LCB5QW5nbGUsIHlBeGlzKTtcbiAgcm90YXRlKG1hdDQsIG1hdDQsIHpBbmdsZSwgekF4aXMpO1xuXG4gIHJldHVybiBjb21wb3NlKG1hdDQpO1xufVxuXG5mdW5jdGlvbiBjb21wb3NlVHJhbnNsYXRlKHBvc2l0aW9uID0gZGVmYXVsdFBvc2l0aW9uKSB7XG4gIGNvbnN0IG1hdDQgPSBjcmVhdGUoKTtcblxuICB0cmFuc2xhdGUobWF0NCwgbWF0NCwgcG9zaXRpb24pO1xuXG4gIHJldHVybiBjb21wb3NlKG1hdDQpO1xufVxuXG5mdW5jdGlvbiBjb21wb3NlVHJhbnNmb3JtKHdpZHRoLCBoZWlnaHQsIGRlcHRoLCBkaW1lbnNpb25zLCBwb3NpdGlvbiwgcm90YXRpb25zKSB7XG4gIGlmIChkaW1lbnNpb25zID09PSB1bmRlZmluZWQpIHtcbiAgICBkaW1lbnNpb25zID0ge1xuICAgICAgd2lkdGg6IHdpZHRoLFxuICAgICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgICBkZXB0aDogZGVwdGhcbiAgICB9XG4gIH1cblxuICBjb25zdCB0cmFuc2Zvcm1hdGlvbiA9IHtcbiAgICAgICAgICBkaW1lbnNpb25zOiBkaW1lbnNpb25zLFxuICAgICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbixcbiAgICAgICAgICByb3RhdGlvbnM6IHJvdGF0aW9uc1xuICAgICAgICB9LFxuICAgICAgICB0cmFuc2Zvcm0gPSBjb21wb3NlVHJhbnNmb3JtRXgodHJhbnNmb3JtYXRpb24pO1xuXG4gIHJldHVybiB0cmFuc2Zvcm07XG59XG5cbmZ1bmN0aW9uIGNvbXBvc2VUcmFuc2Zvcm1zKHRyYW5zZm9ybSwgdHJhbnNmb3JtYXRpb25zKSB7XG4gIGxldCB0cmFuc2Zvcm1zO1xuXG4gIGlmICh0cmFuc2Zvcm1hdGlvbnMgIT09IHVuZGVmaW5lZCkge1xuICAgIHRyYW5zZm9ybXMgPSB0cmFuc2Zvcm1hdGlvbnMubWFwKGNvbXBvc2VUcmFuc2Zvcm1FeCk7XG4gIH0gZWxzZSB7XG4gICAgdHJhbnNmb3JtcyA9IFtcbiAgICAgIHRyYW5zZm9ybVxuICAgIF07XG4gIH1cblxuICByZXR1cm4gdHJhbnNmb3Jtcztcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgY29tcG9zZVNjYWxlOiBjb21wb3NlU2NhbGUsXG4gIGNvbXBvc2VSb3RhdGU6IGNvbXBvc2VSb3RhdGUsXG4gIGNvbXBvc2VUcmFuc2xhdGU6IGNvbXBvc2VUcmFuc2xhdGUsXG4gIGNvbXBvc2VUcmFuc2Zvcm06IGNvbXBvc2VUcmFuc2Zvcm0sXG4gIGNvbXBvc2VUcmFuc2Zvcm1zOiBjb21wb3NlVHJhbnNmb3Jtc1xufTtcblxuZnVuY3Rpb24gY29tcG9zZShtYXQ0KSB7XG4gIHJldHVybiBmdW5jdGlvbih2ZWMpIHtcbiAgICByZXR1cm4gdHJhbnNmb3JtKFsuLi52ZWMsIDFdLCBtYXQ0KS5zbGljZSgwLCAzKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gY29tcG9zZVRyYW5zZm9ybUV4KHRyYW5zZm9ybWF0aW9uKSB7XG4gIGNvbnN0IHsgZGltZW5zaW9ucywgcG9zaXRpb24sIHJvdGF0aW9ucyB9ID0gdHJhbnNmb3JtYXRpb24sXG4gICAgICAgIHsgd2lkdGgsIGhlaWdodCwgZGVwdGggfSA9IGRpbWVuc2lvbnMsXG4gICAgICAgIHNjYWxlID0gY29tcG9zZVNjYWxlKHdpZHRoLCBoZWlnaHQsIGRlcHRoKSxcbiAgICAgICAgcm90YXRlID0gY29tcG9zZVJvdGF0ZShyb3RhdGlvbnMpLFxuICAgICAgICB0cmFuc2xhdGUgPSBjb21wb3NlVHJhbnNsYXRlKHBvc2l0aW9uKTtcblxuICByZXR1cm4gZnVuY3Rpb24odmVjKSB7XG4gICAgcmV0dXJuIHRyYW5zbGF0ZShyb3RhdGUoc2NhbGUodmVjKSkpO1xuICB9XG59XG4iXX0=
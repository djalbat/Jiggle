'use strict';

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

var mat4 = require('../maths/mat4'),
    vec4 = require('../maths/vec4'),
    constants = require('../constants'),
    arrayUtilities = require('../utilities/array');

var DEGREES_TO_RADIANS = constants.DEGREES_TO_RADIANS,
    create = mat4.create,
    translate = mat4.translate,
    scale = mat4.scale,
    rotate = mat4.rotate,
    first = arrayUtilities.first,
    second = arrayUtilities.second,
    third = arrayUtilities.third,
    transform = vec4.transform,
    defaultWidth = 1,
    defaultDepth = 1,
    defaultHeight = 1,
    xAxis = [1, 0, 0],
    yAxis = [0, 1, 0],
    zAxis = [0, 0, 1],
    defaultPosition = [0, 0, 0],
    defaultRotations = [0, 0, 0];


function composeScaleRotateTranslate(width, height, depth, position, rotations) {
  var scale = composeScale(width, height, depth),
      rotate = composeRotate(rotations),
      translate = composeTranslate(position);

  return function (vec) {
    return translate(rotate(scale(vec)));
  };
}

function composeTranslate() {
  var position = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultPosition;

  var mat4 = create();

  translate(mat4, mat4, position);

  return composeTransform(mat4);
}

function composeScale() {
  var width = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultWidth;
  var height = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultHeight;
  var depth = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : defaultDepth;

  var mat4 = create();

  scale(mat4, mat4, [width, height, depth]);

  return composeTransform(mat4);
}

function composeRotate() {
  var rotations = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultRotations;

  var mat4 = create(),
      firstRotation = first(rotations),
      secondRotation = second(rotations),
      thirdRotation = third(rotations),
      xAngle = firstRotation * DEGREES_TO_RADIANS,
      ///
  yAngle = secondRotation * DEGREES_TO_RADIANS,
      ///
  zAngle = thirdRotation * DEGREES_TO_RADIANS; ///

  rotate(mat4, mat4, xAngle, xAxis);
  rotate(mat4, mat4, yAngle, yAxis);
  rotate(mat4, mat4, zAngle, zAxis);

  return composeTransform(mat4);
}

module.exports = module.exports = {
  composeScaleRotateTranslate: composeScaleRotateTranslate,
  composeScale: composeScale,
  composeRotate: composeRotate,
  composeTranslate: composeTranslate
};

function composeTransform(mat4) {
  return function (vec) {
    return transform([].concat(_toConsumableArray(vec), [1]), mat4).slice(0, 3);
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi91dGlsaXRpZXMvdHJhbnNmb3JtLmpzIl0sIm5hbWVzIjpbIm1hdDQiLCJyZXF1aXJlIiwidmVjNCIsImNvbnN0YW50cyIsImFycmF5VXRpbGl0aWVzIiwiREVHUkVFU19UT19SQURJQU5TIiwiY3JlYXRlIiwidHJhbnNsYXRlIiwic2NhbGUiLCJyb3RhdGUiLCJmaXJzdCIsInNlY29uZCIsInRoaXJkIiwidHJhbnNmb3JtIiwiZGVmYXVsdFdpZHRoIiwiZGVmYXVsdERlcHRoIiwiZGVmYXVsdEhlaWdodCIsInhBeGlzIiwieUF4aXMiLCJ6QXhpcyIsImRlZmF1bHRQb3NpdGlvbiIsImRlZmF1bHRSb3RhdGlvbnMiLCJjb21wb3NlU2NhbGVSb3RhdGVUcmFuc2xhdGUiLCJ3aWR0aCIsImhlaWdodCIsImRlcHRoIiwicG9zaXRpb24iLCJyb3RhdGlvbnMiLCJjb21wb3NlU2NhbGUiLCJjb21wb3NlUm90YXRlIiwiY29tcG9zZVRyYW5zbGF0ZSIsInZlYyIsImNvbXBvc2VUcmFuc2Zvcm0iLCJmaXJzdFJvdGF0aW9uIiwic2Vjb25kUm90YXRpb24iLCJ0aGlyZFJvdGF0aW9uIiwieEFuZ2xlIiwieUFuZ2xlIiwiekFuZ2xlIiwibW9kdWxlIiwiZXhwb3J0cyIsInNsaWNlIl0sIm1hcHBpbmdzIjoiQUFBQTs7OztBQUVBLElBQU1BLE9BQU9DLFFBQVEsZUFBUixDQUFiO0FBQUEsSUFDTUMsT0FBT0QsUUFBUSxlQUFSLENBRGI7QUFBQSxJQUVNRSxZQUFZRixRQUFRLGNBQVIsQ0FGbEI7QUFBQSxJQUdNRyxpQkFBaUJILFFBQVEsb0JBQVIsQ0FIdkI7O0FBS00sSUFBRUksa0JBQUYsR0FBeUJGLFNBQXpCLENBQUVFLGtCQUFGO0FBQUEsSUFDRUMsTUFERixHQUN1Q04sSUFEdkMsQ0FDRU0sTUFERjtBQUFBLElBQ1VDLFNBRFYsR0FDdUNQLElBRHZDLENBQ1VPLFNBRFY7QUFBQSxJQUNxQkMsS0FEckIsR0FDdUNSLElBRHZDLENBQ3FCUSxLQURy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S0FBM0I7O0FBRUEsU0FBT2EsaUJBQWlCaEMsSUFBakIsQ0FBUDtBQUNEOztBQUVEdUMsT0FBT0MsT0FBUCxHQUFpQkQsT0FBT0MsT0FBUCxHQUFpQjtBQUNoQ2xCLCtCQUE2QkEsMkJBREc7QUFFaENNLGdCQUFjQSxZQUZrQjtBQUdoQ0MsaUJBQWVBLGFBSGlCO0FBSWhDQyxvQkFBa0JBO0FBSmMsQ0FBbEM7O0FBT0EsU0FBU0UsZ0JBQVQsQ0FBMEJoQyxJQUExQixFQUFnQztBQUM5QixTQUFPLFVBQVMrQixHQUFULEVBQWM7QUFDbkIsV0FBT2xCLHVDQUFja0IsR0FBZCxJQUFtQixDQUFuQixJQUF1Qi9CLElBQXZCLEVBQTZCeUMsS0FBN0IsQ0FBbUMsQ0FBbkMsRUFBc0MsQ0FBdEMsQ0FBUDtBQUNELEdBRkQ7QUFHRCIsImZpbGUiOiJ0cmFuc2Zvcm0uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IG1hdDQgPSByZXF1aXJlKCcuLi9tYXRocy9tYXQ0JyksXG4gICAgICB2ZWM0ID0gcmVxdWlyZSgnLi4vbWF0aHMvdmVjNCcpLFxuICAgICAgY29uc3RhbnRzID0gcmVxdWlyZSgnLi4vY29uc3RhbnRzJyksXG4gICAgICBhcnJheVV0aWxpdGllcyA9IHJlcXVpcmUoJy4uL3V0aWxpdGllcy9hcnJheScpO1xuXG5jb25zdCB7IERFR1JFRVNfVE9fUkFESUFOUyB9ID0gY29uc3RhbnRzLFxuICAgICAgeyBjcmVhdGUsIHRyYW5zbGF0ZSwgc2NhbGUsIHJvdGF0ZSB9ID0gbWF0NCxcbiAgICAgIHsgZmlyc3QsIHNlY29uZCwgdGhpcmQgfSA9IGFycmF5VXRpbGl0aWVzLFxuICAgICAgeyB0cmFuc2Zvcm0gfSA9IHZlYzQsXG4gICAgICBkZWZhdWx0V2lkdGggPSAxLFxuICAgICAgZGVmYXVsdERlcHRoID0gMSxcbiAgICAgIGRlZmF1bHRIZWlnaHQgPSAxLFxuICAgICAgeEF4aXMgPSBbIDEsIDAsIDAgXSxcbiAgICAgIHlBeGlzID0gWyAwLCAxLCAwIF0sXG4gICAgICB6QXhpcyA9IFsgMCwgMCwgMSBdLFxuICAgICAgZGVmYXVsdFBvc2l0aW9uID0gWyAwLCAwLCAwIF0sXG4gICAgICBkZWZhdWx0Um90YXRpb25zID0gWyAwLCAwLCAwIF07XG5cbmZ1bmN0aW9uIGNvbXBvc2VTY2FsZVJvdGF0ZVRyYW5zbGF0ZSh3aWR0aCwgaGVpZ2h0LCBkZXB0aCwgcG9zaXRpb24sIHJvdGF0aW9ucykge1xuICBjb25zdCBzY2FsZSA9IGNvbXBvc2VTY2FsZSh3aWR0aCwgaGVpZ2h0LCBkZXB0aCksXG4gICAgICAgIHJvdGF0ZSA9IGNvbXBvc2VSb3RhdGUocm90YXRpb25zKSxcbiAgICAgICAgdHJhbnNsYXRlID0gY29tcG9zZVRyYW5zbGF0ZShwb3NpdGlvbik7XG4gIFxuICByZXR1cm4gZnVuY3Rpb24odmVjKSB7XG4gICAgcmV0dXJuIHRyYW5zbGF0ZShyb3RhdGUoc2NhbGUodmVjKSkpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNvbXBvc2VUcmFuc2xhdGUocG9zaXRpb24gPSBkZWZhdWx0UG9zaXRpb24pIHtcbiAgY29uc3QgbWF0NCA9IGNyZWF0ZSgpO1xuXG4gIHRyYW5zbGF0ZShtYXQ0LCBtYXQ0LCBwb3NpdGlvbik7XG5cbiAgcmV0dXJuIGNvbXBvc2VUcmFuc2Zvcm0obWF0NCk7XG59XG5cbmZ1bmN0aW9uIGNvbXBvc2VTY2FsZSh3aWR0aCA9IGRlZmF1bHRXaWR0aCwgaGVpZ2h0ID0gZGVmYXVsdEhlaWdodCwgZGVwdGggPSBkZWZhdWx0RGVwdGgpIHtcbiAgY29uc3QgbWF0NCA9IGNyZWF0ZSgpO1xuXG4gIHNjYWxlKG1hdDQsIG1hdDQsIFt3aWR0aCwgaGVpZ2h0LCBkZXB0aF0pO1xuXG4gIHJldHVybiBjb21wb3NlVHJhbnNmb3JtKG1hdDQpO1xufVxuXG5mdW5jdGlvbiBjb21wb3NlUm90YXRlKHJvdGF0aW9ucyA9IGRlZmF1bHRSb3RhdGlvbnMpIHtcbiAgY29uc3QgbWF0NCA9IGNyZWF0ZSgpLFxuICAgICAgICBmaXJzdFJvdGF0aW9uID0gZmlyc3Qocm90YXRpb25zKSxcbiAgICAgICAgc2Vjb25kUm90YXRpb24gPSBzZWNvbmQocm90YXRpb25zKSxcbiAgICAgICAgdGhpcmRSb3RhdGlvbiA9IHRoaXJkKHJvdGF0aW9ucyksXG4gICAgICAgIHhBbmdsZSA9IGZpcnN0Um90YXRpb24gKiBERUdSRUVTX1RPX1JBRElBTlMsICAvLy9cbiAgICAgICAgeUFuZ2xlID0gc2Vjb25kUm90YXRpb24gKiBERUdSRUVTX1RPX1JBRElBTlMsIC8vL1xuICAgICAgICB6QW5nbGUgPSB0aGlyZFJvdGF0aW9uICogREVHUkVFU19UT19SQURJQU5TOyAgLy8vXG5cbiAgcm90YXRlKG1hdDQsIG1hdDQsIHhBbmdsZSwgeEF4aXMpO1xuICByb3RhdGUobWF0NCwgbWF0NCwgeUFuZ2xlLCB5QXhpcyk7XG4gIHJvdGF0ZShtYXQ0LCBtYXQ0LCB6QW5nbGUsIHpBeGlzKTtcblxuICByZXR1cm4gY29tcG9zZVRyYW5zZm9ybShtYXQ0KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHtcbiAgY29tcG9zZVNjYWxlUm90YXRlVHJhbnNsYXRlOiBjb21wb3NlU2NhbGVSb3RhdGVUcmFuc2xhdGUsXG4gIGNvbXBvc2VTY2FsZTogY29tcG9zZVNjYWxlLFxuICBjb21wb3NlUm90YXRlOiBjb21wb3NlUm90YXRlLFxuICBjb21wb3NlVHJhbnNsYXRlOiBjb21wb3NlVHJhbnNsYXRlXG59O1xuXG5mdW5jdGlvbiBjb21wb3NlVHJhbnNmb3JtKG1hdDQpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHZlYykge1xuICAgIHJldHVybiB0cmFuc2Zvcm0oWy4uLnZlYywgMV0sIG1hdDQpLnNsaWNlKDAsIDMpO1xuICB9O1xufVxuIl19
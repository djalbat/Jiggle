'use strict';

var vec3 = require('../maths/vec3'),
    vec4 = require('../maths/vec4'),
    mat4 = require('../maths/mat4'),
    arrayUtilities = require('../utilities/array');

var chop = arrayUtilities.chop,
    flatten = arrayUtilities.flatten,
    create = mat4.create,
    translate = mat4.translate,
    scale = mat4.scale,
    rotate = mat4.rotate,
    transformMat4 = vec4.transformMat4,
    subtract = vec3.subtract,
    cross = vec3.cross;


var defaultWidth = 1,
    defaultDepth = 1,
    defaultHeight = 1,
    defaultOffset = [0, 0, 0],
    defaultRotation = [0, 0, 0];

function calculateVertexPositionData(initialVertexPositionData) {
  var width = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultWidth;
  var height = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : defaultHeight;
  var depth = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : defaultDepth;
  var offset = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : defaultOffset;
  var rotation = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : defaultRotation;

  var mat4 = create(),
      xAngle = rotation[0] * Math.PI / 180,
      yAngle = rotation[1] * Math.PI / 180,
      zAngle = rotation[2] * Math.PI / 180;

  translate(mat4, mat4, offset);

  rotate(mat4, mat4, xAngle, [1, 0, 0]);
  rotate(mat4, mat4, yAngle, [0, 1, 0]);
  rotate(mat4, mat4, zAngle, [0, 0, 1]);

  scale(mat4, mat4, [width, height, depth]);

  var vertexPositions = chop(initialVertexPositionData, 4); ///

  vertexPositions = vertexPositions.map(function (vertexPosition) {
    return transformMat4(vertexPosition, vertexPosition, mat4);
  });

  vertexPositions = vertexPositions.map(function (vertexPosition) {
    return vertexPosition.slice(0, 3);
  });

  var vertexPositionData = flatten(vertexPositions);

  return vertexPositionData;
}

function calculateVertexNormalData(initialVertexPositionData) {
  var vertexNormalVectors = [],
      faces = chop(initialVertexPositionData, 16); ///

  faces.forEach(function (face) {
    var vertexPositions = chop(face, 4);

    for (var index = 0; index < 4; index++) {
      var firstVertexIndex = index,
          secondVertexIndex = (index + 1) % 4,
          thirdVertexIndex = (index + 3) % 4,
          firstVertexPosition = vertexPositions[firstVertexIndex],
          secondVertexPosition = vertexPositions[secondVertexIndex],
          thirdVertexPosition = vertexPositions[thirdVertexIndex],
          firstVector = subtract(secondVertexPosition, firstVertexPosition),
          ///
      secondVector = subtract(thirdVertexPosition, firstVertexPosition),
          ///
      vertexNormalVector = cross(firstVector, secondVector);

      vertexNormalVectors.push(vertexNormalVector);
    }
  });

  var vertexNormalData = flatten(vertexNormalVectors); ///

  return vertexNormalData;
}

function calculateVertexIndexData(initialVertexPositionData) {
  var vertexIndexData = [],
      initialVertexPositionDataLength = initialVertexPositionData.length,
      facesLength = initialVertexPositionDataLength / 16; ///

  for (var index = 0; index < facesLength; index++) {
    var offset = index * 4;

    vertexIndexData.push(offset + 0);
    vertexIndexData.push(offset + 1);
    vertexIndexData.push(offset + 2);
    vertexIndexData.push(offset + 0);
    vertexIndexData.push(offset + 2);
    vertexIndexData.push(offset + 3);
  }

  return vertexIndexData;
}

module.exports = {
  calculateVertexPositionData: calculateVertexPositionData,
  calculateVertexNormalData: calculateVertexNormalData,
  calculateVertexIndexData: calculateVertexIndexData
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi91dGlsaXRpZXMvdmVydGV4LmpzIl0sIm5hbWVzIjpbInZlYzMiLCJyZXF1aXJlIiwidmVjNCIsIm1hdDQiLCJhcnJheVV0aWxpdGllcyIsImNob3AiLCJmbGF0dGVuIiwiY3JlYXRlIiwidHJhbnNsYXRlIiwic2NhbGUiLCJyb3RhdGUiLCJ0cmFuc2Zvcm1NYXQ0Iiwic3VidHJhY3QiLCJjcm9zcyIsImRlZmF1bHRXaWR0aCIsImRlZmF1bHREZXB0aCIsImRlZmF1bHRIZWlnaHQiLCJkZWZhdWx0T2Zmc2V0IiwiZGVmYXVsdFJvdGF0aW9uIiwiY2FsY3VsYXRlVmVydGV4UG9zaXRpb25EYXRhIiwiaW5pdGlhbFZlcnRleFBvc2l0aW9uRGF0YSIsIndpZHRoIiwiaGVpZ2h0IiwiZGVwdGgiLCJvZmZzZXQiLCJyb3RhdGlvbiIsInhBbmdsZSIsIk1hdGgiLCJQSSIsInlBbmdsZSIsInpBbmdsZSIsInZlcnRleFBvc2l0aW9ucyIsIm1hcCIsInZlcnRleFBvc2l0aW9uIiwic2xpY2UiLCJ2ZXJ0ZXhQb3NpdGlvbkRhdGEiLCJjYWxjdWxhdGVWZXJ0ZXhOb3JtYWxEYXRhIiwidmVydGV4Tm9ybWFsVmVjdG9ycyIsImZhY2VzIiwiZm9yRWFjaCIsImZhY2UiLCJpbmRleCIsImZpcnN0VmVydGV4SW5kZXgiLCJzZWNvbmRWZXJ0ZXhJbmRleCIsInRoaXJkVmVydGV4SW5kZXgiLCJmaXJzdFZlcnRleFBvc2l0aW9uIiwic2Vjb25kVmVydGV4UG9zaXRpb24iLCJ0aGlyZFZlcnRleFBvc2l0aW9uIiwiZmlyc3RWZWN0b3IiLCJzZWNvbmRWZWN0b3IiLCJ2ZXJ0ZXhOb3JtYWxWZWN0b3IiLCJwdXNoIiwidmVydGV4Tm9ybWFsRGF0YSIsImNhbGN1bGF0ZVZlcnRleEluZGV4RGF0YSIsInZlcnRleEluZGV4RGF0YSIsImluaXRpYWxWZXJ0ZXhQb3NpdGlvbkRhdGFMZW5ndGgiLCJsZW5ndGgiLCJmYWNlc0xlbmd0aCIsIm1vZHVsZSIsImV4cG9ydHMi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UWdCLFdBQTVCLEVBQXlDaEIsT0FBekMsRUFBa0Q7QUFDaEQsUUFBTWpCLFNBQVNpQixRQUFRLENBQXZCOztBQUVBYSxvQkFBZ0JILElBQWhCLENBQXFCM0IsU0FBUyxDQUE5QjtBQUNBOEIsb0JBQWdCSCxJQUFoQixDQUFxQjNCLFNBQVMsQ0FBOUI7QUFDQThCLG9CQUFnQkgsSUFBaEIsQ0FBcUIzQixTQUFTLENBQTlCO0FBQ0E4QixvQkFBZ0JILElBQWhCLENBQXFCM0IsU0FBUyxDQUE5QjtBQUNBOEIsb0JBQWdCSCxJQUFoQixDQUFxQjNCLFNBQVMsQ0FBOUI7QUFDQThCLG9CQUFnQkgsSUFBaEIsQ0FBcUIzQixTQUFTLENBQTlCO0FBQ0Q7O0FBRUQsU0FBTzhCLGVBQVA7QUFDRDs7QUFFREksT0FBT0MsT0FBUCxHQUFpQjtBQUNmeEMsK0JBQTZCQSwyQkFEZDtBQUVmaUIsNkJBQTJCQSx5QkFGWjtBQUdmaUIsNEJBQTBCQTtBQUhYLENBQWpCIiwiZmlsZSI6InZlcnRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgdmVjMyA9IHJlcXVpcmUoJy4uL21hdGhzL3ZlYzMnKSxcbiAgICAgIHZlYzQgPSByZXF1aXJlKCcuLi9tYXRocy92ZWM0JyksXG4gICAgICBtYXQ0ID0gcmVxdWlyZSgnLi4vbWF0aHMvbWF0NCcpLFxuICAgICAgYXJyYXlVdGlsaXRpZXMgPSByZXF1aXJlKCcuLi91dGlsaXRpZXMvYXJyYXknKTtcblxuY29uc3QgeyBjaG9wLCBmbGF0dGVuIH0gPSBhcnJheVV0aWxpdGllcyxcbiAgICAgIHsgY3JlYXRlLCB0cmFuc2xhdGUsIHNjYWxlLCByb3RhdGUgfSA9IG1hdDQsXG4gICAgICB7IHRyYW5zZm9ybU1hdDQgfSA9IHZlYzQsXG4gICAgICB7IHN1YnRyYWN0LCBjcm9zcyB9ID0gdmVjMztcblxuY29uc3QgZGVmYXVsdFdpZHRoID0gMSxcbiAgICAgIGRlZmF1bHREZXB0aCA9IDEsXG4gICAgICBkZWZhdWx0SGVpZ2h0ID0gMSxcbiAgICAgIGRlZmF1bHRPZmZzZXQgPSBbIDAsIDAsIDAgXSxcbiAgICAgIGRlZmF1bHRSb3RhdGlvbiA9IFsgMCwgMCwgMF07XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZVZlcnRleFBvc2l0aW9uRGF0YShpbml0aWFsVmVydGV4UG9zaXRpb25EYXRhLCB3aWR0aCA9IGRlZmF1bHRXaWR0aCwgaGVpZ2h0ID0gZGVmYXVsdEhlaWdodCwgZGVwdGggPSBkZWZhdWx0RGVwdGgsIG9mZnNldCA9IGRlZmF1bHRPZmZzZXQsIHJvdGF0aW9uID0gZGVmYXVsdFJvdGF0aW9uKSB7XG4gIGNvbnN0IG1hdDQgPSBjcmVhdGUoKSxcbiAgICAgICAgeEFuZ2xlID0gcm90YXRpb25bMF0gKiBNYXRoLlBJIC8gMTgwLFxuICAgICAgICB5QW5nbGUgPSByb3RhdGlvblsxXSAqIE1hdGguUEkgLyAxODAsXG4gICAgICAgIHpBbmdsZSA9IHJvdGF0aW9uWzJdICogTWF0aC5QSSAvIDE4MDtcblxuICB0cmFuc2xhdGUobWF0NCwgbWF0NCwgb2Zmc2V0KTtcblxuICByb3RhdGUobWF0NCwgbWF0NCwgeEFuZ2xlLCBbMSwgMCwgMF0pO1xuICByb3RhdGUobWF0NCwgbWF0NCwgeUFuZ2xlLCBbMCwgMSwgMF0pO1xuICByb3RhdGUobWF0NCwgbWF0NCwgekFuZ2xlLCBbMCwgMCwgMV0pO1xuXG4gIHNjYWxlKG1hdDQsIG1hdDQsIFt3aWR0aCwgaGVpZ2h0LCBkZXB0aF0pO1xuXG4gIGxldCB2ZXJ0ZXhQb3NpdGlvbnMgPSBjaG9wKGluaXRpYWxWZXJ0ZXhQb3NpdGlvbkRhdGEsIDQpOyAgLy8vXG5cbiAgdmVydGV4UG9zaXRpb25zID0gdmVydGV4UG9zaXRpb25zLm1hcChmdW5jdGlvbih2ZXJ0ZXhQb3NpdGlvbikge1xuICAgIHJldHVybiB0cmFuc2Zvcm1NYXQ0KHZlcnRleFBvc2l0aW9uLCB2ZXJ0ZXhQb3NpdGlvbiwgbWF0NCk7XG4gIH0pO1xuXG4gIHZlcnRleFBvc2l0aW9ucyA9IHZlcnRleFBvc2l0aW9ucy5tYXAoZnVuY3Rpb24odmVydGV4UG9zaXRpb24pIHtcbiAgICByZXR1cm4gdmVydGV4UG9zaXRpb24uc2xpY2UoMCwgMyk7XG4gIH0pO1xuICBcbiAgY29uc3QgdmVydGV4UG9zaXRpb25EYXRhID0gZmxhdHRlbih2ZXJ0ZXhQb3NpdGlvbnMpOyBcblxuICByZXR1cm4gdmVydGV4UG9zaXRpb25EYXRhO1xufVxuXG5mdW5jdGlvbiBjYWxjdWxhdGVWZXJ0ZXhOb3JtYWxEYXRhKGluaXRpYWxWZXJ0ZXhQb3NpdGlvbkRhdGEpIHtcbiAgY29uc3QgdmVydGV4Tm9ybWFsVmVjdG9ycyA9IFtdLFxuICAgICAgICBmYWNlcyA9IGNob3AoaW5pdGlhbFZlcnRleFBvc2l0aW9uRGF0YSwgMTYpOyAgLy8vXG5cbiAgZmFjZXMuZm9yRWFjaChmdW5jdGlvbihmYWNlKSB7XG4gICAgY29uc3QgdmVydGV4UG9zaXRpb25zID0gY2hvcChmYWNlLCA0KTtcblxuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCA0OyBpbmRleCsrKSB7XG4gICAgICBjb25zdCBmaXJzdFZlcnRleEluZGV4ID0gaW5kZXgsXG4gICAgICAgICAgICBzZWNvbmRWZXJ0ZXhJbmRleCA9IChpbmRleCArIDEpICUgNCxcbiAgICAgICAgICAgIHRoaXJkVmVydGV4SW5kZXggPSAoaW5kZXggKyAzKSAlIDQsXG4gICAgICAgICAgICBmaXJzdFZlcnRleFBvc2l0aW9uID0gdmVydGV4UG9zaXRpb25zW2ZpcnN0VmVydGV4SW5kZXhdLFxuICAgICAgICAgICAgc2Vjb25kVmVydGV4UG9zaXRpb24gPSB2ZXJ0ZXhQb3NpdGlvbnNbc2Vjb25kVmVydGV4SW5kZXhdLFxuICAgICAgICAgICAgdGhpcmRWZXJ0ZXhQb3NpdGlvbiA9IHZlcnRleFBvc2l0aW9uc1t0aGlyZFZlcnRleEluZGV4XSxcbiAgICAgICAgICAgIGZpcnN0VmVjdG9yID0gc3VidHJhY3Qoc2Vjb25kVmVydGV4UG9zaXRpb24sIGZpcnN0VmVydGV4UG9zaXRpb24pLCAgLy8vXG4gICAgICAgICAgICBzZWNvbmRWZWN0b3IgPSBzdWJ0cmFjdCh0aGlyZFZlcnRleFBvc2l0aW9uLCBmaXJzdFZlcnRleFBvc2l0aW9uKSwgIC8vL1xuICAgICAgICAgICAgdmVydGV4Tm9ybWFsVmVjdG9yID0gY3Jvc3MoZmlyc3RWZWN0b3IsIHNlY29uZFZlY3Rvcik7XG5cbiAgICAgIHZlcnRleE5vcm1hbFZlY3RvcnMucHVzaCh2ZXJ0ZXhOb3JtYWxWZWN0b3IpO1xuICAgIH1cbiAgfSk7XG4gIFxuICBjb25zdCB2ZXJ0ZXhOb3JtYWxEYXRhID0gZmxhdHRlbih2ZXJ0ZXhOb3JtYWxWZWN0b3JzKTsgLy8vXG5cbiAgcmV0dXJuIHZlcnRleE5vcm1hbERhdGE7XG59XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZVZlcnRleEluZGV4RGF0YShpbml0aWFsVmVydGV4UG9zaXRpb25EYXRhKSB7XG4gIGNvbnN0IHZlcnRleEluZGV4RGF0YSA9IFtdLFxuICAgICAgICBpbml0aWFsVmVydGV4UG9zaXRpb25EYXRhTGVuZ3RoID0gaW5pdGlhbFZlcnRleFBvc2l0aW9uRGF0YS5sZW5ndGgsXG4gICAgICAgIGZhY2VzTGVuZ3RoID0gaW5pdGlhbFZlcnRleFBvc2l0aW9uRGF0YUxlbmd0aCAvIDE2OyAvLy9cblxuICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgZmFjZXNMZW5ndGg7IGluZGV4KyspIHtcbiAgICBjb25zdCBvZmZzZXQgPSBpbmRleCAqIDQ7XG5cbiAgICB2ZXJ0ZXhJbmRleERhdGEucHVzaChvZmZzZXQgKyAwKTtcbiAgICB2ZXJ0ZXhJbmRleERhdGEucHVzaChvZmZzZXQgKyAxKTtcbiAgICB2ZXJ0ZXhJbmRleERhdGEucHVzaChvZmZzZXQgKyAyKTtcbiAgICB2ZXJ0ZXhJbmRleERhdGEucHVzaChvZmZzZXQgKyAwKTtcbiAgICB2ZXJ0ZXhJbmRleERhdGEucHVzaChvZmZzZXQgKyAyKTtcbiAgICB2ZXJ0ZXhJbmRleERhdGEucHVzaChvZmZzZXQgKyAzKTtcbiAgfVxuXG4gIHJldHVybiB2ZXJ0ZXhJbmRleERhdGE7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBjYWxjdWxhdGVWZXJ0ZXhQb3NpdGlvbkRhdGE6IGNhbGN1bGF0ZVZlcnRleFBvc2l0aW9uRGF0YSxcbiAgY2FsY3VsYXRlVmVydGV4Tm9ybWFsRGF0YTogY2FsY3VsYXRlVmVydGV4Tm9ybWFsRGF0YSxcbiAgY2FsY3VsYXRlVmVydGV4SW5kZXhEYXRhOiBjYWxjdWxhdGVWZXJ0ZXhJbmRleERhdGFcbn07XG4iXX0=
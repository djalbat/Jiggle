'use strict';

var necessary = require('necessary');

var Canvas = require('../canvas'),
    Normal = require('../normal'),
    Rotation = require('../rotation'),
    Position = require('../position'),
    Perspective = require('../perspective'),
    ColourShader = require('../shader/colour'),
    TextureShader = require('../shader/texture'),
    colourCube = require('./intermediate/cube/colour'),
    textureCube = require('./intermediate/cube/texture');

var arrayUtilities = necessary.arrayUtilities,
    asynchronousUtilities = necessary.asynchronousUtilities,
    first = arrayUtilities.first,
    repeatedly = asynchronousUtilities.repeatedly;


function intermediate() {
  var canvas = new Canvas(),
      colourShader = ColourShader.fromNothing(canvas),
      textureShader = TextureShader.fromNothing(canvas);

  canvas.enableDepthTesting();
  canvas.enableDepthFunction();

  createTextureCube(textureShader, canvas, function (count) {
    var shader = textureShader; ///

    canvas.useShader(shader);

    shader.activateTexture(canvas);

    var render = createRender(canvas, count, shader);

    requestAnimationFrame(render);
  });
}

module.exports = intermediate;

function createColourCube(colourShader, canvas, callback) {
  var offsetPosition = [-1, 0, 0],
      count = colourCube(offsetPosition, colourShader, canvas);

  callback(count);
}

function createTextureCube(textureShader, canvas, callback) {
  loadImages(function (images) {
    var firstImage = first(images),
        offsetPosition = [+1, 0, 0],
        image = firstImage,
        count = textureCube(offsetPosition, image, textureShader, canvas);

    callback(count);
  });
}

function loadImages(callback) {
  var imageSources = ['texture/bricks.jpg'],
      images = [],
      context = {
    imageSources: imageSources,
    images: images
  },
      length = imageSources.length; ///

  repeatedly(loadImageCallback, length, function () {
    var images = context.images;


    callback(images);
  }, context);
}

function createRender(canvas, count, shader) {
  var initialTime = null;

  var clientWidth = canvas.getClientWidth(),
      clientHeight = canvas.getClientHeight(),
      zCoordinate = -10,
      ///
  position = Position.fromZCoordinate(zCoordinate),
      perspective = Perspective.fromClientWidthAndClientHeight(clientWidth, clientHeight);

  var render = function render(time) {
    if (initialTime === null) {
      initialTime = time;
    }

    var elapsedTime = time - initialTime,

    // xAngle = elapsedTime / 1000,
    // yAngle = elapsedTime / 1000,
    // rotation = Rotation.fromXAngleAndYAngle(xAngle, yAngle),
    rotation = Rotation.fromNothing(),
        normal = Normal.fromRotation(rotation);

    canvas.render(shader, normal, rotation, position, perspective);

    canvas.drawElements(count);

    requestAnimationFrame(render);
  };

  return render;
}

function loadImageCallback(next, done, context, index) {
  var imageSources = context.imageSources,
      images = context.images,
      imageSource = imageSources[index],
      image = new Image();


  images[index] = image;

  image.onload = next; ///

  image.src = imageSource; ///
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi9leGFtcGxlcy9pbnRlcm1lZGlhdGUuanMiXSwibmFtZXMiOlsibmVjZXNzYXJ5IiwicmVxdWlyZSIsIkNhbnZhcyIsIk5vcm1hbCIsIlJvdGF0aW9uIiwiUG9zaXRpb24iLCJQZXJzcGVjdGl2ZSIsIkNvbG91clNoYWRlciIsIlRleHR1cmVTaGFkZXIiLCJjb2xvdXJDdWJlIiwidGV4dHVyZUN1YmUiLCJhcnJheVV0aWxpdGllcyIsImFzeW5jaHJvbm91c1V0aWxpdGllcyIsImZpcnN0IiwicmVwZWF0ZWRseSIsImludGVybWVkaWF0ZSIsImNhbnZhcyIsImNvbG91clNoYWRlciIsImZyb21Ob3RoaW5nIiwidGV4dHVyZVNoYWRlciIsImVuYWJsZURlcHRoVGVzdGluZyIsImVuYWJsZURlcHRoRnVuY3Rpb24iLCJjcmVhdGVUZXh0dXJlQ3ViZSIsImNvdW50Iiwic2hhZGVyIiwidXNlU2hhZGVyIiwiYWN0aXZhdGVUZXh0dXJlIiwicmVuZGVyIiwiY3JlYXRlUmVuZGVyIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwibW9kdWxlIiwiZXhwb3J0cyIsImNyZWF0ZUNvbG91ckN1YmUiLCJjYWxsYmFjayIsIm9mZnNldFBvc2l0aW9uIiwibG9hZEltYWdlcyIsImltYWdlcyIsImZpcnN0SW1hZ2UiLCJpbWFnZSIsImltYWdlU291cmNlcyIsImNvbnRleHQiLCJsZW5ndGgiLCJsb2FkSW1hZ2VDYWxsYmFjayIsImluaXRpYWxUaW1lIiwiY2xpZW50V2lkdGgiLCJnZXRDbGllbnRXaWR0aCIsImNsaWVudEhlaWdodCIsImdldENsaWVudEhlaWdodCIsInpDb29yZGluYXRlIiwicG9zaXRpb24iLCJmcm9tWkNvb3JkaW5hdGUiLCJwZXJzcGVjdGl2ZSIsImZyb21DbGllbnRXaWR0aEFuZENsaWVudEhlaWdodCIsInRpbWUiLCJlbGFwc2VkVGltZSIsInJvdGF0aW9uIiwibm9ybWFsIiwiZnJvbVJvdGF0aW9uIiwiZHJhd0VsZW1lbnRzIiwibmV4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Q0FDL0JKLE1BRCtCO0FBQUEsTUFFL0MwQixXQUYrQyxHQUVqQ3ZCLGFBQWFzQixLQUFiLENBRmlDO0FBQUEsTUFHL0N2QixLQUgrQyxHQUd2QyxJQUFJeUIsS0FBSixFQUh1Qzs7O0FBS3JEM0IsU0FBT3lCLEtBQVAsSUFBZ0J2QixLQUFoQjs7QUFFQUEsUUFBTTBCLE1BQU4sR0FBZUwsSUFBZixDQVBxRCxDQU8vQjs7QUFFdEJyQixRQUFNMkIsR0FBTixHQUFZSCxXQUFaLENBVHFELENBUzNCO0FBQzNCIiwiZmlsZSI6ImludGVybWVkaWF0ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgbmVjZXNzYXJ5ID0gcmVxdWlyZSgnbmVjZXNzYXJ5Jyk7XG5cbmNvbnN0IENhbnZhcyA9IHJlcXVpcmUoJy4uL2NhbnZhcycpLFxuICAgICAgTm9ybWFsID0gcmVxdWlyZSgnLi4vbm9ybWFsJyksXG4gICAgICBSb3RhdGlvbiA9IHJlcXVpcmUoJy4uL3JvdGF0aW9uJyksXG4gICAgICBQb3NpdGlvbiA9IHJlcXVpcmUoJy4uL3Bvc2l0aW9uJyksXG4gICAgICBQZXJzcGVjdGl2ZSA9IHJlcXVpcmUoJy4uL3BlcnNwZWN0aXZlJyksXG4gICAgICBDb2xvdXJTaGFkZXIgPSByZXF1aXJlKCcuLi9zaGFkZXIvY29sb3VyJyksXG4gICAgICBUZXh0dXJlU2hhZGVyID0gcmVxdWlyZSgnLi4vc2hhZGVyL3RleHR1cmUnKSxcbiAgICAgIGNvbG91ckN1YmUgPSByZXF1aXJlKCcuL2ludGVybWVkaWF0ZS9jdWJlL2NvbG91cicpLFxuICAgICAgdGV4dHVyZUN1YmUgPSByZXF1aXJlKCcuL2ludGVybWVkaWF0ZS9jdWJlL3RleHR1cmUnKTtcblxuY29uc3QgeyBhcnJheVV0aWxpdGllcywgYXN5bmNocm9ub3VzVXRpbGl0aWVzIH0gPSBuZWNlc3NhcnksXG4gICAgICB7IGZpcnN0IH0gPSBhcnJheVV0aWxpdGllcyxcbiAgICAgIHsgcmVwZWF0ZWRseSB9ID0gYXN5bmNocm9ub3VzVXRpbGl0aWVzO1xuXG5mdW5jdGlvbiBpbnRlcm1lZGlhdGUoKSB7XG4gIGNvbnN0IGNhbnZhcyA9IG5ldyBDYW52YXMoKSxcbiAgICAgICAgY29sb3VyU2hhZGVyID0gQ29sb3VyU2hhZGVyLmZyb21Ob3RoaW5nKGNhbnZhcyksXG4gICAgICAgIHRleHR1cmVTaGFkZXIgPSBUZXh0dXJlU2hhZGVyLmZyb21Ob3RoaW5nKGNhbnZhcyk7XG5cbiAgY2FudmFzLmVuYWJsZURlcHRoVGVzdGluZygpO1xuICBjYW52YXMuZW5hYmxlRGVwdGhGdW5jdGlvbigpO1xuXG4gIGNyZWF0ZVRleHR1cmVDdWJlKHRleHR1cmVTaGFkZXIsIGNhbnZhcywgZnVuY3Rpb24oY291bnQpIHtcbiAgICBjb25zdCBzaGFkZXIgPSB0ZXh0dXJlU2hhZGVyOyAgLy8vXG5cbiAgICBjYW52YXMudXNlU2hhZGVyKHNoYWRlcik7XG5cbiAgICBzaGFkZXIuYWN0aXZhdGVUZXh0dXJlKGNhbnZhcyk7XG5cbiAgICBjb25zdCByZW5kZXIgPSBjcmVhdGVSZW5kZXIoY2FudmFzLCBjb3VudCwgc2hhZGVyKTtcblxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShyZW5kZXIpO1xuICB9KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBpbnRlcm1lZGlhdGU7XG5cbmZ1bmN0aW9uIGNyZWF0ZUNvbG91ckN1YmUoY29sb3VyU2hhZGVyLCBjYW52YXMsIGNhbGxiYWNrKSB7XG4gIGNvbnN0IG9mZnNldFBvc2l0aW9uID0gWy0xLCAwLCAwXSxcbiAgICAgICAgY291bnQgPSBjb2xvdXJDdWJlKG9mZnNldFBvc2l0aW9uLCBjb2xvdXJTaGFkZXIsIGNhbnZhcyk7XG5cbiAgY2FsbGJhY2soY291bnQpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVUZXh0dXJlQ3ViZSh0ZXh0dXJlU2hhZGVyLCBjYW52YXMsIGNhbGxiYWNrKSB7XG4gIGxvYWRJbWFnZXMoZnVuY3Rpb24oaW1hZ2VzKSB7XG4gICAgY29uc3QgZmlyc3RJbWFnZSA9IGZpcnN0KGltYWdlcyksXG4gICAgICAgICAgb2Zmc2V0UG9zaXRpb24gPSBbKzEsIDAsIDBdLFxuICAgICAgICAgIGltYWdlID0gZmlyc3RJbWFnZSxcbiAgICAgICAgICBjb3VudCA9IHRleHR1cmVDdWJlKG9mZnNldFBvc2l0aW9uLCBpbWFnZSwgdGV4dHVyZVNoYWRlciwgY2FudmFzKTtcblxuICAgIGNhbGxiYWNrKGNvdW50KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGxvYWRJbWFnZXMoY2FsbGJhY2spIHtcbiAgY29uc3QgaW1hZ2VTb3VyY2VzID0gW1xuICAgICAgICAgICd0ZXh0dXJlL2JyaWNrcy5qcGcnXG4gICAgICAgIF0sXG4gICAgICAgIGltYWdlcyA9IFtdLFxuICAgICAgICBjb250ZXh0ID0ge1xuICAgICAgICAgIGltYWdlU291cmNlczogaW1hZ2VTb3VyY2VzLFxuICAgICAgICAgIGltYWdlczogaW1hZ2VzXG4gICAgICAgIH0sXG4gICAgICAgIGxlbmd0aCA9IGltYWdlU291cmNlcy5sZW5ndGg7IC8vL1xuXG4gIHJlcGVhdGVkbHkobG9hZEltYWdlQ2FsbGJhY2ssIGxlbmd0aCwgZnVuY3Rpb24oKSB7XG4gICAgY29uc3QgeyBpbWFnZXMgfSA9IGNvbnRleHQ7XG5cbiAgICBjYWxsYmFjayhpbWFnZXMpXG4gIH0sIGNvbnRleHQpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVSZW5kZXIoY2FudmFzLCBjb3VudCwgc2hhZGVyKSB7XG4gIGxldCBpbml0aWFsVGltZSA9IG51bGw7XG5cbiAgY29uc3QgY2xpZW50V2lkdGggPSBjYW52YXMuZ2V0Q2xpZW50V2lkdGgoKSxcbiAgICAgICAgY2xpZW50SGVpZ2h0ID0gY2FudmFzLmdldENsaWVudEhlaWdodCgpLFxuICAgICAgICB6Q29vcmRpbmF0ZSA9IC0xMCwgLy8vXG4gICAgICAgIHBvc2l0aW9uID0gUG9zaXRpb24uZnJvbVpDb29yZGluYXRlKHpDb29yZGluYXRlKSxcbiAgICAgICAgcGVyc3BlY3RpdmUgPSBQZXJzcGVjdGl2ZS5mcm9tQ2xpZW50V2lkdGhBbmRDbGllbnRIZWlnaHQoY2xpZW50V2lkdGgsIGNsaWVudEhlaWdodCk7XG5cbiAgY29uc3QgcmVuZGVyID0gKHRpbWUpID0+IHtcbiAgICBpZiAoaW5pdGlhbFRpbWUgPT09IG51bGwpIHtcbiAgICAgIGluaXRpYWxUaW1lID0gdGltZTtcbiAgICB9XG5cbiAgICBjb25zdCBlbGFwc2VkVGltZSA9IHRpbWUgLSBpbml0aWFsVGltZSxcbiAgICAgICAgICAvLyB4QW5nbGUgPSBlbGFwc2VkVGltZSAvIDEwMDAsXG4gICAgICAgICAgLy8geUFuZ2xlID0gZWxhcHNlZFRpbWUgLyAxMDAwLFxuICAgICAgICAgIC8vIHJvdGF0aW9uID0gUm90YXRpb24uZnJvbVhBbmdsZUFuZFlBbmdsZSh4QW5nbGUsIHlBbmdsZSksXG4gICAgICAgICAgcm90YXRpb24gPSBSb3RhdGlvbi5mcm9tTm90aGluZygpLFxuICAgICAgICAgIG5vcm1hbCA9IE5vcm1hbC5mcm9tUm90YXRpb24ocm90YXRpb24pO1xuXG4gICAgY2FudmFzLnJlbmRlcihzaGFkZXIsIG5vcm1hbCwgcm90YXRpb24sIHBvc2l0aW9uLCBwZXJzcGVjdGl2ZSk7XG5cbiAgICBjYW52YXMuZHJhd0VsZW1lbnRzKGNvdW50KTtcblxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShyZW5kZXIpO1xuICB9O1xuXG4gIHJldHVybiByZW5kZXI7XG59XG5cbmZ1bmN0aW9uIGxvYWRJbWFnZUNhbGxiYWNrKG5leHQsIGRvbmUsIGNvbnRleHQsIGluZGV4KSB7XG4gIGNvbnN0IHsgaW1hZ2VTb3VyY2VzLCBpbWFnZXMgfSA9IGNvbnRleHQsXG4gICAgICAgIGltYWdlU291cmNlID0gaW1hZ2VTb3VyY2VzW2luZGV4XSxcbiAgICAgICAgaW1hZ2UgPSBuZXcgSW1hZ2UoKTtcblxuICBpbWFnZXNbaW5kZXhdID0gaW1hZ2U7XG5cbiAgaW1hZ2Uub25sb2FkID0gbmV4dDsgIC8vL1xuXG4gIGltYWdlLnNyYyA9IGltYWdlU291cmNlOyAgLy8vXG59XG4iXX0=
'use strict';

var Canvas = require('../canvas'),
    Normal = require('../normal'),
    Rotation = require('../rotation'),
    Position = require('../position'),
    Perspective = require('../perspective'),
    ColourShader = require('../shader/colour'),
    TextureShader = require('../shader/texture');

var vertexColourData = [1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0],
    textureCoordinateData = [0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0],
    vertexPositionData = [-1.0, -1.0, +1.0, +1.0, -1.0, +1.0, +1.0, +1.0, +1.0, -1.0, +1.0, +1.0, -1.0, -1.0, -1.0, -1.0, +1.0, -1.0, +1.0, +1.0, -1.0, +1.0, -1.0, -1.0, -1.0, +1.0, -1.0, -1.0, +1.0, +1.0, +1.0, +1.0, +1.0, +1.0, +1.0, -1.0, -1.0, -1.0, -1.0, +1.0, -1.0, -1.0, +1.0, -1.0, +1.0, -1.0, -1.0, +1.0, +1.0, -1.0, -1.0, +1.0, +1.0, -1.0, +1.0, +1.0, +1.0, +1.0, -1.0, +1.0, -1.0, -1.0, -1.0, -1.0, -1.0, +1.0, -1.0, +1.0, +1.0, -1.0, +1.0, -1.0],
    vertexNormalData = [0.0, 0.0, +1.0, 0.0, 0.0, +1.0, 0.0, 0.0, +1.0, 0.0, 0.0, +1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, +1.0, 0.0, 0.0, +1.0, 0.0, 0.0, +1.0, 0.0, 0.0, +1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, +1.0, 0.0, 0.0, +1.0, 0.0, 0.0, +1.0, 0.0, 0.0, +1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0],
    vertexIndexData = [0, 1, 2, 0, 2, 3, 4, 5, 6, 4, 6, 7, 8, 9, 10, 8, 10, 11, 12, 13, 14, 12, 14, 15, 16, 17, 18, 16, 18, 19, 20, 21, 22, 20, 22, 23];

var canvas = new Canvas(),
    clientWidth = canvas.getClientWidth(),
    clientHeight = canvas.getClientHeight(),
    zCoordinate = -5,
    ///
position = Position.fromZCoordinate(zCoordinate),
    perspective = Perspective.fromClientWidthAndClientHeight(clientWidth, clientHeight),
    count = canvas.createAndBindElementBuffer(vertexIndexData);

canvas.enableDepthTesting();
canvas.enableDepthFunction();

var intermediate = function intermediate() {
  var context = canvas.getContext();

  if (!context) {
    return;
  }

  // const imageURL = 'texture/bricks.jpg';
  //
  // textureCube(imageURL, canvas, function(textureShader) {
  //   shader = textureShader; ///
  //
  //   requestAnimationFrame(render);
  // });

  var colourShader = colourCube(canvas);

  shader = colourShader; ///

  requestAnimationFrame(render);
};

var textureCube = function textureCube(imageURL, canvas, callback) {
  var textureShader = TextureShader.fromNothing(canvas);

  textureShader.createAndBindVertexPositionBuffer(vertexPositionData, canvas);

  textureShader.createAndBindTextureCoordinateBuffer(textureCoordinateData, canvas);

  textureShader.createAndBindVertexNormalBuffer(vertexNormalData, canvas);

  canvas.useShader(textureShader);

  textureShader.createAndActivateTexture(imageURL, canvas, function () {
    callback(textureShader);
  });
};

var colourCube = function colourCube(canvas) {
  var colourShader = ColourShader.fromNothing(canvas);

  colourShader.createAndBindVertexPositionBuffer(vertexPositionData, canvas);

  colourShader.createAndBindVertexColourBuffer(vertexColourData, canvas);

  colourShader.createAndBindVertexNormalBuffer(vertexNormalData, canvas);

  canvas.useShader(colourShader);

  return colourShader;
};

var initialTime = null;

var shader = void 0;

var render = function render(time) {
  if (initialTime === null) {
    initialTime = time;
  }

  var elapsedTime = time - initialTime,
      xAngle = elapsedTime / 1000,
      yAngle = elapsedTime / 1000,
      rotation = Rotation.fromXAngleAndYAngle(xAngle, yAngle),
      normal = Normal.fromRotation(rotation);

  canvas.render(normal, rotation, position, perspective, shader);

  canvas.drawElements(count);

  requestAnimationFrame(render);
};

module.exports = intermediate;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi9leGFtcGxlcy9jb2xvdXJDdWJlLmpzIl0sIm5hbWVzIjpbIkNhbnZhcyIsInJlcXVpcmUiLCJOb3JtYWwiLCJSb3RhdGlvbiIsIlBvc2l0aW9uIiwiUGVyc3BlY3RpdmUiLCJDb2xvdXJTaGFkZXIiLCJUZXh0dXJlU2hhZGVyIiwidmVydGV4Q29sb3VyRGF0YSIsInRleHR1cmVDb29yZGluYXRlRGF0YSIsInZlcnRleFBvc2l0aW9uRGF0YSIsInZlcnRleE5vcm1hbERhdGEiLCJ2ZXJ0ZXhJbmRleERhdGEiLCJjYW52YXMiLCJjbGllbnRXaWR0aCIsImdldENsaWVudFdpZHRoIiwiY2xpZW50SGVpZ2h0IiwiZ2V0Q2xpZW50SGVpZ2h0IiwiekNvb3JkaW5hdGUiLCJwb3NpdGlvbiIsImZyb21aQ29vcmRpbmF0ZSIsInBlcnNwZWN0aXZlIiwiZnJvbUNsaWVudFdpZHRoQW5kQ2xpZW50SGVpZ2h0IiwiY291bnQiLCJjcmVhdGVBbmRCaW5kRWxlbWVudEJ1ZmZlciIsImVuYWJsZURlcHRoVGVzdGluZyIsImVuYWJsZURlcHRoRnVuY3Rpb24iLCJpbnRlcm1lZGlhdGUiLCJjb250ZXh0IiwiZ2V0Q29udGV4dCIsImNvbG91clNoYWRlciIsImNvbG91ckN1YmUiLCJzaGFkZXIiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJyZW5kZXIiLCJ0ZXh0dXJlQ3ViZSIsImltYWdlVVJMIiwiY2FsbGJhY2siLCJ0ZXh0dXJlU2hhZGVyIiwiZnJvbU5vdGhpbmciLCJjcmVhdGVBbmRCaW5kVmVydGV4UG9zaXRpb25CdWZmZXIiLCJjcmVhdGVBbmRCaW5kVGV4dHVyZUNvb3JkaW5hdGVCdWZmZXIiLCJjcmVhdGVBbmRCaW5kVmVydGV4Tm9ybWFsQnVmZmVyIiwidXNlU2hhZGVyIiwiY3JlYXRlQW5kQWN0aXZhdGVUZXh0dXJlIiwiY3JlYXRlQW5kQmluZFZlcnRleENvbG91ckJ1ZmZlciIsImluaXRpYWxUaW1lIiwidGltZSIsImVsYXBzZWRUaW1lIiwieEFuZ2xlIiwieUFuZ2xlIiwicm90YXRpb24iLCJmcm9tWEFuZ2xlQW5kWUFuZ2xlIiwibm9ybWFsIiwiZnJvbVJvdGF0aW9uIiwiZHJhd0VsZW1lbnRzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsSUFBTUEsU0FBU0MsUUFBUSxXQUFSLENBQWY7QUFBQSxJQUNNQyxTQUFTRCxRQUFRLFdBQVIsQ0FEZjtBQUFBLElBRU1FLFdBQVdGLFFBQVEsYUFBUixDQUZqQjtBQUFBLElBR01HLFdBQVdILFFBQVEsYUFBUixDQUhqQjtBQUFBLElBSU1JLGNBQWNKLFFBQVEsZ0JBQVIsQ0FKcEI7QUFBQSxJQUtNSyxlQUFlTCxRQUFRLGtCQUFSLENBTHJCO0FBQUEsSUFNTU0sZ0JBQWdCTixRQUFRLG1CQUFSLENBTnRCOztBQVFBLElBQU1PLG1CQUFtQixDQUNqQixHQURpQixFQUNYLEdBRFcsRUFDTCxHQURLLEVBQ0MsR0FERCxFQUVqQixHQUZpQixFQUVYLEdBRlcsRUFFTCxHQUZLLEVBRUMsR0FGRCxFQUdqQixHQUhpQixFQUdYLEdBSFcsRUFHTCxHQUhLLEVBR0MsR0FIRCxFQUlqQixHQUppQixFQUlYLEdBSlcsRUFJTCxHQUpLLEVBSUMsR0FKRCxFQU1qQixHQU5pQixFQU1YLEdBTlcsRUFNTCxHQU5LLEVBTUMsR0FORCxFQU9qQixHQVBpQixFQU9YLEdBUFcsRUFPTCxHQVBLLEVBT0MsR0FQRCxFQVFqQixHQVJpQixFQVFYLEdBUlcsRUFRTCxHQVJLLEVBUUMsR0FSRCxFQVNqQixHQVRpQixFQVNYLEdBVFcsRUFTTCxHQVRLLEVBU0MsR0FURCxFQVdqQixHQVhpQixFQVdYLEdBWFcsRUFXTCxHQVhLLEVBV0MsR0FYRCxFQVlqQixHQVppQixFQVlYLEdBWlcsRUFZTCxHQVpLLEVBWUMsR0FaRCxFQWFqQixHQWJpQixFQWFYLEdBYlcsRUFhTCxHQWJLLEVBYUMsR0FiRCxFQWNqQixHQWRpQixFQWNYLEdBZFcsRUFjTCxHQWRLLEVBY0MsR0FkRCxFQWdCakIsR0FoQmlCLEVB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LG1CQUFULENBQTZCSCxNQUE3QixFQUFxQ0MsTUFBckMsQ0FIakI7QUFBQSxNQUlNRyxTQUFTbkQsT0FBT29ELFlBQVAsQ0FBb0JILFFBQXBCLENBSmY7O0FBTUF0QyxTQUFPcUIsTUFBUCxDQUFjbUIsTUFBZCxFQUFzQkYsUUFBdEIsRUFBZ0NoQyxRQUFoQyxFQUEwQ0UsV0FBMUMsRUFBdURXLE1BQXZEOztBQUVBbkIsU0FBTzBDLFlBQVAsQ0FBb0JoQyxLQUFwQjs7QUFFQVUsd0JBQXNCQyxNQUF0QjtBQUNELENBaEJEOztBQWtCQXNCLE9BQU9DLE9BQVAsR0FBaUI5QixZQUFqQiIsImZpbGUiOiJjb2xvdXJDdWJlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBDYW52YXMgPSByZXF1aXJlKCcuLi9jYW52YXMnKSxcbiAgICAgIE5vcm1hbCA9IHJlcXVpcmUoJy4uL25vcm1hbCcpLFxuICAgICAgUm90YXRpb24gPSByZXF1aXJlKCcuLi9yb3RhdGlvbicpLFxuICAgICAgUG9zaXRpb24gPSByZXF1aXJlKCcuLi9wb3NpdGlvbicpLFxuICAgICAgUGVyc3BlY3RpdmUgPSByZXF1aXJlKCcuLi9wZXJzcGVjdGl2ZScpLFxuICAgICAgQ29sb3VyU2hhZGVyID0gcmVxdWlyZSgnLi4vc2hhZGVyL2NvbG91cicpLFxuICAgICAgVGV4dHVyZVNoYWRlciA9IHJlcXVpcmUoJy4uL3NoYWRlci90ZXh0dXJlJyk7XG5cbmNvbnN0IHZlcnRleENvbG91ckRhdGEgPSBbXG4gICAgICAgIDEuMCwgIDAuMCwgIDAuMCwgIDEuMCxcbiAgICAgICAgMS4wLCAgMC4wLCAgMC4wLCAgMS4wLFxuICAgICAgICAxLjAsICAwLjAsICAwLjAsICAxLjAsXG4gICAgICAgIDEuMCwgIDAuMCwgIDAuMCwgIDEuMCxcblxuICAgICAgICAwLjAsICAxLjAsICAxLjAsICAxLjAsXG4gICAgICAgIDAuMCwgIDEuMCwgIDEuMCwgIDEuMCxcbiAgICAgICAgMC4wLCAgMS4wLCAgMS4wLCAgMS4wLFxuICAgICAgICAwLjAsICAxLjAsICAxLjAsICAxLjAsXG5cbiAgICAgICAgMC4wLCAgMS4wLCAgMC4wLCAgMS4wLFxuICAgICAgICAwLjAsICAxLjAsICAwLjAsICAxLjAsXG4gICAgICAgIDAuMCwgIDEuMCwgIDAuMCwgIDEuMCxcbiAgICAgICAgMC4wLCAgMS4wLCAgMC4wLCAgMS4wLFxuXG4gICAgICAgIDEuMCwgIDAuMCwgIDEuMCwgIDEuMCxcbiAgICAgICAgMS4wLCAgMC4wLCAgMS4wLCAgMS4wLFxuICAgICAgICAxLjAsICAwLjAsICAxLjAsICAxLjAsXG4gICAgICAgIDEuMCwgIDAuMCwgIDEuMCwgIDEuMCxcblxuICAgICAgICAwLjAsICAwLjAsICAxLjAsICAxLjAsXG4gICAgICAgIDAuMCwgIDAuMCwgIDEuMCwgIDEuMCxcbiAgICAgICAgMC4wLCAgMC4wLCAgMS4wLCAgMS4wLFxuICAgICAgICAwLjAsICAwLjAsICAxLjAsICAxLjAsXG5cbiAgICAgICAgMS4wLCAgMS4wLCAgMC4wLCAgMS4wLFxuICAgICAgICAxLjAsICAxLjAsICAwLjAsICAxLjAsXG4gICAgICAgIDEuMCwgIDEuMCwgIDAuMCwgIDEuMCxcbiAgICAgICAgMS4wLCAgMS4wLCAgMC4wLCAgMS4wXG4gICAgICBdLFxuICAgICAgdGV4dHVyZUNvb3JkaW5hdGVEYXRhID0gW1xuICAgICAgICAwLjAsICAwLjAsXG4gICAgICAgIDEuMCwgIDAuMCxcbiAgICAgICAgMS4wLCAgMS4wLFxuICAgICAgICAwLjAsICAxLjAsXG5cbiAgICAgICAgMC4wLCAgMC4wLFxuICAgICAgICAxLjAsICAwLjAsXG4gICAgICAgIDEuMCwgIDEuMCxcbiAgICAgICAgMC4wLCAgMS4wLFxuXG4gICAgICAgIDAuMCwgIDAuMCxcbiAgICAgICAgMS4wLCAgMC4wLFxuICAgICAgICAxLjAsICAxLjAsXG4gICAgICAgIDAuMCwgIDEuMCxcblxuICAgICAgICAwLjAsICAwLjAsXG4gICAgICAgIDEuMCwgIDAuMCxcbiAgICAgICAgMS4wLCAgMS4wLFxuICAgICAgICAwLjAsICAxLjAsXG5cbiAgICAgICAgMC4wLCAgMC4wLFxuICAgICAgICAxLjAsICAwLjAsXG4gICAgICAgIDEuMCwgIDEuMCxcbiAgICAgICAgMC4wLCAgMS4wLFxuXG4gICAgICAgIDAuMCwgIDAuMCxcbiAgICAgICAgMS4wLCAgMC4wLFxuICAgICAgICAxLjAsICAxLjAsXG4gICAgICAgIDAuMCwgIDEuMFxuICAgICAgXSxcbiAgICAgIHZlcnRleFBvc2l0aW9uRGF0YSA9IFtcbiAgICAgICAgLTEuMCwgLTEuMCwgKzEuMCxcbiAgICAgICAgKzEuMCwgLTEuMCwgKzEuMCxcbiAgICAgICAgKzEuMCwgKzEuMCwgKzEuMCxcbiAgICAgICAgLTEuMCwgKzEuMCwgKzEuMCxcblxuICAgICAgICAtMS4wLCAtMS4wLCAtMS4wLFxuICAgICAgICAtMS4wLCArMS4wLCAtMS4wLFxuICAgICAgICArMS4wLCArMS4wLCAtMS4wLFxuICAgICAgICArMS4wLCAtMS4wLCAtMS4wLFxuXG4gICAgICAgIC0xLjAsICsxLjAsIC0xLjAsXG4gICAgICAgIC0xLjAsICsxLjAsICsxLjAsXG4gICAgICAgICsxLjAsICsxLjAsICsxLjAsXG4gICAgICAgICsxLjAsICsxLjAsIC0xLjAsXG5cbiAgICAgICAgLTEuMCwgLTEuMCwgLTEuMCxcbiAgICAgICAgKzEuMCwgLTEuMCwgLTEuMCxcbiAgICAgICAgKzEuMCwgLTEuMCwgKzEuMCxcbiAgICAgICAgLTEuMCwgLTEuMCwgKzEuMCxcblxuICAgICAgICArMS4wLCAtMS4wLCAtMS4wLFxuICAgICAgICArMS4wLCArMS4wLCAtMS4wLFxuICAgICAgICArMS4wLCArMS4wLCArMS4wLFxuICAgICAgICArMS4wLCAtMS4wLCArMS4wLFxuXG4gICAgICAgIC0xLjAsIC0xLjAsIC0xLjAsXG4gICAgICAgIC0xLjAsIC0xLjAsICsxLjAsXG4gICAgICAgIC0xLjAsICsxLjAsICsxLjAsXG4gICAgICAgIC0xLjAsICsxLjAsIC0xLjBcbiAgICAgIF0sXG4gICAgICB2ZXJ0ZXhOb3JtYWxEYXRhID0gW1xuICAgICAgICAwLjAsICAwLjAsICsxLjAsXG4gICAgICAgIDAuMCwgIDAuMCwgKzEuMCxcbiAgICAgICAgMC4wLCAgMC4wLCArMS4wLFxuICAgICAgICAwLjAsICAwLjAsICsxLjAsXG5cbiAgICAgICAgMC4wLCAgMC4wLCAtMS4wLFxuICAgICAgICAwLjAsICAwLjAsIC0xLjAsXG4gICAgICAgIDAuMCwgIDAuMCwgLTEuMCxcbiAgICAgICAgMC4wLCAgMC4wLCAtMS4wLFxuXG4gICAgICAgIDAuMCwgKzEuMCwgIDAuMCxcbiAgICAgICAgMC4wLCArMS4wLCAgMC4wLFxuICAgICAgICAwLjAsICsxLjAsICAwLjAsXG4gICAgICAgIDAuMCwgKzEuMCwgIDAuMCxcblxuICAgICAgICAwLjAsIC0xLjAsICAwLjAsXG4gICAgICAgIDAuMCwgLTEuMCwgIDAuMCxcbiAgICAgICAgMC4wLCAtMS4wLCAgMC4wLFxuICAgICAgICAwLjAsIC0xLjAsICAwLjAsXG5cbiAgICAgICAgKzEuMCwgIDAuMCwgIDAuMCxcbiAgICAgICAgKzEuMCwgIDAuMCwgIDAuMCxcbiAgICAgICAgKzEuMCwgIDAuMCwgIDAuMCxcbiAgICAgICAgKzEuMCwgIDAuMCwgIDAuMCxcblxuICAgICAgICAtMS4wLCAgMC4wLCAgMC4wLFxuICAgICAgICAtMS4wLCAgMC4wLCAgMC4wLFxuICAgICAgICAtMS4wLCAgMC4wLCAgMC4wLFxuICAgICAgICAtMS4wLCAgMC4wLCAgMC4wXG4gICAgICBdLFxuICAgICAgdmVydGV4SW5kZXhEYXRhID0gW1xuICAgICAgICAwLCAgMSwgIDIsXG4gICAgICAgIDAsICAyLCAgMyxcblxuICAgICAgICA0LCAgNSwgIDYsXG4gICAgICAgIDQsICA2LCAgNyxcblxuICAgICAgICA4LCAgOSwgMTAsXG4gICAgICAgIDgsIDEwLCAxMSxcblxuICAgICAgICAxMiwgMTMsIDE0LFxuICAgICAgICAxMiwgMTQsIDE1LFxuXG4gICAgICAgIDE2LCAxNywgMTgsXG4gICAgICAgIDE2LCAxOCwgMTksXG5cbiAgICAgICAgMjAsIDIxLCAyMixcbiAgICAgICAgMjAsIDIyLCAyM1xuICAgICAgXTtcblxuY29uc3QgY2FudmFzID0gbmV3IENhbnZhcygpLFxuICAgICAgY2xpZW50V2lkdGggPSBjYW52YXMuZ2V0Q2xpZW50V2lkdGgoKSxcbiAgICAgIGNsaWVudEhlaWdodCA9IGNhbnZhcy5nZXRDbGllbnRIZWlnaHQoKSxcbiAgICAgIHpDb29yZGluYXRlID0gLTUsIC8vL1xuICAgICAgcG9zaXRpb24gPSBQb3NpdGlvbi5mcm9tWkNvb3JkaW5hdGUoekNvb3JkaW5hdGUpLFxuICAgICAgcGVyc3BlY3RpdmUgPSBQZXJzcGVjdGl2ZS5mcm9tQ2xpZW50V2lkdGhBbmRDbGllbnRIZWlnaHQoY2xpZW50V2lkdGgsIGNsaWVudEhlaWdodCksXG4gICAgICBjb3VudCA9IGNhbnZhcy5jcmVhdGVBbmRCaW5kRWxlbWVudEJ1ZmZlcih2ZXJ0ZXhJbmRleERhdGEpO1xuXG5jYW52YXMuZW5hYmxlRGVwdGhUZXN0aW5nKCk7XG5jYW52YXMuZW5hYmxlRGVwdGhGdW5jdGlvbigpO1xuXG5jb25zdCBpbnRlcm1lZGlhdGUgPSAoKSA9PiB7XG4gIGNvbnN0IGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgpO1xuXG4gIGlmICghY29udGV4dCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIGNvbnN0IGltYWdlVVJMID0gJ3RleHR1cmUvYnJpY2tzLmpwZyc7XG4gIC8vXG4gIC8vIHRleHR1cmVDdWJlKGltYWdlVVJMLCBjYW52YXMsIGZ1bmN0aW9uKHRleHR1cmVTaGFkZXIpIHtcbiAgLy8gICBzaGFkZXIgPSB0ZXh0dXJlU2hhZGVyOyAvLy9cbiAgLy9cbiAgLy8gICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUocmVuZGVyKTtcbiAgLy8gfSk7XG5cbiAgY29uc3QgY29sb3VyU2hhZGVyID0gY29sb3VyQ3ViZShjYW52YXMpO1xuXG4gIHNoYWRlciA9IGNvbG91clNoYWRlcjsgIC8vL1xuXG4gIHJlcXVlc3RBbmltYXRpb25GcmFtZShyZW5kZXIpO1xufTtcblxuY29uc3QgdGV4dHVyZUN1YmUgPSAoaW1hZ2VVUkwsIGNhbnZhcywgY2FsbGJhY2spID0+IHtcbiAgY29uc3QgdGV4dHVyZVNoYWRlciA9IFRleHR1cmVTaGFkZXIuZnJvbU5vdGhpbmcoY2FudmFzKTtcblxuICB0ZXh0dXJlU2hhZGVyLmNyZWF0ZUFuZEJpbmRWZXJ0ZXhQb3NpdGlvbkJ1ZmZlcih2ZXJ0ZXhQb3NpdGlvbkRhdGEsIGNhbnZhcyk7XG5cbiAgdGV4dHVyZVNoYWRlci5jcmVhdGVBbmRCaW5kVGV4dHVyZUNvb3JkaW5hdGVCdWZmZXIodGV4dHVyZUNvb3JkaW5hdGVEYXRhLCBjYW52YXMpO1xuXG4gIHRleHR1cmVTaGFkZXIuY3JlYXRlQW5kQmluZFZlcnRleE5vcm1hbEJ1ZmZlcih2ZXJ0ZXhOb3JtYWxEYXRhLCBjYW52YXMpO1xuXG4gIGNhbnZhcy51c2VTaGFkZXIodGV4dHVyZVNoYWRlcik7XG5cbiAgdGV4dHVyZVNoYWRlci5jcmVhdGVBbmRBY3RpdmF0ZVRleHR1cmUoaW1hZ2VVUkwsIGNhbnZhcywgZnVuY3Rpb24oKSB7XG4gICAgY2FsbGJhY2sodGV4dHVyZVNoYWRlcik7XG4gIH0pO1xufTtcblxuY29uc3QgY29sb3VyQ3ViZSA9IChjYW52YXMpID0+IHtcbiAgY29uc3QgY29sb3VyU2hhZGVyID0gQ29sb3VyU2hhZGVyLmZyb21Ob3RoaW5nKGNhbnZhcyk7XG5cbiAgY29sb3VyU2hhZGVyLmNyZWF0ZUFuZEJpbmRWZXJ0ZXhQb3NpdGlvbkJ1ZmZlcih2ZXJ0ZXhQb3NpdGlvbkRhdGEsIGNhbnZhcyk7XG5cbiAgY29sb3VyU2hhZGVyLmNyZWF0ZUFuZEJpbmRWZXJ0ZXhDb2xvdXJCdWZmZXIodmVydGV4Q29sb3VyRGF0YSwgY2FudmFzKTtcblxuICBjb2xvdXJTaGFkZXIuY3JlYXRlQW5kQmluZFZlcnRleE5vcm1hbEJ1ZmZlcih2ZXJ0ZXhOb3JtYWxEYXRhLCBjYW52YXMpO1xuXG4gIGNhbnZhcy51c2VTaGFkZXIoY29sb3VyU2hhZGVyKTtcblxuICByZXR1cm4gY29sb3VyU2hhZGVyO1xufTtcblxubGV0IGluaXRpYWxUaW1lID0gbnVsbDtcblxubGV0IHNoYWRlcjtcblxuY29uc3QgcmVuZGVyID0gKHRpbWUpID0+IHtcbiAgaWYgKGluaXRpYWxUaW1lID09PSBudWxsKSB7XG4gICAgaW5pdGlhbFRpbWUgPSB0aW1lO1xuICB9XG5cbiAgY29uc3QgZWxhcHNlZFRpbWUgPSB0aW1lIC0gaW5pdGlhbFRpbWUsXG4gICAgICAgIHhBbmdsZSA9IGVsYXBzZWRUaW1lIC8gMTAwMCxcbiAgICAgICAgeUFuZ2xlID0gZWxhcHNlZFRpbWUgLyAxMDAwLFxuICAgICAgICByb3RhdGlvbiA9IFJvdGF0aW9uLmZyb21YQW5nbGVBbmRZQW5nbGUoeEFuZ2xlLCB5QW5nbGUpLFxuICAgICAgICBub3JtYWwgPSBOb3JtYWwuZnJvbVJvdGF0aW9uKHJvdGF0aW9uKTtcblxuICBjYW52YXMucmVuZGVyKG5vcm1hbCwgcm90YXRpb24sIHBvc2l0aW9uLCBwZXJzcGVjdGl2ZSwgc2hhZGVyKTtcblxuICBjYW52YXMuZHJhd0VsZW1lbnRzKGNvdW50KTtcblxuICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUocmVuZGVyKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gaW50ZXJtZWRpYXRlO1xuIl19